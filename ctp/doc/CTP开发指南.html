<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   
      <title>CTP开发指南</title>
      <link rel="stylesheet" type="text/css" href="resources/style.css">
      <meta name="generator" content="DocBook XSL Stylesheets V1.76.1">
   </head>
   <body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
      <div class="book" title="CTP开发指南">
         <div class="titlepage">
            <div>
               <div>
                  <h1 class="title"><a name="d5e1"></a>CTP开发指南
                  </h1>
               </div>
               <div>
                  <div class="author">
                     <h3 class="author"><span class="firstname">Seeyon CTP Team</span> <span class="surname"></span></h3>
                     <div class="affiliation">
                                <span class="orgname">致远软件<br></span>
                              
                     </div>
                  </div>
               </div>
               <div>
                  <p class="pubdate">2012-06-27</p>
               </div>
               <div>
                  <div class="revhistory">
                     <table border="1" width="100%" summary="Revision history">
                        <tr>
                           <th align="left" valign="top" colspan="3"><b>Revision History</b></th>
                        </tr>
                              
                        <tr>
                           <td align="left">Revision 1.01</td>
                           <td align="left">2012-06-27</td>
                           <td align="left">王文友</td>
                        </tr>
                        <tr>
                           <td align="left" colspan="3">
                                        
                              <p>建立基本结构文档，前端开发规范alpha版。</p>
                                      
                           </td>
                        </tr>
                        
                              
                        <tr>
                           <td align="left">Revision 1.02</td>
                           <td align="left">2012-07-03</td>
                           <td align="left">雷广法</td>
                        </tr>
                        <tr>
                           <td align="left" colspan="3">
                                        
                              <p>增加后台开发规范第一版。</p>
                                      
                           </td>
                        </tr>
                        
                              
                        <tr>
                           <td align="left">Revision 1.03</td>
                           <td align="left">2012-07-03</td>
                           <td align="left">吴玉民</td>
                        </tr>
                        <tr>
                           <td align="left" colspan="3">
                                        
                              <p>后台开发规范增加Java代码规范。</p>
                                      
                           </td>
                        </tr>
                        
                              
                        <tr>
                           <td align="left">Revision 1.04</td>
                           <td align="left">2012-07-04</td>
                           <td align="left">周天</td>
                        </tr>
                        <tr>
                           <td align="left" colspan="3">
                                        
                              <p>前端开发手册增加Ajax开发规范。</p>
                                      
                           </td>
                        </tr>
                        
                              
                        <tr>
                           <td align="left">Revision 1.05</td>
                           <td align="left">2012-07-05</td>
                           <td align="left">周龙君</td>
                        </tr>
                        <tr>
                           <td align="left" colspan="3">
                                        
                              <p>前端开发手册增加Form开发规范。</p>
                                      
                           </td>
                        </tr>
                        
                              
                        <tr>
                           <td align="left">Revision 1.06</td>
                           <td align="left">2012-07-17</td>
                           <td align="left">王文友</td>
                        </tr>
                        <tr>
                           <td align="left" colspan="3">
                                        
                              <p>后台开发手册增加组件文档。</p>
                                      
                           </td>
                        </tr>
                        
                              
                        <tr>
                           <td align="left">Revision 1.07</td>
                           <td align="left">2012-07-25</td>
                           <td align="left">吴玉民</td>
                        </tr>
                        <tr>
                           <td align="left" colspan="3">
                                        
                              <p>前端组件文档完善，并增加layout、tab、toolbar、menu、dialog、messageBox组件说明</p>
                                      
                           </td>
                        </tr>
                            
                     </table>
                  </div>
               </div>
            </div>
            <hr>
         </div>
         <div class="toc">
            <p><b>Table of Contents</b></p>
            <dl>
               <dt><span class="part"><a href="#d5e55">I. CTP后台开发规范</a></span></dt>
               <dd>
                  <dl>
                     <dt><span class="chapter"><a href="#d5e59">1. CTP后台开发规范</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e61">1.1. 体系图</a></span></dt>
                           <dt><span class="section"><a href="#d5e67">1.2. 开发规范</a></span></dt>
                           <dt><span class="section"><a href="#d5e121">1.3. 工具规范</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d5e141">2. Java编码规范</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e143">2.1. 命名规范</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e145">2.1.1. Package命名 [NAMING.PKG-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e154">2.1.2. Class命名 [NAMING.NCL-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e161">2.1.3. Interface命名 [NAMING.NITF-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e167">2.1.4. Exception Class命名 [NAMING.NE-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e173">2.1.5. Unit Test Class命名 [NAMING.NE-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e180">2.1.6. Enum type命名 [NAMING.NENUM-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e186">2.1.7. Methods命名 [NAMING.NMP-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e193">2.1.8. Local variables命名 [NAMING.NLV-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e200">2.1.9. 常量命名 [NAMING.USF-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e206">2.1.10. 类名禁止使用java内置类名 [NAMING.DJLO-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e212">2.1.11. 标示符禁止使用java关键字 [NAMING.DJLO-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e218">2.1.12. 禁止使用sun预留包名 [NAMING.RPKG-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e224">2.1.13. 禁止仅通过大小写区分变量 [NAMING.UUVN-4]</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e230">2.2. 注释规范</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e232">2.2.1. java文件头注释 [FORMAT.MCH-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e237">2.2.2. java类注释 [JAVADOC.PJDC-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e242">2.2.3. 方法注释 [JAVADOC.PJDM-2]</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e256">2.3. 格式规范</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e258">2.3.1. 代码长度限制 [FORMAT.LL-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e262">2.3.2. 每个声明占用一个代码行 [FORMAT.OSPL-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e270">2.3.3. 使用括号分隔复杂表达式 [FORMAT.APAREN-3]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e278">2.3.4. 避免过于复杂的判断表达式</a></span></dt>
                                 <dt><span class="section"><a href="#d5e282">2.3.5. 代码缩进使用空格代替tab [FORMAT.DUT-3]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e286">2.3.6. 数组声明格式 [FORMAT.IAD-3]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e294">2.3.7. 正确使用equals</a></span></dt>
                                 <dt><span class="section"><a href="#d5e300">2.3.8. 避免不必要的小括号 [FORMAT.UP-3]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e306">2.3.9. 与文件同名的类应放在所有类声明的最前面 [FORMAT.FCN-4]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e310">2.3.10. 声明中修饰符的使用应遵循正确顺序 [FORMAT.MO-4]</a></span></dt>
                              </dl>
                           </dd>
                        </dl>
                     </dd>
                  </dl>
               </dd>
               <dt><span class="part"><a href="#d5e325">II. CTP前端开发规范</a></span></dt>
               <dd>
                  <dl>
                     <dt><span class="preface"><a href="#d5e327">基本原则</a></span></dt>
                     <dt><span class="chapter"><a href="#d5e346">3. 页面开发规范</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e348">3.1. 代码结构</a></span></dt>
                           <dt><span class="section"><a href="#d5e356">3.2. 命名</a></span></dt>
                           <dt><span class="section"><a href="#d5e359">3.3. 页面结构</a></span></dt>
                           <dt><span class="section"><a href="#d5e371">3.4. HTML书写规范</a></span></dt>
                           <dt><span class="section"><a href="#d5e396">3.5. JSTL &amp; EL</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d5e411">4. Javascript开发规范</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e418">4.1. 编码规范</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e420">4.1.1. 文件</a></span></dt>
                                 <dt><span class="section"><a href="#d5e426">4.1.2. 命名</a></span></dt>
                                 <dt><span class="section"><a href="#d5e445">4.1.3. 行长度</a></span></dt>
                                 <dt><span class="section"><a href="#d5e448">4.1.4. 缩进</a></span></dt>
                                 <dt><span class="section"><a href="#d5e451">4.1.5. 注释</a></span></dt>
                                 <dt><span class="section"><a href="#d5e460">4.1.6. 代码风格</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e485">4.2. jQuery</a></span></dt>
                           <dt><span class="section"><a href="#d5e488">4.3. 面向对象</a></span></dt>
                           <dt><span class="section"><a href="#d5e493">4.4. 事件绑定</a></span></dt>
                           <dt><span class="section"><a href="#d5e500">4.5. 限制</a></span></dt>
                           <dt><span class="section"><a href="#d5e530">4.6. Ajax</a></span></dt>
                           <dt><span class="section"><a href="#d5e537">4.7. 附录</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e539">4.7.1. jsdoc常用关键字</a></span></dt>
                              </dl>
                           </dd>
                        </dl>
                     </dd>
                  </dl>
               </dd>
               <dt><span class="part"><a href="#d5e623">III. CTP后台开发手册</a></span></dt>
               <dd>
                  <dl>
                     <dt><span class="chapter"><a href="#d5e625">5. 开发环境</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e629">5.1. 获取CTP发布</a></span></dt>
                           <dt><span class="section"><a href="#d5e636">5.2. 获取Eclipse All-In-One</a></span></dt>
                           <dt><span class="section"><a href="#d5e641">5.3. 建立开发环境</a></span></dt>
                           <dt><span class="section"><a href="#d5e685">5.4. 配置数据库连接</a></span></dt>
                           <dt><span class="section"><a href="#d5e690">5.5. 建立运行环境</a></span></dt>
                           <dt><span class="section"><a href="#d5e698">5.6. 单元测试</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d5e702">6. 框架</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e704">6.1. 字符集</a></span></dt>
                           <dt><span class="section"><a href="#d5e712">6.2. 代码结构</a></span></dt>
                           <dt><span class="section"><a href="#d5e780">6.3. MVC</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e783">6.3.1. Controller层</a></span></dt>
                                 <dt><span class="section"><a href="#d5e791">6.3.2. Manager层</a></span></dt>
                                 <dt><span class="section"><a href="#d5e800">6.3.3. DAO层</a></span></dt>
                                 <dt><span class="section"><a href="#d5e963">6.3.4. Model &amp; View</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e966">6.4. 插件化</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e969">6.4.1. 插件规范</a></span></dt>
                                 <dt><span class="section"><a href="#d5e980">6.4.2. 插件基础配置</a></span></dt>
                                 <dt><span class="section"><a href="#d5e996">6.4.3. 插件启动初始化</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1003">6.4.4. 插件自定义配置文件</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1011">6.4.5. 插件国际化配置文件</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1016">6.4.6. 插件spring配置</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1027">6.4.7. 插件hibernatePO加载</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e1031">6.5. 异常处理</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e1039">6.5.1. 异常消息国际化</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1054">6.5.2. 例子</a></span></dt>
                              </dl>
                           </dd>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d5e1057">7. 组件</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e1060">7.1. 脚本引擎支持（Groovy）</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e1078">7.1.1. 表达式计算</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1086">7.1.2. 字符串宏替换</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1090">7.1.3. 基本函数库</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e1117">7.2. 事件</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e1120">7.2.1. 应用场景</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1124">7.2.2. 技术背景</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1132">7.2.3. 开发步骤</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1144">7.2.4. 事件命名规范</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1153">7.2.5. 示例</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e1170">7.3. 缓存</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e1173">7.3.1. 缓存的界定</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1191">7.3.2. 缓存组件</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e1216">7.4. 加解密</a></span></dt>
                           <dt><span class="section"><a href="#d5e1220">7.5. 应用锁</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e1226">7.5.1. 名词解释</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1231">7.5.2. 功能</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1242">7.5.3. 调用</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e1260">7.6. 定时任务 Quartz</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e1295">7.6.1. 业务定时任务</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1328">7.6.2. 系统定时任务</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e1342">7.7. 文件（附件）管理JAVA 接口</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e1351">7.7.1. 对输入流下载的接口</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1359">7.7.2. 删除附件的接口</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e1368">7.8. 文件压缩/解压</a></span></dt>
                           <dt><span class="section"><a href="#d5e1373">7.9. i18n国际化</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d5e1384">8. 单元测试</a></span></dt>
                  </dl>
               </dd>
               <dt><span class="part"><a href="#d5e1409">IV. CTP前端开发手册</a></span></dt>
               <dd>
                  <dl>
                     <dt><span class="chapter"><a href="#d5e1411">9. 概述</a></span></dt>
                     <dt><span class="chapter"><a href="#d5e1460">10. Ajax</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e1463">10.1. 概述</a></span></dt>
                           <dt><span class="section"><a href="#d5e1466">10.2. 开发步骤</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e1469">10.2.1. Manager层实现</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1472">10.2.2. 前端调用</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1493">10.2.3. 类型映射</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e1543">10.3. 实例</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d5e1546">11. Form开发规范</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e1548">11.1. Form布局规范</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e1551">11.1.1. 左树右表下编辑</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e1561">11.2. Form校验</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e1653">11.2.1. 实例</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e1656">11.3. Form回填</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e1694">11.3.1. 实例</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e1697">11.4. Form提交</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e1786">11.4.1. 实例</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e1789">11.5. 表单数据清除</a></span></dt>
                           <dt><span class="section"><a href="#d5e1794">11.6. 表单控件批量禁用/启用</a></span></dt>
                           <dt><span class="section"><a href="#d5e1799">11.7. 按钮级资源权限控制</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d5e1810">12. 基础组件</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e1812">12.1. 基础控件库</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e1815">12.1.1. 按钮</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1824">12.1.2. 单选</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1832">12.1.3. 复选</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1840">12.1.4. 进度条</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1847">12.1.5. 页签</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1886">12.1.6. 文本框</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1894">12.1.7. 下拉列表</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1903">12.1.8. 链接</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1913">12.1.9. 搜索框</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1922">12.1.10. 面包屑</a></span></dt>
                                 <dt><span class="section"><a href="#d5e1930">12.1.11. 提示消息</a></span></dt>
                                 <dt><span class="section"><a href="#d5e2023">12.1.12. Dialog组件</a></span></dt>
                                 <dt><span class="section"><a href="#d5e2076">12.1.13. Layout组件</a></span></dt>
                                 <dt><span class="section"><a href="#d5e2106">12.1.14. Toolbar组件</a></span></dt>
                                 <dt><span class="section"><a href="#d5e2129">12.1.15. Menu组件</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e2157">12.2. 表格组件</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e2211">12.2.1. 实例</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e2214">12.3. 树组件</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e2312">12.3.1. 实例</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e2315">12.4. 日期选择组件</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e2329">12.4.1. 实例</a></span></dt>
                              </dl>
                           </dd>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d5e2332">13. 功能组件</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e2334">13.1. 枚举组件</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e2362">13.1.1. 实例</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e2365">13.2. 选人组件</a></span></dt>
                           <dt><span class="section"><a href="#d5e2400">13.3. 文件管理组件</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e2407">13.3.1. 应用范围</a></span></dt>
                                 <dt><span class="section"><a href="#d5e2413">13.3.2. 附件管理</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e2600">13.4. 正文编辑器</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e2609">13.4.1. 定义</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e2616">13.5. 元数据组件</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e2622">13.5.1. 功能</a></span></dt>
                                 <dt><span class="section"><a href="#d5e2640">13.5.2. 开发步骤</a></span></dt>
                              </dl>
                           </dd>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d5e2662">14. 单元测试</a></span></dt>
                     <dt><span class="chapter"><a href="#d5e2679">15. JavaScript优化技巧</a></span></dt>
                     <dt><span class="chapter"><a href="#d5e2710">16. JavaScript优化技巧</a></span></dt>
                  </dl>
               </dd>
               <dt><span class="glossary"><a href="#d5e2741">Glossary</a></span></dt>
            </dl>
         </div>
         <div class="list-of-tables">
            <p><b>List of Tables</b></p>
            <dl>
               <dt>7.1. <a href="#d5e1264">定时任务分类</a></dt>
               <dt>11.1. <a href="#d5e1576">Form校验规则</a></dt>
               <dt>11.2. <a href="#d5e1769"></a></dt>
            </dl>
         </div>
         <div class="list-of-examples">
            <p><b>List of Examples</b></p>
            <dl>
               <dt>3.1. <a href="#d5e352"></a></dt>
            </dl>
         </div>
         
         
         
         
         
         <div class="part" title="Part&nbsp;I.&nbsp;CTP后台开发规范">
            <div class="titlepage">
               <div>
                  <div>
                     <h1 class="title"><a name="d5e55"></a>Part&nbsp;I.&nbsp;CTP后台开发规范
                     </h1>
                  </div>
               </div>
            </div>
            
            
            
            <div class="partintro" title="CTP后台开发规范">
               <div></div>
               
               <p></p>
               
               <div class="toc">
                  <p><b>Table of Contents</b></p>
                  <dl>
                     <dt><span class="chapter"><a href="#d5e59">1. CTP后台开发规范</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e61">1.1. 体系图</a></span></dt>
                           <dt><span class="section"><a href="#d5e67">1.2. 开发规范</a></span></dt>
                           <dt><span class="section"><a href="#d5e121">1.3. 工具规范</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="chapter"><a href="#d5e141">2. Java编码规范</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e143">2.1. 命名规范</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e145">2.1.1. Package命名 [NAMING.PKG-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e154">2.1.2. Class命名 [NAMING.NCL-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e161">2.1.3. Interface命名 [NAMING.NITF-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e167">2.1.4. Exception Class命名 [NAMING.NE-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e173">2.1.5. Unit Test Class命名 [NAMING.NE-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e180">2.1.6. Enum type命名 [NAMING.NENUM-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e186">2.1.7. Methods命名 [NAMING.NMP-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e193">2.1.8. Local variables命名 [NAMING.NLV-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e200">2.1.9. 常量命名 [NAMING.USF-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e206">2.1.10. 类名禁止使用java内置类名 [NAMING.DJLO-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e212">2.1.11. 标示符禁止使用java关键字 [NAMING.DJLO-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e218">2.1.12. 禁止使用sun预留包名 [NAMING.RPKG-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e224">2.1.13. 禁止仅通过大小写区分变量 [NAMING.UUVN-4]</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e230">2.2. 注释规范</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e232">2.2.1. java文件头注释 [FORMAT.MCH-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e237">2.2.2. java类注释 [JAVADOC.PJDC-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e242">2.2.3. 方法注释 [JAVADOC.PJDM-2]</a></span></dt>
                              </dl>
                           </dd>
                           <dt><span class="section"><a href="#d5e256">2.3. 格式规范</a></span></dt>
                           <dd>
                              <dl>
                                 <dt><span class="section"><a href="#d5e258">2.3.1. 代码长度限制 [FORMAT.LL-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e262">2.3.2. 每个声明占用一个代码行 [FORMAT.OSPL-2]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e270">2.3.3. 使用括号分隔复杂表达式 [FORMAT.APAREN-3]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e278">2.3.4. 避免过于复杂的判断表达式</a></span></dt>
                                 <dt><span class="section"><a href="#d5e282">2.3.5. 代码缩进使用空格代替tab [FORMAT.DUT-3]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e286">2.3.6. 数组声明格式 [FORMAT.IAD-3]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e294">2.3.7. 正确使用equals</a></span></dt>
                                 <dt><span class="section"><a href="#d5e300">2.3.8. 避免不必要的小括号 [FORMAT.UP-3]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e306">2.3.9. 与文件同名的类应放在所有类声明的最前面 [FORMAT.FCN-4]</a></span></dt>
                                 <dt><span class="section"><a href="#d5e310">2.3.10. 声明中修饰符的使用应遵循正确顺序 [FORMAT.MO-4]</a></span></dt>
                              </dl>
                           </dd>
                        </dl>
                     </dd>
                  </dl>
               </div>
            </div>
            
            
            <div class="chapter" title="Chapter&nbsp;1.&nbsp;CTP后台开发规范">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d5e59"></a>Chapter&nbsp;1.&nbsp;CTP后台开发规范
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Table of Contents</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d5e61">1.1. 体系图</a></span></dt>
                     <dt><span class="section"><a href="#d5e67">1.2. 开发规范</a></span></dt>
                     <dt><span class="section"><a href="#d5e121">1.3. 工具规范</a></span></dt>
                  </dl>
               </div>
               
               
               
               <div class="section" title="1.1.&nbsp;体系图">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e61"></a>1.1.&nbsp;体系图
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <div class="mediaobject"><img src="resources/images/MVC.jpg"></div>
                  
               </div>
               
               
               <div class="section" title="1.2.&nbsp;开发规范">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e67"></a>1.2.&nbsp;开发规范
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <div class="orderedlist">
                     <ol class="orderedlist" type="1">
                        <li class="listitem">
                           
                           <p>明确MVC各层职责，不能错误使用。</p>
                           
                           
                           <p>例如Manager不能替代Dao的职责。</p>
                           
                           
                           <p>HTTPRequest、HTTPResponse和HTTPSession只能出现在Controller，不允许传递到Manager层。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>Controller层不允许编写业务逻辑，业务逻辑由Manager层处理。</p>
                           
                           
                           <p>Controller层的一个方法只能调用Manager层中的一个方法，目的是为了确保统一事务。</p>
                           
                           
                           <p>错误：</p>
                           
                           <pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> CollaborationController {
    <span class="hl-keyword">private</span> CollaborationManager collaborationManager;
    <span class="hl-keyword">private</span> AttachmentManager attachementManager;
    <span class="hl-keyword">public</span> ModelAndView newCol(){
        collaborationManager.save(...);
        attachementManager.save(...);
    }
}

<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> CollaborationManagerImpl <span class="hl-keyword">implements</span> CollaborationManager{
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> save(){
        ...
    }
}</pre>
                           
                           <p>正确：</p>
                           
                           <pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> CollaborationController {
    <span class="hl-keyword">private</span> CollaborationManager collaborationManager;
    <span class="hl-keyword">public</span> ModelAndView newCol(){
        collaborationManager.save(...);
    }
}
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> CollaborationManagerImpl <span class="hl-keyword">implements</span> CollaborationManager{
    <span class="hl-keyword">private</span> AttachmentManager attachementManager;
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> save(){
        ...
        attachementManager.save(...);
    }
}</pre>
                           </li>
                        <li class="listitem">
                           
                           <p>Controller职责不宜过多，原则上一个Controller只封装一个完整业务逻辑（CRUD）。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>Manager层中分简单复杂（或大小）方法，之间可以互相调用，目的是完成完整的业务逻辑。(Manager本身就一层，并非像图中的三层，图中体现的是跨模块的Manager调用。)</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>Manager和Dao层遵循接口开发要求，例如：Manager、ManagerImpl、Dao，DaoImpl。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>所有的异常需要抛到Manager层，由Manager层统一Catch后包装为BusinessException抛出。</p>
                           
                           
                           <p>Manager的方法不允许抛出BusinessException之外的异常。</p>
                           
                           
                           <p>建议Manager的所有方法都抛出BusinessException，但不作硬性要求（初期不抛，后续版本抛出异常会影响到调用代码）；</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>Dao不能省略，必须定义。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>Dao层支持Hibernate和JDBC两种方式。</p>
                           
                           
                           <p>原则上只允许使用Hibernate模式访问数据库。调用JDBC需评审并备案。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>只有Dao层能够书写HQL和SQL语句，Controller和Manager层不允许出现SQL。</p>
                           
                           
                           <p></p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>各层之间数据传递规范，PO与对应表字段一一对应，不允许增加额外的属性，不允许有业务逻辑；</p>
                           
                           
                           <p>PO需继承BasePO，BasePO中已实现toXml、toJSON，出于性能考虑可以覆盖实现。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>C层向V层只能返回VO对象，VO对象为类Map的结构。对于简单情况可以用PO代替VO。</p>
                           
                           
                           <p>命名规范：XXX模块对应的MVC、DAO对应各层的命名规范为
                              <em class="replaceable"><code>XXX</code></em>Controller、<em class="replaceable"><code>XXX</code></em>Manager、<em class="replaceable"><code>XXX</code></em>Dao、<em class="replaceable"><code>XXX</code></em>PO、spring-<em class="replaceable"><code>XXX</code></em>-controller.xml、spring-<em class="replaceable"><code>XXX</code></em>-manager.xml、<em class="replaceable"><code>xxx</code></em>.hbm.xml
                           </p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>基于接口编码，Manager和Dao必须定义接口，一个接口一个实现类。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>应用不允许自己调用Log4j，相应的日志由框架统一使用AOP记录。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>按模块和功能划分package，原则上一个package不能超过10对类（接口+实现）。</p>
                           
                        </li>
                     </ol>
                  </div>
                  
               </div>
               
               
               <div class="section" title="1.3.&nbsp;工具规范">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e121"></a>1.3.&nbsp;工具规范
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <div class="orderedlist">
                     <ol class="orderedlist" type="1">
                        <li class="listitem">
                           
                           <p>设计工具</p>
                           
                           
                           <p>框图可使用Visio或直接使用Powerpoint，不做特别限制，但必须提交底稿。</p>
                           
                           
                           <p>UML相关（用例、时序图、类图）使用EA。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>数据建模工具</p>
                           
                           
                           <p>使用PowerDesigner</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>JDK</p>
                           
                           
                           <p>使用JDK 1.6，编译级别设为1.6。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>XML解析器</p>
                           
                           
                           <p>只允许使用dom4j</p>
                           
                           
                           <p>对于将XML解析为Bean，建议使用Digester。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>服务器端JSON工具</p>
                           
                           
                           <p>统一使用框架提供的com.seeyon.ctp.util.json.JSONUtil。</p>
                           
                        </li>
                     </ol>
                  </div>
                  
               </div>
               
            </div>
            
            
            <div class="chapter" title="Chapter&nbsp;2.&nbsp;Java编码规范">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d5e141"></a>Chapter&nbsp;2.&nbsp;Java编码规范
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Table of Contents</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d5e143">2.1. 命名规范</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e145">2.1.1. Package命名 [NAMING.PKG-2]</a></span></dt>
                           <dt><span class="section"><a href="#d5e154">2.1.2. Class命名 [NAMING.NCL-2]</a></span></dt>
                           <dt><span class="section"><a href="#d5e161">2.1.3. Interface命名 [NAMING.NITF-2]</a></span></dt>
                           <dt><span class="section"><a href="#d5e167">2.1.4. Exception Class命名 [NAMING.NE-2]</a></span></dt>
                           <dt><span class="section"><a href="#d5e173">2.1.5. Unit Test Class命名 [NAMING.NE-2]</a></span></dt>
                           <dt><span class="section"><a href="#d5e180">2.1.6. Enum type命名 [NAMING.NENUM-2]</a></span></dt>
                           <dt><span class="section"><a href="#d5e186">2.1.7. Methods命名 [NAMING.NMP-2]</a></span></dt>
                           <dt><span class="section"><a href="#d5e193">2.1.8. Local variables命名 [NAMING.NLV-2]</a></span></dt>
                           <dt><span class="section"><a href="#d5e200">2.1.9. 常量命名 [NAMING.USF-2]</a></span></dt>
                           <dt><span class="section"><a href="#d5e206">2.1.10. 类名禁止使用java内置类名 [NAMING.DJLO-2]</a></span></dt>
                           <dt><span class="section"><a href="#d5e212">2.1.11. 标示符禁止使用java关键字 [NAMING.DJLO-2]</a></span></dt>
                           <dt><span class="section"><a href="#d5e218">2.1.12. 禁止使用sun预留包名 [NAMING.RPKG-2]</a></span></dt>
                           <dt><span class="section"><a href="#d5e224">2.1.13. 禁止仅通过大小写区分变量 [NAMING.UUVN-4]</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e230">2.2. 注释规范</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e232">2.2.1. java文件头注释 [FORMAT.MCH-2]</a></span></dt>
                           <dt><span class="section"><a href="#d5e237">2.2.2. java类注释 [JAVADOC.PJDC-2]</a></span></dt>
                           <dt><span class="section"><a href="#d5e242">2.2.3. 方法注释 [JAVADOC.PJDM-2]</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e256">2.3. 格式规范</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e258">2.3.1. 代码长度限制 [FORMAT.LL-2]</a></span></dt>
                           <dt><span class="section"><a href="#d5e262">2.3.2. 每个声明占用一个代码行 [FORMAT.OSPL-2]</a></span></dt>
                           <dt><span class="section"><a href="#d5e270">2.3.3. 使用括号分隔复杂表达式 [FORMAT.APAREN-3]</a></span></dt>
                           <dt><span class="section"><a href="#d5e278">2.3.4. 避免过于复杂的判断表达式</a></span></dt>
                           <dt><span class="section"><a href="#d5e282">2.3.5. 代码缩进使用空格代替tab [FORMAT.DUT-3]</a></span></dt>
                           <dt><span class="section"><a href="#d5e286">2.3.6. 数组声明格式 [FORMAT.IAD-3]</a></span></dt>
                           <dt><span class="section"><a href="#d5e294">2.3.7. 正确使用equals</a></span></dt>
                           <dt><span class="section"><a href="#d5e300">2.3.8. 避免不必要的小括号 [FORMAT.UP-3]</a></span></dt>
                           <dt><span class="section"><a href="#d5e306">2.3.9. 与文件同名的类应放在所有类声明的最前面 [FORMAT.FCN-4]</a></span></dt>
                           <dt><span class="section"><a href="#d5e310">2.3.10. 声明中修饰符的使用应遵循正确顺序 [FORMAT.MO-4]</a></span></dt>
                        </dl>
                     </dd>
                  </dl>
               </div>
               
               
               
               <div class="section" title="2.1.&nbsp;命名规范">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e143"></a>2.1.&nbsp;命名规范
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <div class="section" title="2.1.1.&nbsp;Package命名 [NAMING.PKG-2]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e145"></a>2.1.1.&nbsp;Package命名 [NAMING.PKG-2]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>Package命名 [NAMING.PKG-2]</p>
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>Package名必须为小写字母或数字，且必须以字母开头；</p>
                     
                     
                     <p>平台产品中要求包名为com.seeyon.ctp.xxx或com.seeyon.apps.xxx</p>
                     
                     
                     <p>xxx为应用名如collaboration、edoc ...</p>
                     
                     
                     <p>示例：</p>
                     
                     <pre class="programlisting"><span class="hl-comment">// CTP平台表单模块</span>
<span class="hl-keyword">package</span> com.seeyon.ctp.form;
<span class="hl-comment">// 会议应用</span>
<span class="hl-keyword">package</span> com.seeyon.apps.meeting;</pre>
                     </div>
                  
                  
                  <div class="section" title="2.1.2.&nbsp;Class命名 [NAMING.NCL-2]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e154"></a>2.1.2.&nbsp;Class命名 [NAMING.NCL-2]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>Class名首字母必须大写，如果是某个Interface的实现，要求命名采用Interface</p>
                     
                     
                     <p>+Impl</p>
                     
                     
                     <p>示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">interface</span> CollaborationManager{};
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> CollaborationManagerImpl <span class="hl-keyword">implements</span> CollaborationManager{
}</pre>
                     </div>
                  
                  
                  <div class="section" title="2.1.3.&nbsp;Interface命名 [NAMING.NITF-2]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e161"></a>2.1.3.&nbsp;Interface命名 [NAMING.NITF-2]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>Interface命名首字母必须大写</p>
                     
                     
                     <p>示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">interface</span> CollaborationManager{
}</pre>
                     </div>
                  
                  
                  <div class="section" title="2.1.4.&nbsp;Exception Class命名 [NAMING.NE-2]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e167"></a>2.1.4.&nbsp;Exception Class命名 [NAMING.NE-2]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>Exception class命名必须以Exception结尾</p>
                     
                     
                     <p>示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> NEFormatException <span class="hl-keyword">extends</span> Exception{
}</pre>
                     </div>
                  
                  
                  <div class="section" title="2.1.5.&nbsp;Unit Test Class命名 [NAMING.NE-2]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e173"></a>2.1.5.&nbsp;Unit Test Class命名 [NAMING.NE-2]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>Unit test class命名必须以Test结尾</p>
                     
                     
                     <p>示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> FooTest <span class="hl-keyword">extends</span> TestCase{
}</pre>
                     </div>
                  
                  
                  <div class="section" title="2.1.6.&nbsp;Enum type命名 [NAMING.NENUM-2]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e180"></a>2.1.6.&nbsp;Enum type命名 [NAMING.NENUM-2]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>Enum type命名首字母必须大写</p>
                     
                     
                     <p>示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">private</span> enum Grade { 
    A, B, C, D, F 
};</pre>
                     </div>
                  
                  
                  <div class="section" title="2.1.7.&nbsp;Methods命名 [NAMING.NMP-2]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e186"></a>2.1.7.&nbsp;Methods命名 [NAMING.NMP-2]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>Method命名首字母必须小写</p>
                     
                     
                     <p>示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> NMFixed {
    <span class="hl-keyword">void</span> method () { &nbsp;<span class="hl-comment">// FIXED</span>
    }
}</pre>
                     </div>
                  
                  
                  <div class="section" title="2.1.8.&nbsp;Local variables命名 [NAMING.NLV-2]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e193"></a>2.1.8.&nbsp;Local variables命名 [NAMING.NLV-2]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>Local variable命名首字母必须小写</p>
                     
                     
                     <p>示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">private</span> <span class="hl-keyword">int</span> example = <span class="hl-number">0</span>;</pre>
                     </div>
                  
                  
                  <div class="section" title="2.1.9.&nbsp;常量命名 [NAMING.USF-2]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e200"></a>2.1.9.&nbsp;常量命名 [NAMING.USF-2]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>所有用 ”final”、”static” 修饰的变量命名要求全大写</p>
                     
                     
                     <p>示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">final</span> <span class="hl-keyword">int</span> SIZE = <span class="hl-number">10</span>;
<span class="hl-keyword">private</span> <span class="hl-keyword">static</span> <span class="hl-keyword">final</span> Logger LOGGER;</pre>
                     </div>
                  
                  
                  <div class="section" title="2.1.10.&nbsp;类名禁止使用java内置类名 [NAMING.DJLO-2]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e206"></a>2.1.10.&nbsp;类名禁止使用java内置类名 [NAMING.DJLO-2]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>类名禁止使用java内置类名</p>
                     
                     
                     <p>错误示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> Integer{
}</pre>
                     </div>
                  
                  
                  <div class="section" title="2.1.11.&nbsp;标示符禁止使用java关键字 [NAMING.DJLO-2]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e212"></a>2.1.11.&nbsp;标示符禁止使用java关键字 [NAMING.DJLO-2]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>标示符禁止使用java关键字</p>
                     
                     
                     <p>错误示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">private</span> String enum;
<span class="hl-keyword">private</span> <span class="hl-keyword">int</span> assert;</pre>
                     </div>
                  
                  
                  <div class="section" title="2.1.12.&nbsp;禁止使用sun预留包名 [NAMING.RPKG-2]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e218"></a>2.1.12.&nbsp;禁止使用sun预留包名 [NAMING.RPKG-2]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>禁止使用sun预留包名</p>
                     
                     
                     <p>错误示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">package</span> java.rules.naming;</pre>
                     </div>
                  
                  
                  <div class="section" title="2.1.13.&nbsp;禁止仅通过大小写区分变量 [NAMING.UUVN-4]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e224"></a>2.1.13.&nbsp;禁止仅通过大小写区分变量 [NAMING.UUVN-4]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>&nbsp;禁止仅通过大小写区分变量</p>
                     
                     
                     <p>错误示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">int</span> foo = <span class="hl-number">9</span>;
<span class="hl-keyword">int</span> Foo = <span class="hl-number">9</span>;</pre>
                     </div>
                  
               </div>
               
               
               <div class="section" title="2.2.&nbsp;注释规范">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e230"></a>2.2.&nbsp;注释规范
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <div class="section" title="2.2.1.&nbsp;java文件头注释 [FORMAT.MCH-2]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e232"></a>2.2.1.&nbsp;java文件头注释 [FORMAT.MCH-2]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>所有java文件需要在文件头添加如下注释段：</p>
                     
                     <pre class="programlisting"><span class="hl-doctype">/**
 * $Author$
 * $Rev$
 * $Date::                     $:
 *
 * Copyright (C) 2012 Seeyon, Inc. All rights reserved.
 *
 * This software is the proprietary information of Seeyon, Inc.
 * Use is subject to license terms.
 */</span>
<span class="hl-keyword">package</span> xx.xx.xx;
<span class="hl-keyword">import</span> xx.xx; </pre>
                     </div>
                  
                  
                  <div class="section" title="2.2.2.&nbsp;java类注释 [JAVADOC.PJDC-2]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e237"></a>2.2.2.&nbsp;java类注释 [JAVADOC.PJDC-2]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>所有java类需按以下格式添加类注释：</p>
                     
                     <pre class="programlisting"><span class="hl-doctype">/**
&nbsp;* &lt;p&gt;Title: 应用模块名称&lt;/p&gt;
&nbsp;* &lt;p&gt;Description: 代码描述&lt;/p&gt;
&nbsp;* &lt;p&gt;Copyright: Copyright (c) 2012&lt;/p&gt;
&nbsp;* &lt;p&gt;Company: seeyon.com&lt;/p&gt;
&nbsp;*/</span>
<span class="hl-keyword">public</span> <span class="hl-keyword">final</span> <span class="hl-keyword">class</span> MyClass</pre>
                     </div>
                  
                  
                  <div class="section" title="2.2.3.&nbsp;方法注释 [JAVADOC.PJDM-2]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e242"></a>2.2.3.&nbsp;方法注释 [JAVADOC.PJDM-2]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>所有方法需按以下格式添加方法注释，继承的方法可以使用’@see’、’ @inheritDoc’ tag：</p>
                     
                     <pre class="programlisting"><span class="hl-doctype">/**
&nbsp; * Executes a mapped SQL SELECT statement that returns data to populate
&nbsp; * a number of result objects within a certain range.
&nbsp; *
&nbsp; * @param id The name of the statement to execute.
&nbsp; * @param skip The number of results to ignore.
&nbsp; * @param max The maximum number of results to return.
&nbsp; * @return A List of result objects.
&nbsp; * @throws java.sql.SQLException If an error occurs.
&nbsp; */</span>
&nbsp; List queryForList(String id, <span class="hl-keyword">int</span> skip, <span class="hl-keyword">int</span> max) <span class="hl-keyword">throws</span> SQLException;</pre>
                     
                     <p>相关校验点：</p>
                     
                     
                     <div class="blockquote">
                        <blockquote class="blockquote">
                           
                           <p>[JAVADOC.DPMT-2]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 避免无用的javadoc tag</p>
                           
                           
                           <p>[JAVADOC.MDJT-2]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 注释内容要有意义</p>
                           
                           
                           <p>[JAVADOC.PARAM-2]&nbsp; &nbsp; &nbsp; &nbsp; 每个param都要有'@param' tag</p>
                           
                           
                           <p>[JAVADOC.MRDC-2]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 有返回值的方法必须使用'@return'
                              tag
                           </p>
                           
                           
                           <p>[JAVADOC.THROW-2]&nbsp; &nbsp; &nbsp; &nbsp; 有异常抛出的方法必须使用'@throws' 或 '@exception'
                              tag
                           </p>
                           
                           
                           <p>[JAVADOC.VMCR-2]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 无返回值的方法不要有'@return' tag</p>
                           
                           
                           <p>[JAVADOC.BT-4]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 不允许使用javadoc中未定义的'@' tag</p>
                           
                        </blockquote>
                     </div>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="2.3.&nbsp;格式规范">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e256"></a>2.3.&nbsp;格式规范
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <div class="section" title="2.3.1.&nbsp;代码长度限制 [FORMAT.LL-2]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e258"></a>2.3.1.&nbsp;代码长度限制 [FORMAT.LL-2]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>每行代码长度不能超过120个字符</p>
                     
                  </div>
                  
                  
                  <div class="section" title="2.3.2.&nbsp;每个声明占用一个代码行 [FORMAT.OSPL-2]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e262"></a>2.3.2.&nbsp;每个声明占用一个代码行 [FORMAT.OSPL-2]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>每个声明占用一行代码</p>
                     
                     
                     <p>错误示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">int</span> i = a + b; <span class="hl-keyword">return</span> i;</pre>
                     
                     <p>正确示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">int</span> i = a + b;
<span class="hl-keyword">return</span> i;</pre>
                     </div>
                  
                  
                  <div class="section" title="2.3.3.&nbsp;使用括号分隔复杂表达式 [FORMAT.APAREN-3]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e270"></a>2.3.3.&nbsp;使用括号分隔复杂表达式 [FORMAT.APAREN-3]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>使用括号分隔复杂表达式提高代码可读性</p>
                     
                     
                     <p>错误示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">if</span> (i &gt;= j &amp;&amp; i &gt;= <span class="hl-number">0</span>)</pre>
                     
                     <p>正确示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">if</span> ((i &gt;= j) &amp;&amp; (i &gt;= <span class="hl-number">0</span>))</pre>
                     </div>
                  
                  
                  <div class="section" title="2.3.4.&nbsp;避免过于复杂的判断表达式">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e278"></a>2.3.4.&nbsp;避免过于复杂的判断表达式
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     <pre class="programlisting"><span class="hl-keyword">if</span> ( workTimeSpecials.size() &gt; <span class="hl-number">0</span> &amp;&amp; !workTimeSpecials.get(<span class="hl-number">0</span>).getIsRest().equals(<span class="hl-string">"0"</span>)) 
    || workTimeSpecials.size() == <span class="hl-number">0</span> &amp;&amp; !isWorkDay) {
        <span class="hl-keyword">return</span>;
}</pre><p>遇到这样的表达式，请使用Extract Local Variable提取为意义明确的变量。</p>
                     
                  </div>
                  
                  
                  <div class="section" title="2.3.5.&nbsp;代码缩进使用空格代替tab [FORMAT.DUT-3]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e282"></a>2.3.5.&nbsp;代码缩进使用空格代替tab [FORMAT.DUT-3]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>代码缩进使用空格代替tab保证代码在非windows系统环境下的可读性</p>
                     
                  </div>
                  
                  
                  <div class="section" title="2.3.6.&nbsp;数组声明格式 [FORMAT.IAD-3]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e286"></a>2.3.6.&nbsp;数组声明格式 [FORMAT.IAD-3]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>数组声明[]放在type后面而不是变量后面</p>
                     
                     
                     <p>错误示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">private</span> String str1[], str2[], str3[];</pre>
                     
                     <p>正确示例：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">private</span> String [] str1, str2, str3;</pre>
                     </div>
                  
                  
                  <div class="section" title="2.3.7.&nbsp;正确使用equals">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e294"></a>2.3.7.&nbsp;正确使用equals
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>错误示例：</p>
                     
                     <pre class="programlisting">str.equals(<span class="hl-string">"0"</span>);</pre>
                     
                     <p>正确示例：</p>
                     
                     <pre class="programlisting"><span class="hl-string">"0"</span>.equals(str); <span class="hl-comment">// 规避str为null时的空指针异常</span></pre>
                     </div>
                  
                  
                  <div class="section" title="2.3.8.&nbsp;避免不必要的小括号 [FORMAT.UP-3]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e300"></a>2.3.8.&nbsp;避免不必要的小括号 [FORMAT.UP-3]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>避免不必要的小括号</p>
                     
                     
                     <p>错误示例：</p>
                     
                     <pre class="programlisting">i = (i + <span class="hl-number">2</span>);</pre>
                     </div>
                  
                  
                  <div class="section" title="2.3.9.&nbsp;与文件同名的类应放在所有类声明的最前面 [FORMAT.FCN-4]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e306"></a>2.3.9.&nbsp;与文件同名的类应放在所有类声明的最前面 [FORMAT.FCN-4]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>如果一个文件中定义了多个类，那么与文件同名的类作为主类应放在代码的最前面</p>
                     
                  </div>
                  
                  
                  <div class="section" title="2.3.10.&nbsp;声明中修饰符的使用应遵循正确顺序 [FORMAT.MO-4]">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e310"></a>2.3.10.&nbsp;声明中修饰符的使用应遵循正确顺序 [FORMAT.MO-4]
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>描述：</p>
                     
                     
                     <p>声明中修饰符的使用应遵循以下顺序：</p>
                     
                     
                     <div class="blockquote">
                        <blockquote class="blockquote">
                           
                           <p>annotations</p>
                           
                           
                           <p>public/protected/private</p>
                           
                           
                           <p>abstract</p>
                           
                           
                           <p>static</p>
                           
                           
                           <p>final</p>
                           
                           
                           <p>transient</p>
                           
                           
                           <p>volatile</p>
                           
                           
                           <p>synchronized</p>
                           
                           
                           <p>native</p>
                           
                           
                           <p>strictfp</p>
                           
                        </blockquote>
                     </div>
                     
                  </div>
                  
               </div>
               
            </div>
            
         </div>
         
         
         <div class="part" title="Part&nbsp;II.&nbsp;CTP前端开发规范">
            <div class="titlepage">
               <div>
                  <div>
                     <h1 class="title"><a name="d5e325"></a>Part&nbsp;II.&nbsp;CTP前端开发规范
                     </h1>
                  </div>
               </div>
            </div>
            <div class="toc">
               <p><b>Table of Contents</b></p>
               <dl>
                  <dt><span class="preface"><a href="#d5e327">基本原则</a></span></dt>
                  <dt><span class="chapter"><a href="#d5e346">3. 页面开发规范</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d5e348">3.1. 代码结构</a></span></dt>
                        <dt><span class="section"><a href="#d5e356">3.2. 命名</a></span></dt>
                        <dt><span class="section"><a href="#d5e359">3.3. 页面结构</a></span></dt>
                        <dt><span class="section"><a href="#d5e371">3.4. HTML书写规范</a></span></dt>
                        <dt><span class="section"><a href="#d5e396">3.5. JSTL &amp; EL</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d5e411">4. Javascript开发规范</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d5e418">4.1. 编码规范</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e420">4.1.1. 文件</a></span></dt>
                              <dt><span class="section"><a href="#d5e426">4.1.2. 命名</a></span></dt>
                              <dt><span class="section"><a href="#d5e445">4.1.3. 行长度</a></span></dt>
                              <dt><span class="section"><a href="#d5e448">4.1.4. 缩进</a></span></dt>
                              <dt><span class="section"><a href="#d5e451">4.1.5. 注释</a></span></dt>
                              <dt><span class="section"><a href="#d5e460">4.1.6. 代码风格</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e485">4.2. jQuery</a></span></dt>
                        <dt><span class="section"><a href="#d5e488">4.3. 面向对象</a></span></dt>
                        <dt><span class="section"><a href="#d5e493">4.4. 事件绑定</a></span></dt>
                        <dt><span class="section"><a href="#d5e500">4.5. 限制</a></span></dt>
                        <dt><span class="section"><a href="#d5e530">4.6. Ajax</a></span></dt>
                        <dt><span class="section"><a href="#d5e537">4.7. 附录</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e539">4.7.1. jsdoc常用关键字</a></span></dt>
                           </dl>
                        </dd>
                     </dl>
                  </dd>
               </dl>
            </div>
            
            
            
            <div class="preface" title="基本原则">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d5e327"></a>基本原则
                        </h2>
                     </div>
                  </div>
               </div>
               
               
               
               <div class="orderedlist">
                  <ol class="orderedlist" type="1">
                     <li class="listitem">
                        
                        <p>兼容性</p>
                        
                        
                        <p>兼容多浏览器 （IE6、7、8、9、10、Firefox、Chrome、Safari）</p>
                        
                        
                        <p>但暂不考虑跨设备的兼容，只对iPad作一定的兼容性改进。</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>一致性</p>
                        
                        
                        <p>UE交互保持一致性</p>
                        
                        
                        <p>UI风格保持一致性</p>
                        
                        
                        <p>代码风格保持一致性</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>易测性</p>
                        
                        
                        <p>应用组件开发时必须考虑易测性，为自动化测试提供方便 。</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>适度先进性</p>
                        
                        
                        <p>谨慎引入第三方前端库，引入时需要充分考虑性能、稳定性、可维护性和技能要求。</p>
                        
                     </li>
                  </ol>
               </div>
               
            </div>
            
            
            <div class="chapter" title="Chapter&nbsp;3.&nbsp;页面开发规范">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d5e346"></a>Chapter&nbsp;3.&nbsp;页面开发规范
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Table of Contents</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d5e348">3.1. 代码结构</a></span></dt>
                     <dt><span class="section"><a href="#d5e356">3.2. 命名</a></span></dt>
                     <dt><span class="section"><a href="#d5e359">3.3. 页面结构</a></span></dt>
                     <dt><span class="section"><a href="#d5e371">3.4. HTML书写规范</a></span></dt>
                     <dt><span class="section"><a href="#d5e396">3.5. JSTL &amp; EL</a></span></dt>
                  </dl>
               </div>
               
               
               
               <div class="section" title="3.1.&nbsp;代码结构">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e348"></a>3.1.&nbsp;代码结构
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>jsp文件放到各Project的WebContent/WEB-INF/jsp/apps/{module}下。</p>
                  
                  
                  <p>如</p>
                  <div class="example"><a name="d5e352"></a><p class="title"><b>Example&nbsp;3.1.&nbsp;</b></p>
                     <div class="example-contents">
                        
                        
                        
                        <p><code class="filename">f1_collaboation/WebContent/WEB-INF/jsp/apps/collaboration/listPending.jsp</code>。
                        </p>
                        
                     </div>
                  </div>
                  <p><br class="example-break"></p>
                  
               </div>
               
               
               <div class="section" title="3.2.&nbsp;命名">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e356"></a>3.2.&nbsp;命名
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>camel命名风格</p>
                  
               </div>
               
               
               <div class="section" title="3.3.&nbsp;页面结构">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e359"></a>3.3.&nbsp;页面结构
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>禁止在页面中</p>
                  
                  
                  <div class="orderedlist">
                     <ol class="orderedlist" type="1">
                        <li class="listitem">
                           
                           <p>定义css样式。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>在style属性中直接书写样式。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>引入除本页面同名js之外的任何js文件。（Portal如需引入第三方js，需要评审）</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>使用@page import引入Java类。</p>
                           
                        </li>
                     </ol>
                  </div>
                  
               </div>
               
               
               <div class="section" title="3.4.&nbsp;HTML书写规范">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e371"></a>3.4.&nbsp;HTML书写规范
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <div class="orderedlist">
                     <ol class="orderedlist" type="1">
                        <li class="listitem">
                           
                           <p>HTML 标签必须成对使用，base br col hr img input meta link除外。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>HTML里的注释：&lt;%-- 被注释的内容 --%&gt;。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>所有的标签名必须小写。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>所有的标签属性名必须小写。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>所有的标签属性值都必须用双引号包起来。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>书写 HTML 代码的时候代码缩进。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>表现与结构完全分离，代码中不涉及任何的表现元素，如style、font、bgColor、border等。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>尽可能减少 div 嵌套。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>给图片加上alt标签。</p>
                           
                        </li>
                     </ol>
                  </div>
                  
                  
                  <p>规范的书写示例如下：</p>
                  
                  <pre class="programlisting"><span class="hl-tag">&lt;html&gt;</span>
    <span class="hl-tag">&lt;head&gt;</span>
    <span class="hl-tag">&lt;/head&gt;</span>
    <span class="hl-tag">&lt;body&gt;</span>
        <span class="hl-tag">&lt;div</span> <span class="hl-attribute">id</span>=<span class="hl-value">"panel"</span>  <span class="hl-attribute">class</span>=<span class="hl-value">"panel"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;/div&gt;</span>
    <span class="hl-tag">&lt;/body&gt;</span>
<span class="hl-tag">&lt;/html&gt;</span></pre>
                  </div>
               
               
               <div class="section" title="3.5.&nbsp;JSTL &amp; EL">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e396"></a>3.5.&nbsp;JSTL &amp; EL
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>限制使用，只能使用循环、el、少用if。</p>
                  
                  
                  <p>原有的taglib逐步进行迁移</p>
                  
                  
                  <p>只允许使用JSTL core、JSTL fmt 和JSTL functions 的部分tag，不允许使用JSTL sql和JSTL
                     XML。
                  </p>
                  
                  
                  <p>允许使用的tag列表</p>
                  
                  
                  <div class="orderedlist">
                     <ol class="orderedlist" type="1">
                        <li class="listitem">
                           
                           <p>c:out</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>c:url</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>c:forEach &amp; c:if</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>fmt:message</p>
                           
                        </li>
                     </ol>
                  </div>
                  
               </div>
               
            </div>
            
            
            <div class="chapter" title="Chapter&nbsp;4.&nbsp;Javascript开发规范">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d5e411"></a>Chapter&nbsp;4.&nbsp;Javascript开发规范
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Table of Contents</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d5e418">4.1. 编码规范</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e420">4.1.1. 文件</a></span></dt>
                           <dt><span class="section"><a href="#d5e426">4.1.2. 命名</a></span></dt>
                           <dt><span class="section"><a href="#d5e445">4.1.3. 行长度</a></span></dt>
                           <dt><span class="section"><a href="#d5e448">4.1.4. 缩进</a></span></dt>
                           <dt><span class="section"><a href="#d5e451">4.1.5. 注释</a></span></dt>
                           <dt><span class="section"><a href="#d5e460">4.1.6. 代码风格</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e485">4.2. jQuery</a></span></dt>
                     <dt><span class="section"><a href="#d5e488">4.3. 面向对象</a></span></dt>
                     <dt><span class="section"><a href="#d5e493">4.4. 事件绑定</a></span></dt>
                     <dt><span class="section"><a href="#d5e500">4.5. 限制</a></span></dt>
                     <dt><span class="section"><a href="#d5e530">4.6. Ajax</a></span></dt>
                     <dt><span class="section"><a href="#d5e537">4.7. 附录</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e539">4.7.1. jsdoc常用关键字</a></span></dt>
                        </dl>
                     </dd>
                  </dl>
               </div>
               
               
               
               <div class="tip" title="Tip" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <table border="0" summary="Tip">
                     <tr>
                        <td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="resources/admonitions/tip.png"></td>
                        <th align="left">Tip</th>
                     </tr>
                     <tr>
                        <td align="left" valign="top">
                           
                           <p>制定规范是为了质量更高、错误更少、更易于维护。</p>
                           
                           
                           <p>Any violation to this guide is allowed if it enhances readability.
                              所有的代码都要变成可供他人容易阅读的。
                           </p>
                           
                           
                           <p>“编程风格”的选择不应该基于个人爱好、熟悉程度、打字工作量等因素，而要考虑如何尽量使代码清晰易读、减少出错。</p>
                           
                           
                           <p>你选择的，不是你喜欢的风格，而是一种能够清晰表达你的意图的风格。</p>
                           
                        </td>
                     </tr>
                  </table>
               </div>
               
               
               <div class="section" title="4.1.&nbsp;编码规范">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e418"></a>4.1.&nbsp;编码规范
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <div class="section" title="4.1.1.&nbsp;文件">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e420"></a>4.1.1.&nbsp;文件
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>JavaScript 程序应独立保存在后缀名为 .js 的文件中。</p>
                     
                     
                     <p>原则上，JavaScript 代码不应该被包含在 HTML 文件中。在 HTML
                        中的JavaScript代码会明显增加文件大小，而且也不能对其进行缓存和压缩。
                     </p>
                     
                     
                     <p>模块的公开js，放到common/js/apps/{module}下，名称为模块名称，如common/js/apps/collaboration/collaboration_pub.js；发布时将被合并到主js文件。</p>
                     
                     
                     <p>页面js放到WebContent/apps/{module}下，建立与jsp同名的js文件，如WebContent/apps/collaboration/listPending.js。</p>
                     
                  </div>
                  
                  
                  <div class="section" title="4.1.2.&nbsp;命名">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e426"></a>4.1.2.&nbsp;命名
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>命名总的原则为：骆驼、自然语言、英文</p>
                     
                     
                     <div class="orderedlist">
                        <ol class="orderedlist" type="1">
                           <li class="listitem">
                              
                              <p>名称只能包含下面的字符：26个大小写字符 (A .. Z， a .. z), 数字(0 .. 9)，和 下划线
                                 (_)。不允许使用中文或特殊字符。首字母下划线只能用于私有方法和全局变量。
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>变量名称必须为小写字母，请使用英文名词，如department ;。对象的属性或方法名采用小驼峰式(lower
                                 camel-case)，如”init”, “bindEvent”, “updatePosition”：
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>类的命名使用骆驼命名规则，例如：Account, EventHandler</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>常量必须在对象（类）或者枚举变量的前部声明。枚举变量的命名必须要有实际的意义，并且其成员 必须
                                 使用骆驼命名规则或使用大写：
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>不允许使用单词简写 。私有变量名用下划线开头。如：”_current”, “_defaultConfig”</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>不能使用大写名称作为变量名。常量名全部大写，单词间用下划线分隔。如：”CSS_BTN_CLOSE”,
                                 “TXT_LOADING”
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>方法和函数名应该以动词开始如getName()，返回bool类型的函数应该以is开始，例如isEnable()；不必担心长度，因为后期发布时会压缩。</p>
                              
                              
                              <p>除了构造方法可以使用大写，首字母必须小写。</p>
                              
                           </li>
                        </ol>
                     </div>
                     
                  </div>
                  
                  
                  <div class="section" title="4.1.3.&nbsp;行长度">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e445"></a>4.1.3.&nbsp;行长度
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>避免每行超过 120 个字符。当一条语句一行写不下时，请考虑折行。</p>
                     
                  </div>
                  
                  
                  <div class="section" title="4.1.4.&nbsp;缩进">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e448"></a>4.1.4.&nbsp;缩进
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>缩进的单位为四个空格，避免使用 Tab 键来缩进。</p>
                     
                  </div>
                  
                  
                  <div class="section" title="4.1.5.&nbsp;注释">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e451"></a>4.1.5.&nbsp;注释
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>使用jsdoc语法书写注释。例如：</p>
                     
                     <pre class="programlisting"><span class="hl-comment">/**
 * 取得指定key的国际化资源。
 * @param {String} key 资源的key。
 * @return {String} 国际化资源文本。
 */</span>
CTP.<span class="hl-keyword">prototype</span>.getMessage = <span class="hl-keyword">function</span>(key){
    ...
}
</pre>
                     
                     <p>jsdoc常用关键字参见附录。</p>
                     
                     
                     <div class="tip" title="Tip" style="margin-left: 0.5in; margin-right: 0.5in;">
                        <table border="0" summary="Tip">
                           <tr>
                              <td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="resources/admonitions/tip.png"></td>
                              <th align="left">Tip</th>
                           </tr>
                           <tr>
                              <td align="left" valign="top">
                                 
                                 <p>不要吝啬注释。给以后需要理解你的代码的人们（或许就是你自己）留下信息是非常有用的。</p>
                                 
                                 
                                 <p>注释应该和它们所注释的代码一样是书写良好且清晰明了。偶尔的小幽默就更不错了。</p>
                                 
                                 
                                 <p>记得要避免冗长或者情绪化。 及时地更新注释也很重要。错误的注释会让程序更加难以阅读和理解。</p>
                                 
                              </td>
                           </tr>
                        </table>
                     </div>
                     
                  </div>
                  
                  
                  <div class="section" title="4.1.6.&nbsp;代码风格">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e460"></a>4.1.6.&nbsp;代码风格
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>遵循<a class="ulink" href="http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml#Formatting" target="_top">C++风格</a>，参照下面的示例：
                     </p>
                     
                     <pre class="programlisting"><span class="hl-comment">/**
 * 取得指定key的国际化资源。
 * @param {String} key 资源的key。
 * @return {String} 国际化资源文本。
 */</span>
CTP.<span class="hl-keyword">prototype</span>.getMessage = <span class="hl-keyword">function</span>( key ){
    <a name="js_codestyle_0"></a><img src="resources/callouts/1.png" alt="1" border="0"><span class="hl-keyword">try</span>{
        <span class="hl-keyword">var</span><a name="js_codestyle_1"></a><img src="resources/callouts/2.png" alt="2" border="0"> msg = <span class="hl-keyword">eval</span>( <span class="hl-string">''</span> + key );<a name="js_codestyle_2"></a><img src="resources/callouts/3.png" alt="3" border="0">
        <span class="hl-keyword">if</span>( msg &amp;&amp; arguments.length &gt; <span class="hl-number">1</span> ){
            <span class="hl-keyword">for</span>( <span class="hl-keyword">var</span> i = <span class="hl-number">0</span>; i &lt; arguments.length - <span class="hl-number">1</span>; i++ ) {<a name="js_codestyle_3"></a><img src="resources/callouts/4.png" alt="4" border="0">
                <span class="hl-keyword">var</span> regEx = <span class="hl-keyword">eval</span>(<span class="hl-string">'messageRegEx_'</span> + i);
                <span class="hl-keyword">var</span> repMe = <span class="hl-string">''</span> + arguments[i + <span class="hl-number">1</span>];
                <span class="hl-keyword">if</span>( repMe.indexOf( <span class="hl-string">'$_'</span> ) !==<a name="js_codestyle_4"></a><img src="resources/callouts/5.png" alt="5" border="0"> -<span class="hl-number">1</span> ){
                    repMe = repMe.replace(<span class="hl-string">'$_'</span>, <span class="hl-string">'$$_'</span><a name="js_codestyle_5"></a><img src="resources/callouts/6.png" alt="6" border="0">);
                }
                msg = msg.replace( regEx, repMe );
            }
        }
        <span class="hl-keyword">return</span> msg;
    }
    <span class="hl-keyword">catch</span>(e){
    }
    <span class="hl-keyword">return</span> <span class="hl-string">""</span>;
}</pre><div class="calloutlist">
                        <table border="0" summary="Callout list">
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#js_codestyle_0"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>保持缩进，四个空格。</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#js_codestyle_1"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>变量定义不要省略var。</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#js_codestyle_2"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>不要省略句末的分号。</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#js_codestyle_3"><img src="resources/callouts/4.png" alt="4" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>所有的循环和判断都需要用“{}”括起来。</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#js_codestyle_4"><img src="resources/callouts/5.png" alt="5" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>使用严格的条件判断符。用===代替==，用!==代替!=。</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#js_codestyle_5"><img src="resources/callouts/6.png" alt="6" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>使用单引号，而不是双引号。</p>
                                 
                              </td>
                           </tr>
                        </table>
                     </div>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="4.2.&nbsp;jQuery">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e485"></a>4.2.&nbsp;jQuery
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>不使用js去生成html，可以用它再加工前端的html</p>
                  
               </div>
               
               
               <div class="section" title="4.3.&nbsp;面向对象">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e488"></a>4.3.&nbsp;面向对象
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>Javascript面向对象编程，涉及到代码复用、功能扩展、对象继承、闭包、优化等很多问题，能省去不少编码，便于维护，还能不改变框架源代码而实现不同的功能。</p>
                  
                  
                  <p>类定义采取下面的方式</p>
                  
                  <pre class="programlisting"><span class="hl-comment">/**
 * CTP基础前端对象。
 */</span>
<span class="hl-keyword">function</span> CTP(){
    <span class="hl-keyword">this</span>.isChrome = ua.indexOf( <span class="hl-string">'Chrome'</span> ) !== -<span class="hl-number">1</span>;
    ...
    <span class="hl-keyword">this</span>.settings = {
        dialog_type : <span class="hl-string">'modal'</span>,
        resizable : <span class="hl-string">'yes'</span>,
        scrollbars : <span class="hl-string">'yes'</span>
    };
}
<span class="hl-comment">/**
 * 初始化方法。
 * @param {String} contextPath 上下文路径
 * @param {String} language 语言
 */</span>
CTP.<span class="hl-keyword">prototype</span>.init = <span class="hl-keyword">function</span>( contextPath, language ){    
}

CTP.<span class="hl-keyword">prototype</span>.getCurrentBrowser = <span class="hl-keyword">function</span>(){

}</pre>
                  </div>
               
               
               <div class="section" title="4.4.&nbsp;事件绑定">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e493"></a>4.4.&nbsp;事件绑定
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>不允许在html中绑定事件</p>
                  
                  <pre class="programlisting">&lt;input id="btnOk" type="button" <span class="emphasis"><em>onclick="doSth()"</em></span>/&gt;</pre>
                  
                  <p>请使用下面的方式绑定事件</p>
                  
                  <pre class="programlisting">$(<span class="hl-string">'#btnOk'</span>).click(<span class="hl-keyword">function</span>(){
    <span class="hl-comment">// doSth</span>
})</pre>
                  </div>
               
               
               <div class="section" title="4.5.&nbsp;限制">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e500"></a>4.5.&nbsp;限制
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <div class="orderedlist">
                     <ol class="orderedlist" type="1">
                        <li class="listitem">
                           
                           <p>不要省略句末的分号。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>不要使用with, void, evil。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>使用严格的条件判断符。用===代替==，用!==代替!=。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>不要将不同目的的语句，合并成一行。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>所有变量声明都放在函数的头部，避免使用未声明的变量。</p>
                           
                           
                           <p>这么做可以让程序易于阅读，且也容易发现那些没声明的变量(它们会被编译成全局变量)。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>所有函数都在使用之前定义。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>避免使用全局变量；如果不得不使用，用大写字母表示变量名，比如UPPER_CASE。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>不要使用自增（++）和自减（--）运算符，用+=和-=代替。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>下面类型的对象不建议用new构造：new Number, new String, new Boolean, new
                              Object(用{}代替), new Array(用[]代替)。
                           </p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>引用对象成员用obj.prop1代替obj['prop1']，除非属性名是变量。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>尽量减少全局变量的使用。不要让局部变量覆盖全局变量。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>所有的循环和判断都需要用“{}”括起来。</p>
                           
                           
                           <p>更多细节请参考<a class="ulink" href="http://google-styleguide.googlecode.com/svn/trunk/javascriptguide.xml" target="_top">Google的Javascript规范</a>。
                           </p>
                           
                        </li>
                     </ol>
                  </div>
                  
               </div>
               
               
               <div class="section" title="4.6.&nbsp;Ajax">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e530"></a>4.6.&nbsp;Ajax
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <div class="orderedlist">
                     <ol class="orderedlist" type="1">
                        <li class="listitem">
                           
                           <p>传输数据而不是 HTML</p>
                           
                           
                           <p>Ajax请求和响应使用JSON，不要传递XML、HTML或Script</p>
                           
                        </li>
                     </ol>
                  </div>
                  
               </div>
               
               
               <div class="section" title="4.7.&nbsp;附录">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e537"></a>4.7.&nbsp;附录
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <div class="section" title="4.7.1.&nbsp;jsdoc常用关键字">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e539"></a>4.7.1.&nbsp;jsdoc常用关键字
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <div class="informaltable">
                        
                        <table border="1">
                           <colgroup>
                              <col width="50%">
                              <col width="50%">
                           </colgroup>
                           <tbody>
                              <tr>
                                 <td>author</td>
                                 <td>标识代码作者</td>
                              </tr>
                              <tr>
                                 <td>class</td>
                                 <td>标识该函数是一个类的构造函数</td>
                              </tr>
                              <tr>
                                 <td>constant</td>
                                 <td>声明常量</td>
                              </tr>
                              <tr>
                                 <td>constructor</td>
                                 <td>同class</td>
                              </tr>
                              <tr>
                                 <td>default</td>
                                 <td>默认值</td>
                              </tr>
                              <tr>
                                 <td>deprecated</td>
                                 <td>声明已弃用的对象</td>
                              </tr>
                              <tr>
                                 <td>description</td>
                                 <td>对象描述</td>
                              </tr>
                              <tr>
                                 <td>event</td>
                                 <td>事件函数</td>
                              </tr>
                              <tr>
                                 <td>example</td>
                                 <td>例子代码</td>
                              </tr>
                              <tr>
                                 <td>fileOverview</td>
                                 <td>Javascript文件总体描述</td>
                              </tr>
                              <tr>
                                 <td>ignore</td>
                                 <td>忽略有这个标记的函数</td>
                              </tr>
                              <tr>
                                 <td>link</td>
                                 <td>与其他JsDoc对象关联</td>
                              </tr>
                              <tr>
                                 <td>name</td>
                                 <td>显示声明JsDoc不能自动检测的对象</td>
                              </tr>
                              <tr>
                                 <td>namespace</td>
                                 <td>声明命名空间</td>
                              </tr>
                              <tr>
                                 <td>param</td>
                                 <td>参数</td>
                              </tr>
                              <tr>
                                 <td>private</td>
                                 <td>声明私有对象</td>
                              </tr>
                              <tr>
                                 <td>property</td>
                                 <td>显式声明一个属性</td>
                              </tr>
                              <tr>
                                 <td>public</td>
                                 <td>声明公开对象</td>
                              </tr>
                              <tr>
                                 <td>requires</td>
                                 <td>声明所依赖的对象或文件</td>
                              </tr>
                              <tr>
                                 <td>returns</td>
                                 <td>返回值</td>
                              </tr>
                              <tr>
                                 <td>see</td>
                                 <td>声明可参考的其它对象</td>
                              </tr>
                              <tr>
                                 <td>since</td>
                                 <td>声明对象从指定版本开始生效</td>
                              </tr>
                              <tr>
                                 <td>static</td>
                                 <td>显式声明一个静态对象</td>
                              </tr>
                              <tr>
                                 <td>throws</td>
                                 <td>声明函数执行过程中可能抛出的异常</td>
                              </tr>
                              <tr>
                                 <td>type</td>
                                 <td>声明变量类型或者函数返回值类型</td>
                              </tr>
                              <tr>
                                 <td>version</td>
                                 <td>版本号</td>
                              </tr>
                           </tbody>
                        </table>
                        
                     </div>
                     
                  </div>
                  
               </div>
               
            </div>
            
         </div>
         
         
         <div class="part" title="Part&nbsp;III.&nbsp;CTP后台开发手册">
            <div class="titlepage">
               <div>
                  <div>
                     <h1 class="title"><a name="d5e623"></a>Part&nbsp;III.&nbsp;CTP后台开发手册
                     </h1>
                  </div>
               </div>
            </div>
            <div class="toc">
               <p><b>Table of Contents</b></p>
               <dl>
                  <dt><span class="chapter"><a href="#d5e625">5. 开发环境</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d5e629">5.1. 获取CTP发布</a></span></dt>
                        <dt><span class="section"><a href="#d5e636">5.2. 获取Eclipse All-In-One</a></span></dt>
                        <dt><span class="section"><a href="#d5e641">5.3. 建立开发环境</a></span></dt>
                        <dt><span class="section"><a href="#d5e685">5.4. 配置数据库连接</a></span></dt>
                        <dt><span class="section"><a href="#d5e690">5.5. 建立运行环境</a></span></dt>
                        <dt><span class="section"><a href="#d5e698">5.6. 单元测试</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d5e702">6. 框架</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d5e704">6.1. 字符集</a></span></dt>
                        <dt><span class="section"><a href="#d5e712">6.2. 代码结构</a></span></dt>
                        <dt><span class="section"><a href="#d5e780">6.3. MVC</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e783">6.3.1. Controller层</a></span></dt>
                              <dt><span class="section"><a href="#d5e791">6.3.2. Manager层</a></span></dt>
                              <dt><span class="section"><a href="#d5e800">6.3.3. DAO层</a></span></dt>
                              <dt><span class="section"><a href="#d5e963">6.3.4. Model &amp; View</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e966">6.4. 插件化</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e969">6.4.1. 插件规范</a></span></dt>
                              <dt><span class="section"><a href="#d5e980">6.4.2. 插件基础配置</a></span></dt>
                              <dt><span class="section"><a href="#d5e996">6.4.3. 插件启动初始化</a></span></dt>
                              <dt><span class="section"><a href="#d5e1003">6.4.4. 插件自定义配置文件</a></span></dt>
                              <dt><span class="section"><a href="#d5e1011">6.4.5. 插件国际化配置文件</a></span></dt>
                              <dt><span class="section"><a href="#d5e1016">6.4.6. 插件spring配置</a></span></dt>
                              <dt><span class="section"><a href="#d5e1027">6.4.7. 插件hibernatePO加载</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e1031">6.5. 异常处理</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e1039">6.5.1. 异常消息国际化</a></span></dt>
                              <dt><span class="section"><a href="#d5e1054">6.5.2. 例子</a></span></dt>
                           </dl>
                        </dd>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d5e1057">7. 组件</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d5e1060">7.1. 脚本引擎支持（Groovy）</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e1078">7.1.1. 表达式计算</a></span></dt>
                              <dt><span class="section"><a href="#d5e1086">7.1.2. 字符串宏替换</a></span></dt>
                              <dt><span class="section"><a href="#d5e1090">7.1.3. 基本函数库</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e1117">7.2. 事件</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e1120">7.2.1. 应用场景</a></span></dt>
                              <dt><span class="section"><a href="#d5e1124">7.2.2. 技术背景</a></span></dt>
                              <dt><span class="section"><a href="#d5e1132">7.2.3. 开发步骤</a></span></dt>
                              <dt><span class="section"><a href="#d5e1144">7.2.4. 事件命名规范</a></span></dt>
                              <dt><span class="section"><a href="#d5e1153">7.2.5. 示例</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e1170">7.3. 缓存</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e1173">7.3.1. 缓存的界定</a></span></dt>
                              <dt><span class="section"><a href="#d5e1191">7.3.2. 缓存组件</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e1216">7.4. 加解密</a></span></dt>
                        <dt><span class="section"><a href="#d5e1220">7.5. 应用锁</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e1226">7.5.1. 名词解释</a></span></dt>
                              <dt><span class="section"><a href="#d5e1231">7.5.2. 功能</a></span></dt>
                              <dt><span class="section"><a href="#d5e1242">7.5.3. 调用</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e1260">7.6. 定时任务 Quartz</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e1295">7.6.1. 业务定时任务</a></span></dt>
                              <dt><span class="section"><a href="#d5e1328">7.6.2. 系统定时任务</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e1342">7.7. 文件（附件）管理JAVA 接口</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e1351">7.7.1. 对输入流下载的接口</a></span></dt>
                              <dt><span class="section"><a href="#d5e1359">7.7.2. 删除附件的接口</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e1368">7.8. 文件压缩/解压</a></span></dt>
                        <dt><span class="section"><a href="#d5e1373">7.9. i18n国际化</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d5e1384">8. 单元测试</a></span></dt>
               </dl>
            </div>
            
            
            
            <div class="chapter" title="Chapter&nbsp;5.&nbsp;开发环境">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d5e625"></a>Chapter&nbsp;5.&nbsp;开发环境
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Table of Contents</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d5e629">5.1. 获取CTP发布</a></span></dt>
                     <dt><span class="section"><a href="#d5e636">5.2. 获取Eclipse All-In-One</a></span></dt>
                     <dt><span class="section"><a href="#d5e641">5.3. 建立开发环境</a></span></dt>
                     <dt><span class="section"><a href="#d5e685">5.4. 配置数据库连接</a></span></dt>
                     <dt><span class="section"><a href="#d5e690">5.5. 建立运行环境</a></span></dt>
                     <dt><span class="section"><a href="#d5e698">5.6. 单元测试</a></span></dt>
                  </dl>
               </div>
               
               
               
               <div class="section" title="5.1.&nbsp;获取CTP发布">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e629"></a>5.1.&nbsp;获取CTP发布
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>访问下面的地址，获取CTP发布。</p>
                  
                  <pre class="programlisting">http://10.3.4.218:6666/svn/ctp_core/trunk/ctp_pub</pre>
                  
                  <p>每日构建会定时将最新的CTP代码更新到ctp_pub中。</p>
                  
                  
                  <p>应用开发的Project建立以后，每日构建会将ctp_pub的内容按时推送到应用的Project。</p>
                  
               </div>
               
               
               <div class="section" title="5.2.&nbsp;获取Eclipse All-In-One">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e636"></a>5.2.&nbsp;获取Eclipse All-In-One
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>从下面的共享目录可以取到all in
                     one的eclipse开发环境，已经预置了subclipse、jseclipse、findbugs、resource bundle
                     editor等插件，以及各种代码格式化定义(ctr+shift+f快捷键)。
                  </p>
                  
                  <pre class="programlisting">\\10.3.4.239\share\Software\开发环境\eclipse</pre>
                  
                  <p>该共享目录的用户名和密码均为share。</p>
                  
               </div>
               
               
               <div class="section" title="5.3.&nbsp;建立开发环境">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e641"></a>5.3.&nbsp;建立开发环境
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <div class="procedure">
                     <ol class="procedure" type="1">
                        <li class="step" title="Step 1">
                           
                           <p>建立一个eclipse Dynamic Web Project。</p>
                           
                           
                           <div class="mediaobject"><img src="resources/images/env_new_dynamic_project.jpg"></div>
                           
                           
                           <p></p>
                           
                           
                           <p></p>
                           
                           
                           <div class="mediaobject"><img src="resources/images/env_new_dynamic_project_2.jpg"></div>
                           
                        </li>
                        <li class="step" title="Step 2">
                           
                           <p>将project_template下的文件复制到新建的Project中，复制后目录结构如图所示</p>
                           
                           
                           <p></p>
                           
                           
                           <div class="mediaobject"><img src="resources/images/env_dir_structure.jpg"></div>
                           
                        </li>
                        <li class="step" title="Step 3">
                           
                           <p>将src_test和src_samples加到Source中。</p>
                           
                           
                           <p></p>
                           
                           
                           <div class="mediaobject"><img src="resources/images/env_add_src_test.jpg"></div>
                           
                           
                           <p></p>
                           
                        </li>
                        <li class="step" title="Step 4">
                           
                           <p>添加servlet依赖和数据库驱动</p>
                           
                           
                           <p>将etc/lib下的servlet依赖：servlet_api.jar和jsp-api.jar添加到Project的Build
                              Path中。
                           </p>
                           
                           
                           <p>并添加lib目录下的数据库驱动。</p>
                           
                           
                           <div class="mediaobject"><img src="resources/images/env_add_jar.jpg"></div>
                           
                        </li>
                        <li class="step" title="Step 5">
                           
                           <p>启动Tomcat</p>
                           
                           
                           <p>使用Run菜单中Run As下的Run On Server启动Tomcat。</p>
                           
                           
                           <p>在Eclipse的Server View下可以对Tomcat的启动停止和重启。</p>
                           
                           
                           <p></p>
                           
                           
                           <div class="mediaobject"><img src="resources/images/env_server_view.jpg"></div>
                           
                        </li>
                     </ol>
                  </div>
                  
                  
                  <p>新开发的java代码必须放到src下，不允许建立新的src_xxx目录。</p>
                  
                  
                  <p>同理，单元测试都放到src_test下。</p>
                  
               </div>
               
               
               <div class="section" title="5.4.&nbsp;配置数据库连接">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e685"></a>5.4.&nbsp;配置数据库连接
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>修改<code class="filename">WebContent/META-INF/context.xml</code>的<code class="filename">META-INF/context.xml</code>以修改开发环境的数据库连接信息。
                  </p>
                  
               </div>
               
               
               <div class="section" title="5.5.&nbsp;建立运行环境">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e690"></a>5.5.&nbsp;建立运行环境
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <div class="procedure">
                     <ol class="procedure" type="1">
                        <li class="step" title="Step 1">
                           
                           <p>从ctp_pub/release/tomcat取得CTP运行环境所需的tomcat。</p>
                           
                        </li>
                        <li class="step" title="Step 2">
                           
                           <p>将ctp_pub/project_template/WebContent目录下的所有文件复制到tomcat的webapps/seeyon目录中。</p>
                           
                        </li>
                     </ol>
                  </div>
                  
               </div>
               
               
               <div class="section" title="5.6.&nbsp;单元测试">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e698"></a>5.6.&nbsp;单元测试
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>所有的单元测试都需要放在Project的src_test下，必须继承TestCaseBase，而且每一个测试方法都必须有断言，不允许以System.out.print作为单元测试的判断依据。</p>
                  
                  
                  <p>可修改Project
                     etc目录下的spring-default-junit.xml的dataSource配置单元测试连接的数据库。
                  </p>
                  
               </div>
               
            </div>
            
            
            <div class="chapter" title="Chapter&nbsp;6.&nbsp;框架">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d5e702"></a>Chapter&nbsp;6.&nbsp;框架
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Table of Contents</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d5e704">6.1. 字符集</a></span></dt>
                     <dt><span class="section"><a href="#d5e712">6.2. 代码结构</a></span></dt>
                     <dt><span class="section"><a href="#d5e780">6.3. MVC</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e783">6.3.1. Controller层</a></span></dt>
                           <dt><span class="section"><a href="#d5e791">6.3.2. Manager层</a></span></dt>
                           <dt><span class="section"><a href="#d5e800">6.3.3. DAO层</a></span></dt>
                           <dt><span class="section"><a href="#d5e963">6.3.4. Model &amp; View</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e966">6.4. 插件化</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e969">6.4.1. 插件规范</a></span></dt>
                           <dt><span class="section"><a href="#d5e980">6.4.2. 插件基础配置</a></span></dt>
                           <dt><span class="section"><a href="#d5e996">6.4.3. 插件启动初始化</a></span></dt>
                           <dt><span class="section"><a href="#d5e1003">6.4.4. 插件自定义配置文件</a></span></dt>
                           <dt><span class="section"><a href="#d5e1011">6.4.5. 插件国际化配置文件</a></span></dt>
                           <dt><span class="section"><a href="#d5e1016">6.4.6. 插件spring配置</a></span></dt>
                           <dt><span class="section"><a href="#d5e1027">6.4.7. 插件hibernatePO加载</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e1031">6.5. 异常处理</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e1039">6.5.1. 异常消息国际化</a></span></dt>
                           <dt><span class="section"><a href="#d5e1054">6.5.2. 例子</a></span></dt>
                        </dl>
                     </dd>
                  </dl>
               </div>
               
               
               
               <div class="section" title="6.1.&nbsp;字符集">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e704"></a>6.1.&nbsp;字符集
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>为了实现国际化编程，任何地方都要求使用UTF-8的字符集编码，包括：</p>
                  
                  
                  <p>数据库</p>
                  
                  
                  <p>文件：java、properties、jsp、js、css、htm等等</p>
                  
                  
                  <p>servlet：response.setContentType(“text/html;
                     charset=UTF-8”);
                  </p>
                  
                  
                  <p>HTML：&lt;meta http-equiv="Content-Type" content="text/html;
                     charset=UTF-8"&gt;
                  </p>
                  
                  
                  <p>JSP：&lt;%@ page language="java" contentType="text/html;
                     charset=UTF-8" pageEncoding="UTF-8"%&gt;
                  </p>
                  
               </div>
               
               
               <div class="section" title="6.2.&nbsp;代码结构">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e712"></a>6.2.&nbsp;代码结构
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p></p>
                  
                  <pre class="programlisting">src
    com
        seeyon
            apps(ctp)<a name="server_dir_0"></a><img src="resources/callouts/1.png" alt="1" border="0">
                <em class="replaceable"><code>sample</code></em>
                    controller
                        <em class="replaceable"><code>Sample</code></em>Controller.java<a name="server_dir_1"></a><img src="resources/callouts/2.png" alt="2" border="0">
                    manager
                        <em class="replaceable"><code>Sample</code></em>Manager.java<a name="server_dir_2"></a><img src="resources/callouts/3.png" alt="3" border="0">
                        <em class="replaceable"><code>Sample</code></em>ManagerImpl.java<a name="server_dir_21"></a><img src="resources/callouts/4.png" alt="4" border="0">
                    dao
                        <em class="replaceable"><code>Sample</code></em>Dao.java<a name="server_dir_3"></a><img src="resources/callouts/5.png" alt="5" border="0">
                <em class="replaceable"><code>        Sample</code></em>DaoImpl.java<a name="server_dir_31"></a><img src="resources/callouts/6.png" alt="6" border="0">
                    po
                        <em class="replaceable"><code>Sample</code></em>PO.java<a name="server_dir_4"></a><img src="resources/callouts/7.png" alt="7" border="0">
                        <em class="replaceable"><code>Sample</code></em>PO.hbm.xml<a name="server_dir_5"></a><img src="resources/callouts/8.png" alt="8" border="0">
WebContent
    WEB-INF
        cfgHome
            i18n
                <em class="replaceable"><code>Sample</code></em>Resource_en.properties<a name="server_dir_6"></a><img src="resources/callouts/9.png" alt="9" border="0">      
                <em class="replaceable"><code>Sample</code></em>Resource_zh_CN.properties<a name="server_dir_6"></a><img src="resources/callouts/9.png" alt="9" border="0">
                <em class="replaceable"><code>Sample</code></em>Resource_zh_TW.properties<a name="server_dir_6"></a><img src="resources/callouts/9.png" alt="9" border="0">
            spring
                spring-<em class="replaceable"><code>sample</code></em>-controller.xml<a name="server_dir_7"></a><img src="resources/callouts/10.png" alt="10" border="0">
                spring-<em class="replaceable"><code>sample</code></em>-manager.xml<a name="server_dir_8"></a><img src="resources/callouts/11.png" alt="11" border="0">
                spring-<em class="replaceable"><code>sample</code></em>-dao.xml<a name="server_dir_9"></a><img src="resources/callouts/12.png" alt="12" border="0">
            </pre>
                  
                  <div class="calloutlist">
                     <table border="0" summary="Callout list">
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#server_dir_0"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>应用使用apps，CTP平台使用ctp</p>
                              
                              
                              <p>如com.seeyon.apps.news和com.seeyon.ctp.form</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#server_dir_1"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>MVC
                                 Controller（如果模块不大，Controller、Manager和Dao都可以放到上级package中，但PO必须放在po
                                 package中）
                              </p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#server_dir_2"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>MVC Manager接口</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#server_dir_21"><img src="resources/callouts/4.png" alt="4" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>MVC Manager实现</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#server_dir_3"><img src="resources/callouts/5.png" alt="5" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>MVC DAO接口</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#server_dir_31"><img src="resources/callouts/6.png" alt="6" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>MVC DAO实现</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#server_dir_4"><img src="resources/callouts/7.png" alt="7" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>PO</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#server_dir_5"><img src="resources/callouts/8.png" alt="8" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>PO Hibernate映射文件</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#server_dir_6"><img src="resources/callouts/9.png" alt="9" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>Java国际化资源文件</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#server_dir_7"><img src="resources/callouts/10.png" alt="10" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>Controller的Spring配置文件</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#server_dir_8"><img src="resources/callouts/11.png" alt="11" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>Manager的Srping配置文件</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#server_dir_9"><img src="resources/callouts/12.png" alt="12" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>Dao的Spring配置文件</p>
                              
                           </td>
                        </tr>
                     </table>
                  </div>
                  
                  
                  <p>一个模块的开发步骤</p>
                  
                  
                  <div class="orderedlist">
                     <ol class="orderedlist" type="1">
                        <li class="listitem">
                           
                           <p>创建spring beans文件</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>创建对应的hbm文件</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>编写XXXController、XXXManager、XXXDao XXXVO、XXXPO</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>编写前端页面</p>
                           
                        </li>
                     </ol>
                  </div>
                  
               </div>
               
               
               <div class="section" title="6.3.&nbsp;MVC">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e780"></a>6.3.&nbsp;MVC
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p></p>
                  
                  
                  <div class="section" title="6.3.1.&nbsp;Controller层">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e783"></a>6.3.1.&nbsp;Controller层
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>需要继承BaseController，如：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">import</span> javax.servlet.http.HttpServletRequest;
<span class="hl-keyword">import</span> javax.servlet.http.HttpServletResponse;
<span class="hl-keyword">import</span> org.springframework.web.servlet.ModelAndView;
<span class="hl-keyword">import</span> com.seeyon.ctp.common.controller.BaseController;

<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> TestController <span class="hl-keyword">extends</span> BaseController {
    <span class="hl-keyword">public</span> ModelAndView index(HttpServletRequest request, HttpServletResponse response) <span class="hl-keyword">throws</span> Exception {
        <span class="hl-keyword">return</span> <span class="hl-keyword">new</span> ModelAndView(<span class="hl-string">"apps/samples/hello"</span>);
    }
    <span class="hl-keyword">public</span> ModelAndView edit(HttpServletRequest request, HttpServletResponse response) <span class="hl-keyword">throws</span> Exception {
    }
    <span class="hl-keyword">public</span> ModelAndView save(HttpServletRequest request, HttpServletResponse response) <span class="hl-keyword">throws</span> Exception {
    }
}</pre>
                     
                     <p>在插件的Spring配置文件中定义urlmapping如：WebContent/WEB-INF/cfgHome/plugin/samples/spring/spring-samples-controller.xml</p>
                     
                     <pre class="programlisting"><span class="hl-tag">&lt;beans</span> <span class="hl-attribute">default-autowire</span>=<span class="hl-value">"byName"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;bean</span> <span class="hl-attribute">name</span>=<span class="hl-value">"/sample/test.do"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.seeyon.apps.sample.SampleController"</span><span class="hl-tag"> /&gt;</span>
<span class="hl-tag">&lt;/beans&gt;</span></pre>
                     
                     <p>上面定义的Controller可以通过下面的url访问：</p>
                     
                     <pre class="programlisting">http://[host]:[port]/[context]/samples/test.do?method=testAjax</pre>
                     </div>
                  
                  
                  <div class="section" title="6.3.2.&nbsp;Manager层">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e791"></a>6.3.2.&nbsp;Manager层
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>定义Manager接口</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">interface</span> TestManager {
    <span class="hl-keyword">void</span> test() <span class="hl-keyword">throws</span> BusinessException;
}</pre>
                     
                     <p>实现Manager</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> TestManagerImpl <span class="hl-keyword">implements</span> TestManager {
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> test() <span class="hl-keyword">throws</span> BusinessException{
        <span class="hl-comment">// doSth</span>
    }
}</pre><p>Spring配置</p>
                     
                     <pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">name</span>=<span class="hl-value">"testManager"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.seeyon.apps.samples.TestManager"</span><span class="hl-tag"> /&gt;</span></pre>
                     </div>
                  
                  
                  <div class="section" title="6.3.3.&nbsp;DAO层">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e800"></a>6.3.3.&nbsp;DAO层
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>数据访问采用DBAgent，旧的应用可以继续沿用继承BaseDAO的方式，手册中不再对BaseDao作特别的说明。</p>
                     
                     
                     <p>统一使用NamedQuery方式管理HQL语句。</p>
                     
                     
                     <p>因为我们规范禁止建立关系映射，所以HQL中不能书写明确的JOIN语句。</p>
                     
                     
                     <p>请控制好查询条件，优化索引，保证查询的性能。</p>
                     
                     
                     <div class="section" title="6.3.3.1.&nbsp;基础要求">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d5e806"></a>6.3.3.1.&nbsp;基础要求
                                 </h4>
                              </div>
                           </div>
                        </div>
                        
                        
                        
                        <p>通过com.seeyon.ctp.util.DBAgent进行数据库操作时，必须在Manager或DAO层进行调用，并且方法命名满足如下规则以满足统一事务控制：</p>
                        
                        
                        <div class="itemizedlist">
                           <ul class="itemizedlist" type="disc">
                              <li class="listitem">
                                 
                                 <p>insert*</p>
                                 
                              </li>
                              <li class="listitem">
                                 
                                 <p>delete*</p>
                                 
                              </li>
                              <li class="listitem">
                                 
                                 <p>update*</p>
                                 
                              </li>
                              <li class="listitem">
                                 
                                 <p>save*</p>
                                 
                              </li>
                              <li class="listitem">
                                 
                                 <p>select*</p>
                                 
                              </li>
                              <li class="listitem">
                                 
                                 <p>find*</p>
                                 
                              </li>
                              <li class="listitem">
                                 
                                 <p>get*</p>
                                 
                              </li>
                              <li class="listitem">
                                 
                                 <p>trans*</p>
                                 
                              </li>
                              <li class="listitem">
                                 
                                 <p>is*</p>
                                 
                              </li>
                              <li class="listitem">
                                 
                                 <p>check*</p>
                                 
                              </li>
                              <li class="listitem">
                                 
                                 <p>test*</p>
                                 
                              </li>
                           </ul>
                        </div>
                        
                        
                        <p>否则在使用时会提示错误信息</p>
                        
                        <pre class="screen">当前BS方法未采用Spring管理数据库连接，请检查方法命名是否符合Spring设置！</pre>
                        
                        <p><code class="computeroutput"></code></p>
                        
                     </div>
                     
                     
                     <div class="section" title="6.3.3.2.&nbsp;基本CRUD操作">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d5e837"></a>6.3.3.2.&nbsp;基本CRUD操作
                                 </h4>
                              </div>
                           </div>
                        </div>
                        
                        
                        
                        <p></p>
                        
                        <pre class="programlisting">DBAgent.save(myPO);<a name="dbagent_sample1_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
DBAgent.delete(myPO);<a name="dbagent_sample1_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
DBAgent.update(myPO);<a name="dbagent_sample1_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
DBAgent.get(MyPO.<span class="hl-keyword">class</span>,id);<a name="dbagent_sample1_4"></a><img src="resources/callouts/4.png" alt="4" border="0">
DBAgent.loadAll(MyPO.<span class="hl-keyword">class</span>);<a name="dbagent_sample1_5"></a><img src="resources/callouts/5.png" alt="5" border="0">
DBAgent.loadAll(MyPO.<span class="hl-keyword">class</span>,flipInfo);<a name="dbagent_sample1_6"></a><img src="resources/callouts/6.png" alt="6" border="0"></pre>
                        
                        <div class="calloutlist">
                           <table border="0" summary="Callout list">
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample1_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>新增保存PO实体对象</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample1_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>删除PO实体对象</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample1_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>更新PO实体对象</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample1_4"><img src="resources/callouts/4.png" alt="4" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>根据PO类型和主键ID查询PO实体对象</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample1_5"><img src="resources/callouts/5.png" alt="5" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>根据PO类型加载全部数据，数据量大时不建议使用</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample1_6"><img src="resources/callouts/6.png" alt="6" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>根据PO类型进行翻页查询，需要构造FlipInfo信息参数</p>
                                    
                                 </td>
                              </tr>
                           </table>
                        </div>
                        
                     </div>
                     
                     
                     <div class="section" title="6.3.3.3.&nbsp;查询操作">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d5e860"></a>6.3.3.3.&nbsp;查询操作
                                 </h4>
                              </div>
                           </div>
                        </div>
                        
                        
                        
                        <p>原则上不允许Manager层里出现HQL，可以利用Hibernate的NamedQuery特性，将HQL放入hbm配置文件中进行统一管理和维护，该文件可以放在应用/平台代码包的po下的</p>
                        
                        
                        <p>子包中，框架将自动进行加载，比如com.seeyon.apps.samples.po.myquery.MyQuery.hbm.xml，相当于myquery子包中的MyQuery.hbm.xml充当了DAO的角色</p>
                        
                        <pre class="programlisting"><span class="hl-directive">&lt;?xml version="1.0" encoding="gb2312"?&gt;</span>
<span class="hl-doctype">&lt;!DOCTYPE hibernate-mapping PUBLIC 
  "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
  "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd"&gt;</span>
<span class="hl-tag">&lt;hibernate-mapping&gt;</span>
<span class="hl-tag">&lt;query</span> <span class="hl-attribute">name</span>=<span class="hl-value">"samples_hibernate_findAll"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;![CDATA[</span>
    from Org o
<span class="hl-tag">]]&gt;</span><span class="hl-tag">&lt;/query&gt;</span>
<span class="hl-tag">&lt;query</span> <span class="hl-attribute">name</span>=<span class="hl-value">"samples_hibernate_findByOrgname"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;![CDATA[</span>
    from Org o where orgname like :orgname
<span class="hl-tag">]]&gt;</span><span class="hl-tag">&lt;/query&gt;</span>
<span class="hl-tag">&lt;query</span> <span class="hl-attribute">name</span>=<span class="hl-value">"samples_hibernate_findByOrgnames"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;![CDATA[</span>
    from Org o where orgname like :orgname or orgname=:oname
<span class="hl-tag">]]&gt;</span><span class="hl-tag">&lt;/query&gt;</span>
    <span class="hl-tag">&lt;query</span> <span class="hl-attribute">name</span>=<span class="hl-value">"samples_hibernate_findPerson"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;![CDATA[</span>
    from A6User a where a.truename like :name
<span class="hl-tag">]]&gt;</span><span class="hl-tag">&lt;/query&gt;</span>
<span class="hl-tag">&lt;/hibernate-mapping&gt;</span>
</pre>
                        
                        <p>代码调用如下</p>
                        
                        <pre class="programlisting">DBAgent.findByNamedQuery(queryName);<a name="dbagent_sample2_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
DBAgent.findByNamedQuery(queryName, params);<a name="dbagent_sample2_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
DBAgent.findByNamedQuery(queryName, params, flipInfo);<a name="dbagent_sample2_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
DBAgent.findByNamedQueryAndValueBean(queryName, valueBean);<a name="dbagent_sample2_4"></a><img src="resources/callouts/4.png" alt="4" border="0">
DBAgent.findByNamedQueryAndValueBean(queryName, valueBean, flipInfo);<a name="dbagent_sample2_5"></a><img src="resources/callouts/5.png" alt="5" border="0"></pre>
                        
                        <div class="calloutlist">
                           <table border="0" summary="Callout list">
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample2_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>根据queryName进行查询操作，如果返回数据量过大不允许使用</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample2_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>根据queryName和命名参数进行查询操作，如果返回数据量过大不允许使用</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample2_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>根据queryName和命名参数进行翻页查询操作，需要构造FlipInfo翻页信息类</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample2_4"><img src="resources/callouts/4.png" alt="4" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>根据queryName和ValueBean进行查询操作，Bean中的属性名将作为HQL中的命名参数，如果返回数据量过大不允许使用</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample2_5"><img src="resources/callouts/5.png" alt="5" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>根据queryName和ValueBean进行翻页查询操作，Bean中的属性名将作为HQL中的命名参数，需要构造FlipInfo翻页信息类</p>
                                    
                                 </td>
                              </tr>
                           </table>
                        </div>
                        
                        
                        <p>在某些情况下需要直接传入HQL进行查询操作，比如动态拼装HQL语句时，可以调用DBAgent的find函数，但只允许在DAO层出现HQL语句，不允许在Manager中使用</p>
                        
                        <pre class="programlisting">DBAgent.find("from Org");<a name="dbagent_sample3_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
DBAgent.find("from Org where orgname like :orgname", params);<a name="dbagent_sample3_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
DBAgent.find("from Org where orgname like :orgname", params, flipInfo);<a name="dbagent_sample3_3"></a><img src="resources/callouts/3.png" alt="3" border="0"></pre>
                        
                        <div class="calloutlist">
                           <table border="0" summary="Callout list">
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample3_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>根据传入的HQL进行查询操作，如果返回数据量过大不允许使用</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample3_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>根据传入的HQL和命名参数进行查询操作，如果返回数据量过大不允许使用</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample3_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>根据传入的HQL和命名参数进行翻页查询操作，需要构造FlipInfo翻页信息类</p>
                                    
                                 </td>
                              </tr>
                           </table>
                        </div>
                        
                        
                        <p></p>
                        
                     </div>
                     
                     
                     <div class="section" title="6.3.3.4.&nbsp;批量插入/更新/删除">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d5e896"></a>6.3.3.4.&nbsp;批量插入/更新/删除
                                 </h4>
                              </div>
                           </div>
                        </div>
                        
                        
                        
                        <p></p>
                        
                        <pre class="programlisting">DBAgent.saveAll(pos);<a name="dbagent_sample4_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
DBAgent.deleteAll(pos);<a name="dbagent_sample4_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
DBAgent.updateAll(pos);<a name="dbagent_sample4_3"></a><img src="resources/callouts/3.png" alt="3" border="0"></pre>
                        
                        <div class="calloutlist">
                           <table border="0" summary="Callout list">
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample4_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>批量新增插入PO对象数据</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample4_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>批量删除PO对象数据</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample4_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>批量修改PO对象数据</p>
                                    
                                 </td>
                              </tr>
                           </table>
                        </div>
                        
                        
                        <p>这些批量操作性能在普通台式电脑的测试环境下的性能如下（单位：毫秒，仅供参考，在不满足性能要求的情况下需要考虑其它技术实现策略）：</p>
                        
                        <pre class="programlisting">一百条数据：    SaveAll:178;UpdateAll:100;DeleteAll:82
五百条数据：    SaveAll:318;UpdateAll:192;DeleteAll:353
一千五数据：    SaveAll:518;UpdateAll:590;DeleteAll:842
三千条数据：    SaveAll:735;UpdateAll:513;DeleteAll:1575
一万条数据：    SaveAll:1282;UpdateAll:1183;DeleteAll:4750
十万条数据：    SaveAll:9155;UpdateAll:11245;DeleteAll:44919
</pre>
                        
                        <p>另外，如果需要根据某些特定条件进行批量更新或删除操作时，可以采用如下方法：</p>
                        
                        <pre class="programlisting">DBAgent.bulkUpdate(<span class="hl-string">"delete from Org where orgid&gt;? and orgid&lt;?"</span>, <span class="hl-number">200L</span>, <span class="hl-keyword">new</span> Long(<span class="hl-number">210</span>));
DBAgent.bulkUpdate(<span class="hl-string">"update from Org set orgname=? where orgid&gt;? and orgid&lt;?"</span>, <span class="hl-string">"测试"</span>, <span class="hl-number">210L</span>, <span class="hl-keyword">new</span> Long(<span class="hl-number">220</span>));</pre>
                        
                        <p>DBAgent.bulkUpdate方法将根据传入的delete或update的HQL语句，以及?条件参数值进行批量删除或更新操作。因为要显式传入HQL，所以该方法只允许在DAO中调用。</p>
                        
                     </div>
                     
                     
                     <div class="section" title="6.3.3.5.&nbsp;Blob/Clob操作">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d5e915"></a>6.3.3.5.&nbsp;Blob/Clob操作
                                 </h4>
                              </div>
                           </div>
                        </div>
                        
                        
                        
                        <p>Blob新增保存例子代码如下：</p>
                        
                        <pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">void</span> testSaveBLob() <span class="hl-keyword">throws</span> BusinessException {
    Lobtest lob = <span class="hl-keyword">new</span> Lobtest();
    <span class="hl-keyword">long</span> id = <span class="hl-number">1L</span>, start = System.currentTimeMillis(), end;
    String file = <span class="hl-string">"e:\\MyProjects\\test.rar"</span>;
    lob.setTid(id);
    <span class="hl-keyword">try</span> {
        InputStream is = <span class="hl-keyword">new</span> FileInputStream(<span class="hl-keyword">new</span> File(file));
        <span class="hl-keyword">byte</span>[] bytes = IOUtility.toByteArray(is);<a name="dbagent_sample5_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
        is.close();
        lob.setTblob(bytes);<a name="dbagent_sample5_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
        DBAgent.save(lob);<a name="dbagent_sample5_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
        end = System.currentTimeMillis();
        System.out.println(<span class="hl-string">"Saved:"</span> + (end - start));
    } <span class="hl-keyword">catch</span> (Exception e) {
        e.printStackTrace();
    }
}</pre>
                        
                        <div class="calloutlist">
                           <table border="0" summary="Callout list">
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample5_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>将要保存的二进制数据转为byte数组</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample5_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>将byte数组设置到PO对象中</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample5_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>保存PO对象即可</p>
                                    
                                 </td>
                              </tr>
                           </table>
                        </div>
                        
                        
                        <p>Blob读取和更新例子代码如下：</p>
                        
                        <pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">void</span> testGetAndUpdateBLob() <span class="hl-keyword">throws</span> BusinessException {
    Lobtest lob = <span class="hl-keyword">new</span> Lobtest();
    <span class="hl-keyword">long</span> id = <span class="hl-number">1L</span>, start = System.currentTimeMillis(), end;
    String file = <span class="hl-string">"e:\\MyProjects\\test.rar"</span>;
    String ofile = <span class="hl-string">"e:/test.rar"</span>;
    lob.setTid(id);
    <span class="hl-keyword">try</span> {
        lob = (Lobtest) DBAgent.get(Lobtest.<span class="hl-keyword">class</span>, id);
        <span class="hl-keyword">byte</span>[] bytes = lob.getTblob();<a name="dbagent_sample6_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
        OutputStream os = <span class="hl-keyword">new</span> FileOutputStream(<span class="hl-keyword">new</span> File(ofile));
        IOUtility.copy(bytes, os);
        os.flush();
        os.close();
        end = System.currentTimeMillis();
        System.out.println(<span class="hl-string">"Readed:"</span> + (end - start));
        start = end;

        InputStream is = <span class="hl-keyword">new</span> FileInputStream(<span class="hl-keyword">new</span> File(file));
        bytes = IOUtility.toByteArray(is);
        is.close();
        lob.setTblob(bytes);<a name="dbagent_sample6_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
        DBAgent.update(lob);<a name="dbagent_sample6_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
        end = System.currentTimeMillis();
        System.out.println(<span class="hl-string">"Updated:"</span> + (end - start));
        start = end;
    } <span class="hl-keyword">catch</span> (Exception e) {
        e.printStackTrace();
    }
}</pre>
                        
                        <div class="calloutlist">
                           <table border="0" summary="Callout list">
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample6_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>正常查询PO对象，获取Blob数据的byte数组</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample6_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>用新的byte数组更新Blob数据</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample6_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>更新保存PO即可更新Blob数据</p>
                                    
                                 </td>
                              </tr>
                           </table>
                        </div>
                        
                        
                        <p>Clob新增保存例子代码如下：</p>
                        
                        <pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">void</span> testSaveCLob() <span class="hl-keyword">throws</span> BusinessException {
    <span class="hl-keyword">long</span> id = <span class="hl-number">2L</span>, size = <span class="hl-number">100000</span>, start = System.currentTimeMillis(), end;
    Lobtest lob = <span class="hl-keyword">new</span> Lobtest();
    lob.setTid(id);
    StringBuffer sb = <span class="hl-keyword">new</span> StringBuffer((<span class="hl-keyword">int</span>) size);
    <span class="hl-keyword">for</span> (<span class="hl-keyword">int</span> i = <span class="hl-number">0</span>; i &lt; size; i++)
        sb.append(<span class="hl-string">'a'</span>);
    lob.setTclob(sb.toString());<a name="dbagent_sample7_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
    DBAgent.save(lob);<a name="dbagent_sample7_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
    end = System.currentTimeMillis();
    System.out.println(<span class="hl-string">"Saved:"</span> + (end - start));
}</pre>
                        
                        <div class="calloutlist">
                           <table border="0" summary="Callout list">
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample7_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>将要保存的Clob数据作为String传入</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample7_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>正常保存PO对象即可保存Clob数据</p>
                                    
                                 </td>
                              </tr>
                           </table>
                        </div>
                        
                        
                        <p>Clob读取和更新例子代码如下：</p>
                        
                        <pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">void</span> testGetAndUpdateCLob() <span class="hl-keyword">throws</span> BusinessException {
    <span class="hl-keyword">long</span> id = <span class="hl-number">2L</span>, size = <span class="hl-number">100000</span>, start = System.currentTimeMillis(), end;
    Lobtest lob = (Lobtest) DBAgent.get(Lobtest.<span class="hl-keyword">class</span>, id);
    end = System.currentTimeMillis();
    System.out.println(<span class="hl-string">"Readed:"</span> + lob.getTclob().length() + <span class="hl-string">":"</span> + (end - start));<a name="dbagent_sample8_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
    start = end;
    StringBuffer sb = <span class="hl-keyword">new</span> StringBuffer((<span class="hl-keyword">int</span>) size);
    <span class="hl-keyword">for</span> (<span class="hl-keyword">int</span> i = <span class="hl-number">0</span>; i &lt; size; i++)
        sb.append(<span class="hl-string">'b'</span>);
    lob.setTclob(sb.toString());<a name="dbagent_sample8_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
    DBAgent.update(lob);<a name="dbagent_sample8_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
    System.out.println(<span class="hl-string">"Updated:"</span> + (end - start));
    start = end;
}</pre>
                        
                        <div class="calloutlist">
                           <table border="0" summary="Callout list">
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample8_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>正常查询PO对象，获取Clob数据作为String</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample8_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>用新的String数据更新Clob数据</p>
                                    
                                 </td>
                              </tr>
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#dbagent_sample8_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>更新保存PO即可更新Clob数据</p>
                                    
                                 </td>
                              </tr>
                           </table>
                        </div>
                        
                        
                        <p></p>
                        
                     </div>
                     
                  </div>
                  
                  
                  <div class="section" title="6.3.4.&nbsp;Model &amp; View">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e963"></a>6.3.4.&nbsp;Model &amp; View
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="6.4.&nbsp;插件化">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e966"></a>6.4.&nbsp;插件化
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>框架插件机制提供了全面的插件扩展开发支持，包括插件启动、插件自定义配置文件、i18n、spring和hibernate
                     PO加载等
                  </p>
                  
                  
                  <div class="section" title="6.4.1.&nbsp;插件规范">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e969"></a>6.4.1.&nbsp;插件规范
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <div class="orderedlist">
                        <ol class="orderedlist" type="1">
                           <li class="listitem">
                              
                              <p>插件相关的配置文件存放于cfgHome/plugin目录中，文件夹名称需与插件id保持一致。其中包括插件基础配置、插件自定义配置文件、插件i18n国际化配置、</p>
                              
                              
                              <p>spring配置文件</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>插件代码包必须在“com.seeyon.apps.插件id”，比如com.seeyon.apps.samples</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>插件的PO对象和配置文件必须在“com.seeyon.apps.插件id.po”下，可以带子包用于配置自定义HQL的hbm文件</p>
                              
                           </li>
                        </ol>
                     </div>
                     
                     
                     <p></p>
                     
                  </div>
                  
                  
                  <div class="section" title="6.4.2.&nbsp;插件基础配置">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e980"></a>6.4.2.&nbsp;插件基础配置
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>插件基础配置文件位于“cfgHome/plugin/插件id”目录下，文件名必须为pluginCfg.xml，例子如下：</p>
                     
                     
                     <p></p>
                     
                     <pre class="programlisting"><span class="hl-directive">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hl-tag">&lt;plugin&gt;</span>
    <span class="hl-tag">&lt;id&gt;</span>samples<span class="hl-tag">&lt;/id&gt;</span><a name="framework_plugin1_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
    <span class="hl-tag">&lt;name&gt;</span>例子模块<span class="hl-tag">&lt;/name&gt;</span><a name="framework_plugin1_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
    <span class="hl-tag">&lt;category&gt;</span>10000<span class="hl-tag">&lt;/category&gt;</span><a name="framework_plugin1_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
<span class="hl-tag">&lt;/plugin&gt;</span></pre>
                     
                     <div class="calloutlist">
                        <table border="0" summary="Callout list">
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#framework_plugin1_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>插件id，</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#framework_plugin1_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>插件名称</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#framework_plugin1_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>插件类别，产品插件分类从10000至19999，客开插件从20000开始</p>
                                 
                              </td>
                           </tr>
                        </table>
                     </div>
                     
                     
                     <p></p>
                     
                  </div>
                  
                  
                  <div class="section" title="6.4.3.&nbsp;插件启动初始化">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e996"></a>6.4.3.&nbsp;插件启动初始化
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>系统启动时可以进行插件的启动和系统停止时的销毁操作，需继承自com.seeyon.ctp.common.AbstractSystemInitializer，并在spring中注册即可，例子代码如下</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">import</span> com.seeyon.ctp.common.AbstractSystemInitializer;

<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> SamplesInitializer <span class="hl-keyword">extends</span> AbstractSystemInitializer {
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> destroy() {
        System.out.println(<span class="hl-string">"销毁Samples模块"</span>);
    }

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> initialize() {
        System.out.println(<span class="hl-string">"初始化Samples模块"</span>);
    }
}</pre>
                     
                     <p>Spring注册例子如下（插件相关spring配置文件命名规则为spring-插件id-plugin.xml）：</p>
                     
                     <pre class="programlisting">&lt;bean name=<span class="hl-string">"samples_systemInitializer"</span> <span class="hl-keyword">class</span>=<span class="hl-string">"com.seeyon.apps.samples.SamplesInitializer"</span>&gt;
  &lt;property name=<span class="hl-string">"sortOrder"</span>&gt;
    &lt;value&gt;<span class="hl-number">7</span>&lt;/value&gt;
  &lt;/property&gt;
&lt;/bean&gt;
&lt;bean name=<span class="hl-string">"samples_systemInitializer2"</span> <span class="hl-keyword">class</span>=<span class="hl-string">"com.seeyon.apps.samples.SamplesInitializer2"</span>&gt;
  &lt;property name=<span class="hl-string">"sortOrder"</span>&gt;
    &lt;value&gt;<span class="hl-number">2</span>&lt;/value&gt;
  &lt;/property&gt;
&lt;/bean&gt;</pre>
                     
                     <p>其中sortOrder为插件初始化顺序从小到大执行，如果没有配置该属性，则优先执行，在没有配置的多个初始化类之间顺序不定</p>
                     
                  </div>
                  
                  
                  <div class="section" title="6.4.4.&nbsp;插件自定义配置文件">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1003"></a>6.4.4.&nbsp;插件自定义配置文件
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>插件自定义配置文件位于“cfgHome/plugin/插件id”目录下，文件名必须为pluginProperties.xml，例子如下：</p>
                     
                     
                     <p></p>
                     
                     <pre class="programlisting"><span class="hl-directive">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="hl-tag">&lt;ctpConfig&gt;</span>
    <span class="hl-tag">&lt;samples&gt;</span>
        <span class="hl-tag">&lt;test</span> <span class="hl-attribute">name</span>=<span class="hl-value">"test配置"</span><span class="hl-tag">&gt;</span>插件配置测试<span class="hl-tag">&lt;/test&gt;</span>
    <span class="hl-tag">&lt;/samples&gt;</span>
<span class="hl-tag">&lt;/ctpConfig&gt;</span></pre>
                     
                     <p>该例中可通过AppContext.getSystemProperty("samples.test.name")取得“test配置”，AppContext.getSystemProperty("samples.test")取得“插件配置测试”</p>
                     
                     
                     <p>注意：属性key必须以插件id开始</p>
                     
                     
                     <p></p>
                     
                  </div>
                  
                  
                  <div class="section" title="6.4.5.&nbsp;插件国际化配置文件">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1011"></a>6.4.5.&nbsp;插件国际化配置文件
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>插件国际化配置文件位于“cfgHome/plugin/插件id/i18n”目录下，按照JDK国际化文件的配置规则命名，可采用多组文件。使用方式请参考i18n国际化组件部分说明。</p>
                     
                     
                     <p>注意：属性key必须以插件id开始</p>
                     
                     
                     <p></p>
                     
                  </div>
                  
                  
                  <div class="section" title="6.4.6.&nbsp;插件spring配置">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1016"></a>6.4.6.&nbsp;插件spring配置
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>插件spring配置文件位于“cfgHome/plugin/插件id/spring”目录下，可有多个spring配置文件，按照框架规范命名包括：</p>
                     
                     
                     <div class="orderedlist">
                        <ol class="orderedlist" type="1">
                           <li class="listitem">
                              
                              <p>spring-插件id-controller.xml
                                 controller配置，url需要形如“/插件id/xxx.do”
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>spring-插件id-manager.xml manager配置，bean
                                 id需要形如“插件id_mgr_xxx”
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>spring-插件id-dao.xml dao配置，bean id需要形如“插件id_dao_xxx”</p>
                              
                           </li>
                        </ol>
                     </div>
                     
                     
                     <p></p>
                     
                  </div>
                  
                  
                  <div class="section" title="6.4.7.&nbsp;插件hibernatePO加载">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1027"></a>6.4.7.&nbsp;插件hibernatePO加载
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>插件的PO对象和配置文件必须在“com.seeyon.apps.插件id.po”下，可以带子包用于配置自定义HQL的hbm文件</p>
                     
                     
                     <p></p>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="6.5.&nbsp;异常处理">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1031"></a>6.5.&nbsp;异常处理
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>框架规范Manager和DAO各层方法应抛出com.seeyon.ctp.common.exceptions.BusinessException，其它类型异常均通过此异常对象包装抛出，框架支持controller和ajax调用的</p>
                  
                  
                  <p>统一异常处理机制。利用该异常对象可以支持提示消息和错误异常两种类型。提示消息类异常例子代码如下：</p>
                  
                  <pre class="programlisting"><span class="hl-keyword">throw</span> <span class="hl-keyword">new</span> BusinessException(<span class="hl-string">"提示消息"</span>);</pre>
                  
                  <p>或者BusinessException内包含无限层级的BusinessException均视为提示型异常消息，前端将以message提示框提示用户</p>
                  
                  
                  <p>错误型异常为BusinessException中包含了非BusinessException类型的异常的异常，前端将以系统级错误信息提示用户</p>
                  
                  
                  <p></p>
                  
                  
                  <div class="section" title="6.5.1.&nbsp;异常消息国际化">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1039"></a>6.5.1.&nbsp;异常消息国际化
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>异常消息国际化例子代码如下：</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">public</span> BusinessException(String message, <span class="hl-keyword">boolean</span> i18n)<a name="framework_error1_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
<span class="hl-keyword">public</span> BusinessException(String i18nKey, Object... i18nArgs)<a name="framework_error1_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
<span class="hl-keyword">public</span> BusinessException(Throwable cause, String i18nKey, Object... i18nArgs)<a name="framework_error1_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
</pre>
                     
                     <div class="calloutlist">
                        <table border="0" summary="Callout list">
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#framework_error1_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>第二个参数true表示国际化提示消息，第一个参数为提示消息国际化资源key</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p>???</p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>第一个参数为提示消息国际化资源key，后面为多个国际化资源参数</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p>???</p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>第一个参数为内嵌异常，第二个参数为异常消息国际化资源key，后面为多个国际化资源参数</p>
                                 
                              </td>
                           </tr>
                        </table>
                     </div>
                     
                     
                     <p></p>
                     
                  </div>
                  
                  
                  <div class="section" title="6.5.2.&nbsp;例子">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1054"></a>6.5.2.&nbsp;例子
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>请参考：http://[host]:[port]/[context]/samples/test.do?method=testError</p>
                     
                  </div>
                  
               </div>
               
            </div>
            
            
            <div class="chapter" title="Chapter&nbsp;7.&nbsp;组件">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d5e1057"></a>Chapter&nbsp;7.&nbsp;组件
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Table of Contents</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d5e1060">7.1. 脚本引擎支持（Groovy）</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e1078">7.1.1. 表达式计算</a></span></dt>
                           <dt><span class="section"><a href="#d5e1086">7.1.2. 字符串宏替换</a></span></dt>
                           <dt><span class="section"><a href="#d5e1090">7.1.3. 基本函数库</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e1117">7.2. 事件</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e1120">7.2.1. 应用场景</a></span></dt>
                           <dt><span class="section"><a href="#d5e1124">7.2.2. 技术背景</a></span></dt>
                           <dt><span class="section"><a href="#d5e1132">7.2.3. 开发步骤</a></span></dt>
                           <dt><span class="section"><a href="#d5e1144">7.2.4. 事件命名规范</a></span></dt>
                           <dt><span class="section"><a href="#d5e1153">7.2.5. 示例</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e1170">7.3. 缓存</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e1173">7.3.1. 缓存的界定</a></span></dt>
                           <dt><span class="section"><a href="#d5e1191">7.3.2. 缓存组件</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e1216">7.4. 加解密</a></span></dt>
                     <dt><span class="section"><a href="#d5e1220">7.5. 应用锁</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e1226">7.5.1. 名词解释</a></span></dt>
                           <dt><span class="section"><a href="#d5e1231">7.5.2. 功能</a></span></dt>
                           <dt><span class="section"><a href="#d5e1242">7.5.3. 调用</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e1260">7.6. 定时任务 Quartz</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e1295">7.6.1. 业务定时任务</a></span></dt>
                           <dt><span class="section"><a href="#d5e1328">7.6.2. 系统定时任务</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e1342">7.7. 文件（附件）管理JAVA 接口</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e1351">7.7.1. 对输入流下载的接口</a></span></dt>
                           <dt><span class="section"><a href="#d5e1359">7.7.2. 删除附件的接口</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e1368">7.8. 文件压缩/解压</a></span></dt>
                     <dt><span class="section"><a href="#d5e1373">7.9. i18n国际化</a></span></dt>
                  </dl>
               </div>
               
               
               
               <p></p>
               
               
               <div class="section" title="7.1.&nbsp;脚本引擎支持（Groovy）">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1060"></a>7.1.&nbsp;脚本引擎支持（Groovy）
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>脚本引擎可用于</p>
                  
                  
                  <div class="orderedlist">
                     <ol class="orderedlist" type="1">
                        <li class="listitem">
                           
                           <p>表单的公式（表达式）计算</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>流程分支条件运算</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>字符串宏替换</p>
                           
                        </li>
                     </ol>
                  </div>
                  
                  
                  <p>它最基本的功能是表达式计算，比如x+y，x=1，y=2</p>
                  
                  
                  <p>x+y是脚本</p>
                  
                  <pre class="programlisting">String script = <span class="hl-string">"x+y"</span>;</pre>
                  
                  <p>而x=1，y=2则是对应的上下文，表现为 </p><pre class="programlisting">Map&lt;String, Object&gt; context = <span class="hl-keyword">new</span> HashMap&lt;String, Object&gt;();
context.put(<span class="hl-string">"x"</span>, <span class="hl-number">1</span>);
context.put(<span class="hl-string">"y"</span>, <span class="hl-number">2</span>);</pre><p>通过下面的调用即可得到结果3</p>
                  
                  <pre class="programlisting"><span class="hl-keyword">import</span> com.seeyon.ctp.common.script.ScriptEvaluator;
...
Integer result = (Integer) ScriptEvaluator.getInstance().eval(script, context);</pre>
                  
                  <div class="section" title="7.1.1.&nbsp;表达式计算">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1078"></a>7.1.1.&nbsp;表达式计算
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     <pre class="programlisting"><span class="hl-comment">// 预置函数库</span>
String functions = <span class="hl-string">"def 加(a,b){a+b}\n def 减 = {x,y-&gt; x-y}\n"</span>;
<span class="hl-comment">// 运算上下文</span>
Map&lt;String, Object&gt; context = <span class="hl-keyword">new</span> HashMap&lt;String, Object&gt;();
context.put(<span class="hl-string">"x"</span>, <span class="hl-number">1</span>);
context.put(<span class="hl-string">"y"</span>, <span class="hl-number">2</span>);
context.put(<span class="hl-string">"str"</span>, <span class="hl-string">"string"</span>);</pre>
                     
                     <p></p>
                     
                     <pre class="programlisting"><span class="hl-keyword">import</span> com.seeyon.ctp.common.script.ScriptEvaluator;
...
ScriptEvaluator evaluator = ScriptEvaluator.getInstance();
<span class="hl-keyword">try</span> {
    assertEquals(evaluator.eval(<span class="hl-string">"x+y"</span>, context), <span class="hl-number">3</span>);

    assertEquals(evaluator.eval(<span class="hl-string">"str.length()"</span>, context), <span class="hl-number">6</span>);
    assertEquals(evaluator.eval(functions + <span class="hl-string">"加 x,y"</span>, context), <span class="hl-number">3</span>);
    assertEquals(evaluator.eval(functions + <span class="hl-string">"减(x,y)"</span>, context), -<span class="hl-number">1</span>);
} <span class="hl-keyword">catch</span> (ScriptException e) {
    fail(e.getLocalizedMessage());
}</pre>
                     </div>
                  
                  
                  <div class="section" title="7.1.2.&nbsp;字符串宏替换">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1086"></a>7.1.2.&nbsp;字符串宏替换
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     <pre class="programlisting"><span class="hl-keyword">import</span> com.seeyon.ctp.common.script.ScriptEvaluator;
...
assertEquals(evaluator.evalString(<span class="hl-string">"x+$y"</span>, context), <span class="hl-string">"x+2"</span>); <span class="hl-comment">// 把$y替换为上下文中指定的值2</span>
assertEquals(evaluator.evalString(<span class="hl-string">"$x+${y}"</span>, context), <span class="hl-string">"1+2"</span>);<span class="hl-comment">//$y也可写为${y}</span></pre>
                     </div>
                  
                  
                  <div class="section" title="7.1.3.&nbsp;基本函数库">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1090"></a>7.1.3.&nbsp;基本函数库
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>为了实现预置公式，简化调用，我们可以像上面那样用Groovy的闭包或函数实现基本函数库，与表达式字符串一起调用eval</p>
                     
                     <pre class="programlisting"><span class="hl-comment">// 预置函数库</span>
String functions = <span class="hl-string">"def 加(a,b){a+b}\n def 减 = {x,y-&gt; x-y}\n"</span>;

ScriptEvaluator.getInstance().eval(functions + <span class="hl-string">"加 x,y"</span>, context);</pre>
                     
                     <p>但是，如果预置的函数库很大，无论是定义还是调用都会很麻烦。</p>
                     
                     
                     <p>我们可以用一种更优雅更自然的方式</p>
                     
                     
                     <div class="procedure">
                        <ol class="procedure" type="1">
                           <li class="step" title="Step 1">
                              
                              <p>首先，实现一个基础函数库类，这个类可以用groovy实现，也可以用java实现，但它的所有要被脚本调用的方法都必须是static的</p>
                              
                              
                              <p>比如CommonFunctions.groovy</p>
                              
                              <pre class="programlisting"><span class="hl-keyword">package</span> com.seeyon.ctp.common.script
<span class="hl-keyword">import</span> com.seeyon.ctp.common.AppContext
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> CommonFunctions {
    <span class="hl-doctype">/**
     * 可以用Java method实现。
     */</span>
    <span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">int</span> add(<span class="hl-keyword">int</span> x,<span class="hl-keyword">int</span> y){
        <span class="hl-keyword">return</span> x+y;
    }
    <span class="hl-doctype">/**
     * 也可以用Groovy function实现（支持中文）。
     */</span>
    <span class="hl-keyword">def</span> <span class="hl-keyword">static</span> 加(a,b){
        a+b
    }
    <span class="hl-doctype">/**
     * 还可以用Groovy closure实现。
     */</span>
    <span class="hl-keyword">def</span> <span class="hl-keyword">static</span> 减 = { x,y-&gt;
        x-y
    }
    <span class="hl-doctype">/**
     * 可以为Java methdo包一个壳，简化调用。
     */</span>
    <span class="hl-keyword">def</span> currentUserName(){
        AppContext.currentUserName()
    }
}</pre>
                              </li>
                           <li class="step" title="Step 2">
                              
                              <p>然后，可以在Java中作如下调用</p>
                              
                              <pre class="programlisting">evaluator.eval(<span class="hl-string">"</span><span class="emphasis"><em>import static com.seeyon.ctp.common.script.CommonFunctions.*;</em></span><span class="hl-string">" + "</span>减(x,y)<span class="hl-string">", context)
</span>evaluator.eval(<span class="hl-string">"import static com.seeyon.ctp.common.script.CommonFunctions.*;"</span> + <span class="hl-string">"currentUserName()"</span>, context)</pre>
                              
                              <p></p>
                              
                           </li>
                           <li class="step" title="Step 3">
                              
                              <p>表单和工作流等模块可以继承CommonFunctions扩展自己的特殊函数</p>
                              
                              <pre class="programlisting"><span class="hl-keyword">package</span> com.seeyon.ctp.common.script
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> FormFunctions <span class="hl-keyword">extends</span> CommonFunctions{

}</pre><p>然后，在调用时import</p>
                              
                              <pre class="programlisting">evaluator.eval(<span class="hl-string">"import static com.seeyon.ctp.common.script.</span><span class="emphasis"><em>FormFunctions</em></span>.*;<span class="hl-string">" + "</span>减(x,y)<span class="hl-string">", context)
</span></pre>
                              </li>
                        </ol>
                     </div>
                     <p>对于复杂的复合对象，建议在脚本中直接调用Java的系统上下文对象获取，比如</p>
                     
                     <pre class="programlisting"><span class="hl-keyword">def</span> userName = com.seeyon.ctp.common.AppContext.currentUserName()</pre>
                     
                     <p>同理，表单和工作流也可以封装供脚本调用的上下文对象，如FormContext、WorkFlowContext。</p>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="7.2.&nbsp;事件">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1117"></a>7.2.&nbsp;事件
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p></p>
                  
                  
                  <div class="section" title="7.2.1.&nbsp;应用场景">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1120"></a>7.2.1.&nbsp;应用场景
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>底层组件（或一个模块）发生动作，需要让上层应用（或其它模块）做出响应动作。</p>
                     
                     
                     <p>比如：组织模型创建单位，上层公文需要给这个新单位创建一套预置公文元素、公告需要预置一套板块等等。</p>
                     
                  </div>
                  
                  
                  <div class="section" title="7.2.2.&nbsp;技术背景">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1124"></a>7.2.2.&nbsp;技术背景
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>采用类似Observable+Observer模式，使用java.util.EventObject技术，并进行了简化开发。</p>
                     
                     
                     <p>方案特点：注解驱动、无需注册监听、无需定义事件类型、异步分发、易扩展。</p>
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/eventModel.jpg"></div>
                     
                  </div>
                  
                  
                  <div class="section" title="7.2.3.&nbsp;开发步骤">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1132"></a>7.2.3.&nbsp;开发步骤
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <div class="orderedlist">
                        <ol class="orderedlist" type="1">
                           <li class="listitem">
                              
                              <p>定义事件 (Event)
                                 封装事件的上下文，隐含事件类型信息，一个事件对象唯一标识一类事件，不允许重用，同时也在事件触发者和事件处理者之间传递数据。必须继承com.seeyon.ctp.event.Event。
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>事件触发</p>
                              
                              
                              <p>在事件发生的源头，发出事件通知。
                                 com.seeyon.ctp.event.EventDispatcher.fireEvent(Event)
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>事件监听（注解驱动）</p>
                              
                              
                              <p>其它任意模块都可以监听上述事件，只需要在方法上面什么@listenEvent(event=XXXEvent.class)，方法参数即为Event对象。
                                 监听类必须定义为spring bean
                              </p>
                              
                           </li>
                        </ol>
                     </div>
                     
                     
                     <p></p>
                     
                  </div>
                  
                  
                  <div class="section" title="7.2.4.&nbsp;事件命名规范">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1144"></a>7.2.4.&nbsp;事件命名规范
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>事件对象都放到模块的event包下，如com.seeyon.apps.collaboration.event</p>
                     
                     
                     <p>模块名称+操作+Event，如：</p>
                     
                     
                     <p>// 流程发起事件 CollaborationStartEvent</p>
                     
                     
                     <p>// 流程结束事件 CollaborationFinishEvent</p>
                     
                     
                     <p>// 流程处理事件 CollaborationProcessEvent</p>
                     
                     
                     <p>// 流程回退事件 CollaborationStepBackEvent</p>
                     
                     
                     <p>// 流程撤销事件 CollaborationCancelEvent</p>
                     
                  </div>
                  
                  
                  <div class="section" title="7.2.5.&nbsp;示例">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1153"></a>7.2.5.&nbsp;示例
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <div class="procedure">
                        <ol class="procedure" type="1">
                           <li class="step" title="Step 1">
                              
                              <p>第一步：定义事件，并定义好所需要的数据</p>
                              
                              
                              <p></p>
                              
                              <pre class="programlisting"><span class="hl-doctype">/**

 * 流程发起事件

*/</span>

<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> CollaborationStartEvent <span class="hl-keyword">extends</span> Event {

         <span class="hl-keyword">private</span> <span class="hl-keyword">static</span> <span class="hl-keyword">final</span> <span class="hl-keyword">long</span> serialVersionUID = -<span class="hl-number">8411990532000425368L</span>;

 

         <span class="hl-keyword">public</span> CollaborationStartEvent(Object source) {

                   <span class="hl-keyword">super</span>(source);

         }

         

         <span class="hl-keyword">private</span> Long summaryId;

         <span class="hl-keyword">private</span> String from;

         <span class="hl-comment">//getter</span>

         <span class="hl-comment">//setter</span>

}</pre>
                              </li>
                           <li class="step" title="Step 2">
                              
                              <p>第二步：在协同发起代码中触发事件</p>
                              
                              
                              <p></p>
                              
                              <pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> CollaborationController <span class="hl-keyword">extends</span> BaseController{
    <span class="hl-keyword">public</span> ModelAndView send(HttpServletRequest request,
                             HttpServletResponse response) <span class="hl-keyword">throws</span> Exception {
        …….
       <span class="hl-comment">//协同发起事件通知</span>
        CollaborationStartEvent event = <span class="hl-keyword">new</span> CollaborationStartEvent(<span class="hl-keyword">this</span>);
        event.setSummaryId(colSummary.getId());
        event.setFrom(<span class="hl-string">"pc"</span>);
        EventDispatcher.fireEvent(event);
        ……
    }
}</pre>
                              </li>
                           <li class="step" title="Step 3">
                              
                              <p>第三步：其它监听事件</p>
                              
                              
                              <p></p>
                              
                              <pre class="programlisting"><span class="hl-keyword">public</span> FormEventListener{
    <span class="hl-annotation">@listenEvent(event= CollaborationStartEvent.class)</span>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> onCollaborationStart(CollaborationStartEvent event){
        <span class="hl-comment">//event.getSummartId()</span>
    }
}</pre>
                              
                              <pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">""</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.seeyon.apps.form.FormEventListener"</span><span class="hl-tag">&gt;</span>
    ……
<span class="hl-tag">&lt;/bean&gt;</span></pre>
                              </li>
                        </ol>
                     </div>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="7.3.&nbsp;缓存">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1170"></a>7.3.&nbsp;缓存
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>总的原则，少用缓存，能不用就不用。</p>
                  
                  
                  <div class="section" title="7.3.1.&nbsp;缓存的界定">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1173"></a>7.3.1.&nbsp;缓存的界定
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <div class="orderedlist">
                        <ol class="orderedlist" type="1">
                           <li class="listitem">
                              
                              <p>静态成员变量集合，在方法中有增删改操作； 只在系统初始化时加载，运行过程中不改变的可以不做缓存同步。</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>Singleton的成员变量集合，有增删改操作；</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>Singleton的成员变量，有修改值操作；</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>锁（如表单和协同的操作锁）； 使用数据库保存锁状态的可以不考虑同步。</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>自增变量。 如果在内存中维护自增值，就必须做集群的改造。</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>定时任务。 可以改用Quartz组件，它已经支持集群。</p>
                              
                           </li>
                        </ol>
                     </div>
                     
                     
                     <p>平台提供了两种同步机制来确保缓存的一致性：</p>
                     
                     
                     <p>缓存组件和通知同步。</p>
                     
                     
                     <p>缓存组件适用于小对象，它们在集群节点间进行完整传输，不会给网络造成太大负载。
                        通知同步适用于大数据量或需要频繁进行细粒度更新的场合，比如要从数据库完全重新加载整个缓存，如果使用缓存组件就太奢侈了，这时候，我们可以使用通知同步机制，发送一个通知给其它节点，让它们也进行一次缓存重载。
                        如果有内存占用较大需要缓存的对象，请不要直接使用缓存组件，可以使用通知同步，传递唯一标识对象的id，让别的节点根据id自行加载（也可使用缓存组件的DataLoader）。
                     </p>
                     
                  </div>
                  
                  
                  <div class="section" title="7.3.2.&nbsp;缓存组件">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1191"></a>7.3.2.&nbsp;缓存组件
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>组件提供三种缓存数据结构</p>
                     
                     
                     <p>1、 CacheMap
                        与java.util.Map一致的数据结构,支持集群同步,对CacheMap的任何变更都会同步到集群的其他节点.
                     </p>
                     
                     
                     <p>2、 CacheSet 类似CacheMap,替代java.util.Set</p>
                     
                     
                     <p>3、 CacheObject 缓存单一变量</p>
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/cacheClass.jpg"></div>
                     
                     
                     <p>下面以CacheMap为例来说明缓存的使用.</p>
                     
                     
                     <p></p>
                     
                     <pre class="programlisting">取得缓存管理工厂实例
    CacheAccessable factory = CacheFactory.getInstance(MyClass.<span class="hl-keyword">class</span>);
 
创建缓存
    <span class="hl-keyword">private</span> CacheMap&lt;String,String&gt; cache = factory.createMap(<span class="hl-string">"first"</span>);
    ...
使用缓存
    cache.put(<span class="hl-string">"aKey"</span>,value);
    ...
    String value = cache.get(<span class="hl-string">"aKey"</span>);</pre>
                     
                     <p>缓存的创建方式类似Log4J，以当前类的class作为组名称区隔不同的缓存，createMap的参数定义了缓存的名称。
                         具体的调用则与Map完全一样。
                     </p>
                     
                     
                     <p>DataLoader：
                        对于大对象，直接同步会导致较大的网络开销的，可以建立一个DataLoader，只传递Key，由接收方自行重载缓存。
                     </p>
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/cacheDataLoader.jpg"></div>
                     
                     
                     <p></p>
                     
                     <pre class="programlisting"><span class="hl-doctype">/**
 * 缓存数据加载。为缓存的reload方法提供重新加载缓存的支持。缓存调用者需要自己实现此接口。
* @see AbstractMapDataLoader
 */</span>
<span class="hl-keyword">public</span> <span class="hl-keyword">interface</span> DataLoader&lt;K <span class="hl-keyword">extends</span> Serializable&gt; {
    <span class="hl-doctype">/**
     * 重新加载整个缓存。
     */</span>
    <span class="hl-keyword">void</span> load();

    <span class="hl-doctype">/**
     * 重新加载指定Key的缓存项。
     * 
     * @param key
     *            缓存的key。
     */</span>
    <span class="hl-keyword">void</span> load(K key);
}</pre>
                     
                     <p></p>
                     
                     
                     <p>DataLoader开发示例</p>
                     
                     <pre class="programlisting">        cache.setDataLoader(<span class="hl-keyword">new</span> AbstractMapDataLoader&lt;String, String&gt;(cache) {
            <span class="hl-annotation">@Override</span>
            <span class="hl-keyword">protected</span> Map&lt;Long, String&gt; loadLocal() {
                Map&lt;String, String&gt; map = <span class="hl-keyword">new</span> HashMap&lt;String, String&gt;();
                <span class="hl-comment">//    从数据库中加载所有数据，组织为与缓存一致的结构</span>
           
                ……
            <span class="hl-keyword">return</span> map;
            }
            <span class="hl-annotation">@Override</span>
            <span class="hl-keyword">protected</span> String loadLocal(String key) {
            <span class="hl-comment">//    从数据库中加载指定数据，返回</span>
                <span class="hl-keyword">final</span> String value = dao.get(key);
                <span class="hl-keyword">return</span> value;
            }
        });
</pre>
                     
                     <p></p>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="7.4.&nbsp;加解密">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1216"></a>7.4.&nbsp;加解密
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p></p>
                  
                  <pre class="programlisting">com.seeyon.ctp.common.encrypt.CoderFactory

<span class="hl-doctype">/**

 * 加密深度  

 * 

 * @return 轻度加密：{@link ICoder#VERSON01}；

 * 深度加密：{@link ICoder#VERSON02}；

 * 不加密：&lt;code&gt;no&lt;/code&gt;

 */</span>

<span class="hl-keyword">public</span> String getEncryptVersion() ;</pre>
                  </div>
               
               
               <div class="section" title="7.5.&nbsp;应用锁">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1220"></a>7.5.&nbsp;应用锁
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>应用锁组件用于控制并发修改</p>
                  
                  
                  <p>比如协同流程并发修改和公文正文并发编辑控制。</p>
                  
                  
                  <p>为应用提供统一的独占锁，管理用户、资源、操作三者之间的关系。
                     只控制锁的状态（加锁、解锁、锁失效、锁判断），不实际对资源进行锁定，资源和操作的锁定由应用自己管理。
                  </p>
                  
                  
                  <p>为同时适应单机和集群环境，提升性能，提供内存锁和数据库锁两种模式。 单机环境使用内存保存锁；集群环境使用数据库保存锁。</p>
                  
                  
                  <div class="section" title="7.5.1.&nbsp;名词解释">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1226"></a>7.5.1.&nbsp;名词解释
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p> 模块：需要加锁的应用。如协同、公文、表单，可以自行指定一个字符串，如ColLock、FormLock作为标识。</p>
                     
                     
                     <p> 资源：被锁定对象。可以是协同、公文、表单，甚至是人员。</p>
                     
                     
                     <p> 操作：被锁定对象的行为。对于流程，可以是处理、加签减签等。</p>
                     
                  </div>
                  
                  
                  <div class="section" title="7.5.2.&nbsp;功能">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1231"></a>7.5.2.&nbsp;功能
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>功能一： 锁定资源 特定用户锁定资源，解锁或锁失效之前其他用户不允许访问资源。
                        锁定资源后指定资源只允许加锁者独占使用。
                     </p>
                     
                     
                     <p>功能二： 锁定资源的操作 特定用户锁定资源的操作，解锁或锁失效之前其他用户不允许进行资源的操作。</p>
                     
                     
                     <p>功能三： 解锁 解除资源的所有锁或解除资源特定操作的锁。</p>
                     
                     
                     <p>功能四： 锁判断 判断指定用户是否可以访问资源或资源的操作。
                        这里会有一定歧义：对资源加锁是锁定了资源的所有操作，还是操作为空本身就是一种操作。
                        在这里不做处理，由应用自己解释。如果有特定的解释，请不要使用组件提供的锁判断方法，取得资源的所有锁后自己判断。
                     </p>
                     
                     
                     <p>功能五： 锁过期 提供了锁过期的策略，缺省过期时间设置为8小时，以后可以进行扩展。</p>
                     
                     
                     <p>功能六： 锁失效 以下三种情况会导致锁失效，失效的锁将被系统自动清理。</p>
                     
                     
                     <p> 锁过期；</p>
                     
                     
                     <p> 加锁人不在线；</p>
                     
                     
                     <p> 加锁人虽然在线，但加锁以后登出过（加锁时间&lt;登录时间）。</p>
                     
                  </div>
                  
                  
                  <div class="section" title="7.5.3.&nbsp;调用">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1242"></a>7.5.3.&nbsp;调用
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <div class="procedure">
                        <ol class="procedure" type="1">
                           <li class="step" title="Step 1">
                              
                              <p>应用如果要使用锁组件，确定模块编号以后，在Spring配置文件中定义一个新的bean，如下所示</p>
                              
                              
                              <p></p>
                              
                              <pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"formLock"</span> <span class="hl-attribute">parent</span>=<span class="hl-value">"lockManager"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"module"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"formLock"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>
                              </li>
                           <li class="step" title="Step 2">
                              
                              <p>然后在自己的class中引用定义的bean即可。</p>
                              
                              
                              <p></p>
                              
                              <pre class="programlisting"><span class="hl-tag">&lt;bean</span> <span class="hl-attribute">id</span>=<span class="hl-value">"formManager"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.seeyon.v3x.form.FormManagerImpl"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;property</span> <span class="hl-attribute">name</span>=<span class="hl-value">"formLock"</span> <span class="hl-attribute">ref</span>=<span class="hl-value">"formLock"</span><span class="hl-tag">/&gt;</span>
<span class="hl-tag">&lt;/bean&gt;</span></pre>
                              </li>
                           <li class="step" title="Step 3">
                              
                              <p>加锁</p>
                              
                              <pre class="programlisting"><span class="hl-keyword">public</span> <span class="hl-keyword">class</span> FormManagerImpl {
    <span class="hl-keyword">private</span> <span class="hl-keyword">long</span> owner;
    <span class="hl-keyword">private</span> LockManager formLock;
    <span class="hl-keyword">private</span> <span class="hl-keyword">long</span> resourceId;
    <span class="hl-keyword">private</span> <span class="hl-keyword">int</span> action = -<span class="hl-number">1</span>;
    

    <span class="hl-keyword">public</span> <span class="hl-keyword">long</span> getFormLock() {
        <span class="hl-keyword">return</span> formLock;
    }

    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setFormLock(LockManager formLock) {
        <span class="hl-keyword">this</span>.formLock = formLock;
    }

    <span class="hl-keyword">public</span> <span class="hl-keyword">long</span> lock( <span class="hl-keyword">long</span> memberId,<span class="hl-keyword">long</span> formId) {
        <span class="emphasis"><em>formLock.lock</em></span>(memberId,formId);
    }
}</pre>
                              </li>
                        </ol>
                     </div>
                     
                     
                     <p></p>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="7.6.&nbsp;定时任务 Quartz">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1260"></a>7.6.&nbsp;定时任务 Quartz
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>定时任务分为两种，一种是业务定时任务，另一种是系统定时任务</p>
                  
                  
                  <div class="table"><a name="d5e1264"></a><p class="title"><b>Table&nbsp;7.1.&nbsp;定时任务分类</b></p>
                     <div class="table-contents">
                        
                        
                        
                        <table summary="定时任务分类" border="1">
                           <colgroup>
                              <col width="25%">
                              <col width="25%">
                              <col width="25%">
                              <col width="25%">
                           </colgroup>
                           <tbody>
                              <tr>
                                 <td>
                                    <p>名称</p>
                                 </td>
                                 <td>
                                    <p>使用范围</p>
                                 </td>
                                 <td>
                                    <p>技术特征</p>
                                 </td>
                                 <td>
                                    <p>举例</p>
                                 </td>
                              </tr>
                              <tr>
                                 <td>
                                    <p>业务定时任务</p>
                                 </td>
                                 <td>
                                    <p>应用中的定时任务</p>
                                 </td>
                                 <td>
                                    <p>定时任务将被持久化</p>
                                 </td>
                                 <td>
                                    <p>提前提醒，超期提醒</p>
                                 </td>
                              </tr>
                              <tr>
                                 <td>
                                    <p>系统定时任务</p>
                                 </td>
                                 <td>
                                    <p>异步的调度系统</p>
                                 </td>
                                 <td>
                                    <p>定时任务将在系统启动初生成，shutdown是终止，不会被持久化</p>
                                 </td>
                                 <td>
                                    <p>定时从移动网关取短信内容</p>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        
                     </div>
                  </div>
                  <p><br class="table-break"></p>
                  
                  
                  <div class="section" title="7.6.1.&nbsp;业务定时任务">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1295"></a>7.6.1.&nbsp;业务定时任务
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="orderedlist">
                        <ol class="orderedlist" type="1">
                           <li class="listitem">
                              
                              <p>核心类com.seeyon.ctp.common.quartz.QuartzHolder</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>基本原理</p>
                              
                              
                              <p>定时任务采用异步处理模式，在生成定时任务的时候，需要指定：任务处理器Bean + 参数。
                                 任务处理器Bean是解释执行特定任务的JavaBean，通过参数来描述业务特征
                              </p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>接口规范</p>
                              
                              
                              <div class="itemizedlist">
                                 <ul class="itemizedlist" type="disc">
                                    <li class="listitem">
                                       
                                       <p>定义任务处理，实现com.seeyon.ctp.common.quartz.QuartzJob接口</p>
                                       
                                       <pre class="programlisting"><span class="hl-keyword">class</span> ABCQuartz implement QuartzJob{

<span class="hl-keyword">public</span> <span class="hl-keyword">void</span> execute(Map&lt;String, String&gt; parameters){

         Long id = parameters.get(<span class="hl-string">"id"</span>);

         ...

}

}
 
&lt;bean name=<span class="hl-string">"abcQuartz"</span> <span class="hl-keyword">class</span>=<span class="hl-string">"package.ABCQuartz"</span> &gt;</pre>
                                       </li>
                                    <li class="listitem">
                                       
                                       <p>生成/注册任务</p>
                                       
                                       
                                       <p>调用接口/方法：
                                          com.seeyon.ctp.common.quartz.QuartzHolder
                                       </p>
                                       
                                       <pre class="programlisting">Map&lt;String, String&gt; parameters = <span class="hl-keyword">new</span> HashMap&lt;String, String&gt;();

parameters.put(<span class="hl-string">"id"</span>, String.valueOf(id));

QuartzHolder.newQuartzJob(<span class="hl-string">"jobName"</span>, <span class="hl-keyword">new</span> Date(<span class="hl-number">109</span>, <span class="hl-number">1</span>, <span class="hl-number">1</span>), <span class="hl-string">"abcQuartz"</span>, parameters);
</pre>
                                       </li>
                                    <li class="listitem">
                                       
                                       <p>任务查找和删除</p>
                                       
                                       <pre class="programlisting"><span class="hl-doctype">/**

 * 检测任务是否存在

 * 

 * @param name 任务名称

 * @return

 */</span>

<span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">boolean</span> hasQuartzJob(String name);

 

<span class="hl-doctype">/**

 * 删除任务

 * 

 * @param name 任务名称

 * @return

 */</span>

<span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">boolean</span> deleteQuartzJob(String name);</pre><p> </p>
                                       <div class="caution" title="Caution" style="margin-left: 0.5in; margin-right: 0.5in;">
                                          <table border="0" summary="Caution">
                                             <tr>
                                                <td rowspan="2" align="center" valign="top" width="25"><img alt="[Caution]" src="resources/admonitions/caution.png"></td>
                                                <th align="left">Caution</th>
                                             </tr>
                                             <tr>
                                                <td align="left" valign="top">
                                                   
                                                   <p>特别注意
                                                      任务名称要求唯一，即每次调用newQuartzJob时，参数name都是不同的，即使jobBeanId是一致的。
                                                   </p>
                                                   
                                                   
                                                   <p>如：协同的提前提醒，jobBeanId是同一个，但每一个节点的name、parameters都不是一样的，也就是说这不属于同一个任务。</p>
                                                   
                                                   
                                                   <p>目的：方便任务解除。</p>
                                                   
                                                </td>
                                             </tr>
                                          </table>
                                       </div>
                                       
                                    </li>
                                 </ul>
                              </div>
                              
                           </li>
                        </ol>
                     </div>
                     
                     
                     <p></p>
                     
                     
                     <p></p>
                     
                     
                     <p></p>
                     
                     
                     <p></p>
                     
                  </div>
                  
                  
                  <div class="section" title="7.6.2.&nbsp;系统定时任务">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1328"></a>7.6.2.&nbsp;系统定时任务
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="orderedlist">
                        <ol class="orderedlist" type="1">
                           <li class="listitem">
                              
                              <p>核心类com.seeyon.ctp.common.timer.TimerHolder</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>定义任务处理器</p>
                              
                              <pre class="programlisting">
<span class="hl-keyword">class</span> SampleTask <span class="hl-keyword">implements</span> Runnable{

         <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> run(){

                 ...

         }

} 
 
&lt;bean name=<span class="hl-string">"sampleTask"</span> <span class="hl-keyword">class</span>=<span class="hl-string">"package.SampleTask"</span> &gt;</pre>
                              </li>
                           <li class="listitem">
                              
                              <p>生成/注册任务</p>
                              
                              <pre class="programlisting">
<span class="hl-keyword">public</span> <span class="hl-keyword">void</span> StartTask() {

         TimerHolder.newTimer(sampleTask, <span class="hl-number">60</span> * <span class="hl-number">60</span> * <span class="hl-number">1000</span>);

}</pre>
                              </li>
                        </ol>
                     </div>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="7.7.&nbsp;文件（附件）管理JAVA 接口">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1342"></a>7.7.&nbsp;文件（附件）管理JAVA 接口
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>此部分只描述JAVA程序可用的附件接口，不描述前端附件组件，附件组件的完整用法，请参考前端组件部分。</p>
                  
                  
                  <p>后端提供如下接口：</p>
                  
                  
                  <div class="orderedlist">
                     <ol class="orderedlist" type="1">
                        <li class="listitem">
                           
                           <p>对输入流的下载。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>对附件的删除。</p>
                           
                        </li>
                     </ol>
                  </div>
                  
                  
                  <div class="section" title="7.7.1.&nbsp;对输入流下载的接口">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1351"></a>7.7.1.&nbsp;对输入流下载的接口
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <div class="orderedlist">
                        <ol class="orderedlist" type="1">
                           <li class="listitem">
                              
                              <p>FileUploadUtil.downLoadStream(……）</p>
                              
                              <pre class="programlisting">FileUploadUtil工具类
    
    <span class="hl-doctype">/**
     * 对输入流直接下载
     * 例如对需要导出的数据组织成输入流，对该流直接下载。
     * 在request中需要设置下面属性：filename （即 request.setAttribute("filename","某某数据")）
     * @param request
     * @param response
     * @param in
     * @return
     * @throws BusinessException
     */</span>
    <span class="hl-keyword">public</span> <span class="hl-keyword">static</span> ModelAndView downLoadStream(HttpServletRequest request, HttpServletResponse response,InputStream in) <span class="hl-keyword">throws</span> BusinessException;
 </pre>
                              </li>
                        </ol>
                     </div>
                     
                     
                     <p></p>
                     
                  </div>
                  
                  
                  <div class="section" title="7.7.2.&nbsp;删除附件的接口">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1359"></a>7.7.2.&nbsp;删除附件的接口
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <div class="orderedlist">
                        <ol class="orderedlist" type="1">
                           <li class="listitem">
                              
                              <p>attachmentManager.removeByReference(……）</p>
                              
                              
                              <p>attachmentManager.deleteById(……）</p>
                              
                              <pre class="programlisting">         <span class="hl-doctype">/**
          * 按照主数据和次数据删除: 文件做物理删除 
          * @param reference
          * @param subReference
          */</span>
         <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> removeByReference(Long reference, Long subReference)
         <span class="hl-keyword">throws</span> BusinessException;
         

         <span class="hl-doctype">/**
          * 按照附件Id删除，非物理删除
          * @param attachmentId
          */</span>
         <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> deleteById(<span class="hl-keyword">long</span> attachmentId);
 </pre>
                              </li>
                        </ol>
                     </div>
                     
                     
                     <p></p>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="7.8.&nbsp;文件压缩/解压">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1368"></a>7.8.&nbsp;文件压缩/解压
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>支持ZIP格式文件的压缩和解压</p>
                  
                  
                  <p></p>
                  
                  <pre class="programlisting"><span class="hl-keyword">import</span> com.seeyon.ctp.util.ZipUtil;
<span class="hl-comment">// 压缩整个文件夹</span>
ZipUtil.zip(<span class="hl-keyword">new</span> File(<span class="hl-string">"d:\\新建文件夹"</span>), <span class="hl-keyword">new</span> File(<span class="hl-string">"c:\\新建文件夹.zip"</span>), true);
<span class="hl-comment">// 压缩指定文件夹下所有文件</span>
ZipUtil.zip(<span class="hl-keyword">new</span> File(<span class="hl-string">"d:\\新建文件夹"</span>), <span class="hl-keyword">new</span> File(<span class="hl-string">"c:\\新建文件夹.zip"</span>), false);
<span class="hl-comment">// 压缩一组文件</span>
ZipUtil.zip(Collection&lt;File&gt;, <span class="hl-keyword">new</span> File(<span class="hl-string">"c:\\新建文件夹.zip"</span>));
<span class="hl-comment">// 解压缩zip包</span>
ZipUtil.unzip(File zipFile, File directory);</pre>
                  </div>
               
               
               <div class="section" title="7.9.&nbsp;i18n国际化">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1373"></a>7.9.&nbsp;i18n国际化
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>CTP2.0开始对国际化组件进行新的设计，所有的国际化资源文件集中存放在cfgHome/i18n下，可以按照模块划分子文件夹存放，框架会在启动时自动加载全部资源文件，并形成</p>
                  
                  
                  <p>总体的key-&gt;value映射，这种模式下要求各模块的key命名要严格按照规范进行定义，不允许出现重复，否则将会相互覆盖。系统Locale定义的配置存在于</p>
                  
                  
                  <p>WEB-INF/cfgHome/base/ctpConfig.xml中的locales属性：</p>
                  
                  <pre class="programlisting"><span class="hl-tag">&lt;globals</span> <span class="hl-attribute">appSysName</span>=<span class="hl-value">"CTP"</span> <span class="hl-attribute">defaultFlipPageSize</span>=<span class="hl-value">"15"</span> <span class="hl-attribute">runningMode</span>=<span class="hl-value">"develop"</span> <span class="hl-attribute">locales</span>=<span class="hl-value">"zh_CN,en,zh_TW"</span><span class="hl-tag"> /&gt;</span></pre>
                  
                  <p>前端的调用方式如下：</p>
                  
                  <pre class="programlisting"><span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>ctp:i18n函数<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>${ctp:i18n('common.button.add.label')}<span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span>
<span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>ctp:i18n_1函数，一个参数，变量参数<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>${ctp:i18n_1('common.charactor.limit.label',path)}<span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span>
<span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>ctp:i18n_1函数，一个参数，数值参数<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>${ctp:i18n_1('common.charactor.limit.label',10)}<span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span>
<span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>ctp:i18n_1函数，一个参数，字符串参数<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>${ctp:i18n_1('common.charactor.limit.label','测试')}<span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span>
<span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>ctp:i18n_2函数，两个参数<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>${ctp:i18n_2('common.charactor.limit.label','测试',3)}<span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span>
<span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>ctp:i18n_3函数，三个参数<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>${ctp:i18n_3('common.charactor.limit.label','测试',3,3)}<span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span>
<span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>ctp:i18n_4函数，四个参数<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>${ctp:i18n_4('common.charactor.limit.label','测试',3,3,3)}<span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span>
<span class="hl-tag">&lt;tr&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>ctp:i18n_5函数，五个参数<span class="hl-tag">&lt;/td&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>${ctp:i18n_5('common.charactor.limit.label','测试',3,3,3,3)}<span class="hl-tag">&lt;/td&gt;</span>
<span class="hl-tag">&lt;/tr&gt;</span></pre>
                  
                  <p>后端的调用方式如下：</p>
                  
                  <pre class="programlisting">System.out.println(ResourceUtil.getString(<span class="hl-string">"common.button.add.label"</span>));
System.out.println(ResourceUtil.getString(<span class="hl-string">"common.charactor.limit.label"</span>, <span class="hl-number">12</span>));
System.out.println(ResourceUtil.getString(<span class="hl-string">"common.date.times"</span>, <span class="hl-number">2</span>, <span class="hl-number">15</span>));
System.out.println(ResourceUtil.getString(<span class="hl-string">"common.date.times"</span>, <span class="hl-number">2</span>, <span class="hl-number">15</span>, <span class="hl-number">3</span>));
System.out.println(ResourceUtil.getString(<span class="hl-string">"common.date.times"</span>, <span class="hl-number">2</span>, <span class="hl-number">15</span>, <span class="hl-number">3</span>, <span class="hl-number">4</span>));
System.out.println(ResourceUtil.getString(<span class="hl-string">"common.date.times"</span>, <span class="hl-number">2</span>, <span class="hl-number">15</span>, <span class="hl-number">3</span>, <span class="hl-number">4</span>, <span class="hl-number">5</span>));</pre>
                  
                  <p></p>
                  
               </div>
               
            </div>
            
            
            <div class="chapter" title="Chapter&nbsp;8.&nbsp;单元测试">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d5e1384"></a>Chapter&nbsp;8.&nbsp;单元测试
                        </h2>
                     </div>
                  </div>
               </div>
               
               
               
               <p>平台基于JUnit4进行单元测试，封装了TestCaseBase，它完成了所有spring配置文件的加载，并提供了多线程单元测试的支持（依赖ctp_core/ext/lib/GroboUtils-5-core.jar）。</p>
               
               
               <p>示例如下</p>
               
               <pre class="programlisting"><span class="hl-keyword">package</span> com.seeyon.ctp.common.lock.manager;

<span class="hl-keyword">import</span> <span class="hl-keyword">static</span> org.junit.Assert.assertEquals;
<span class="hl-keyword">import</span> <span class="hl-keyword">static</span> org.junit.Assert.assertFalse;
<span class="hl-keyword">import</span> <span class="hl-keyword">static</span> org.junit.Assert.assertNotNull;
<span class="hl-keyword">import</span> <span class="hl-keyword">static</span> org.junit.Assert.assertNull;
<span class="hl-keyword">import</span> <span class="hl-keyword">static</span> org.junit.Assert.assertTrue;

<span class="hl-keyword">import</span> org.junit.After;
<span class="hl-keyword">import</span> org.junit.AfterClass;
<span class="hl-keyword">import</span> org.junit.Before;
<span class="hl-keyword">import</span> org.junit.Test;

<span class="hl-keyword">import</span> com.seeyon.ctp.common.AppContext;
<span class="hl-keyword">import</span> com.seeyon.ctp.common.lock.po.Lock;
<span class="hl-keyword">import</span> com.seeyon.ctp.common.test.TestCaseBase;

<span class="hl-doctype">/**
 * 锁组件Manager单元测试。
 * @author wangwenyou
 *
 */</span>
<span class="hl-keyword">public</span> <span class="hl-keyword">class</span> LockManagerTest <span class="hl-keyword">extends</span> TestCaseBase<a name="unittest_sample_1"></a><img src="resources/callouts/1.png" alt="1" border="0"> {
    <span class="hl-keyword">private</span> <span class="hl-keyword">static</span> LockManager manager;
    <span class="hl-keyword">private</span> <span class="hl-keyword">static</span> <span class="hl-keyword">long</span>        ownerId    = <span class="hl-number">1234l</span>;
    <span class="hl-keyword">private</span> <span class="hl-keyword">static</span> <span class="hl-keyword">long</span>        guest      = <span class="hl-number">1235l</span>;
    <span class="hl-keyword">private</span> <span class="hl-keyword">static</span> <span class="hl-keyword">long</span>        resourceId = <span class="hl-number">23456l</span>;
    <span class="hl-keyword">private</span> <span class="hl-keyword">static</span> <span class="hl-keyword">int</span>         action     = <span class="hl-number">34</span>;
    <span class="hl-keyword">private</span> <span class="hl-keyword">static</span> String      module     = <span class="hl-string">"testLock"</span>;
    @Before<a name="unittest_sample_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> setUp() <span class="hl-keyword">throws</span> Exception {
        manager = (LockManager) AppContext.getBean(<span class="hl-string">"testLock"</span>);
    }

    @After<a name="unittest_sample_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> tearDown() <span class="hl-keyword">throws</span> Exception {
        manager.unlock(ownerId, resourceId, action);
        manager.unlock(resourceId);
    }

    <span class="hl-annotation">@AfterClass</span>
    <span class="hl-keyword">public</span> <span class="hl-keyword">static</span> <span class="hl-keyword">void</span> afterClass() {

    }

    @Test<a name="unittest_sample_4"></a><img src="resources/callouts/4.png" alt="4" border="0">
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> testLockLongLong() {
        assertTrue(manager.check(guest, resourceId));
        assertTrue(manager.lock(ownerId, resourceId));
        assertFalse(manager.lock(guest, resourceId));
        assertTrue(manager.check(ownerId, resourceId));
        assertFalse(manager.check(guest, resourceId));
    }
    <span class="hl-annotation">@Test</span>
    <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> testEvalString() <span class="hl-keyword">throws</span> Exception {
        <span class="hl-comment">// 构造一个Runner</span>
        TestRunnable runner = <span class="hl-keyword">new</span> TestRunnable()<a name="unittest_sample_5"></a><img src="resources/callouts/5.png" alt="5" border="0"> {
            <span class="hl-annotation">@Override</span>
            <span class="hl-keyword">public</span> <span class="hl-keyword">void</span> runTest() <span class="hl-keyword">throws</span> Throwable {
                <span class="hl-comment">// 测试内容</span>
                <span class="hl-keyword">long</span> start = System.currentTimeMillis();
                <span class="hl-keyword">try</span> {
                    assertEquals(evaluator.evalString(<span class="hl-string">"$x+${y}"</span>, context), <span class="hl-string">"1+2"</span>);
                } <span class="hl-keyword">catch</span> (ScriptException e) {
                    fail(e.getMessage());
                }

                <span class="hl-keyword">long</span> end = System.currentTimeMillis();
                System.out.println(Thread.currentThread().getId() + <span class="hl-string">" cost "</span> + (end-start) + <span class="hl-string">" ms!"</span>);

            }
        };
        execute(runner,runnerCount, TimeUnit.SECONDS.toMillis(<span class="hl-number">3</span>));<a name="unittest_sample_6"></a><img src="resources/callouts/6.png" alt="6" border="0">

    }
}</pre>
               
               <div class="calloutlist">
                  <table border="0" summary="Callout list">
                     <tr>
                        <td width="5%" valign="top" align="left">
                           <p><a href="#unittest_sample_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                           </p>
                        </td>
                        <td valign="top" align="left">
                           
                           <p>单元测试均需继承TestCaseBase。</p>
                           
                        </td>
                     </tr>
                     <tr>
                        <td width="5%" valign="top" align="left">
                           <p><a href="#unittest_sample_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                           </p>
                        </td>
                        <td valign="top" align="left">
                           
                           <p>@Before，初始化方法，在每一个测试方法执行前均会执行。</p>
                           
                        </td>
                     </tr>
                     <tr>
                        <td width="5%" valign="top" align="left">
                           <p><a href="#unittest_sample_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                           </p>
                        </td>
                        <td valign="top" align="left">
                           
                           <p>@After，在每一个测试方法执行后均会执行，可用于清理或释放资源。</p>
                           
                        </td>
                     </tr>
                     <tr>
                        <td width="5%" valign="top" align="left">
                           <p><a href="#unittest_sample_4"><img src="resources/callouts/4.png" alt="4" border="0"></a> 
                           </p>
                        </td>
                        <td valign="top" align="left">
                           
                           <p>@Test，要进行单元测试的方法。</p>
                           
                        </td>
                     </tr>
                     <tr>
                        <td width="5%" valign="top" align="left">
                           <p><a href="#unittest_sample_5"><img src="resources/callouts/5.png" alt="5" border="0"></a> 
                           </p>
                        </td>
                        <td valign="top" align="left">
                           
                           <p>这是一个多线程的示例</p>
                           
                        </td>
                     </tr>
                     <tr>
                        <td width="5%" valign="top" align="left">
                           <p><a href="#unittest_sample_6"><img src="resources/callouts/6.png" alt="6" border="0"></a> 
                           </p>
                        </td>
                        <td valign="top" align="left">
                           
                           <p>执行多线程测试，参数依次为TestRunner实例、并发个数、超时时间。</p>
                           
                        </td>
                     </tr>
                  </table>
               </div>
               
               
               <p></p>
               
            </div>
            
         </div>
         
         
         <div class="part" title="Part&nbsp;IV.&nbsp;CTP前端开发手册">
            <div class="titlepage">
               <div>
                  <div>
                     <h1 class="title"><a name="d5e1409"></a>Part&nbsp;IV.&nbsp;CTP前端开发手册
                     </h1>
                  </div>
               </div>
            </div>
            <div class="toc">
               <p><b>Table of Contents</b></p>
               <dl>
                  <dt><span class="chapter"><a href="#d5e1411">9. 概述</a></span></dt>
                  <dt><span class="chapter"><a href="#d5e1460">10. Ajax</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d5e1463">10.1. 概述</a></span></dt>
                        <dt><span class="section"><a href="#d5e1466">10.2. 开发步骤</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e1469">10.2.1. Manager层实现</a></span></dt>
                              <dt><span class="section"><a href="#d5e1472">10.2.2. 前端调用</a></span></dt>
                              <dt><span class="section"><a href="#d5e1493">10.2.3. 类型映射</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e1543">10.3. 实例</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d5e1546">11. Form开发规范</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d5e1548">11.1. Form布局规范</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e1551">11.1.1. 左树右表下编辑</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e1561">11.2. Form校验</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e1653">11.2.1. 实例</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e1656">11.3. Form回填</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e1694">11.3.1. 实例</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e1697">11.4. Form提交</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e1786">11.4.1. 实例</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e1789">11.5. 表单数据清除</a></span></dt>
                        <dt><span class="section"><a href="#d5e1794">11.6. 表单控件批量禁用/启用</a></span></dt>
                        <dt><span class="section"><a href="#d5e1799">11.7. 按钮级资源权限控制</a></span></dt>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d5e1810">12. 基础组件</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d5e1812">12.1. 基础控件库</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e1815">12.1.1. 按钮</a></span></dt>
                              <dt><span class="section"><a href="#d5e1824">12.1.2. 单选</a></span></dt>
                              <dt><span class="section"><a href="#d5e1832">12.1.3. 复选</a></span></dt>
                              <dt><span class="section"><a href="#d5e1840">12.1.4. 进度条</a></span></dt>
                              <dt><span class="section"><a href="#d5e1847">12.1.5. 页签</a></span></dt>
                              <dt><span class="section"><a href="#d5e1886">12.1.6. 文本框</a></span></dt>
                              <dt><span class="section"><a href="#d5e1894">12.1.7. 下拉列表</a></span></dt>
                              <dt><span class="section"><a href="#d5e1903">12.1.8. 链接</a></span></dt>
                              <dt><span class="section"><a href="#d5e1913">12.1.9. 搜索框</a></span></dt>
                              <dt><span class="section"><a href="#d5e1922">12.1.10. 面包屑</a></span></dt>
                              <dt><span class="section"><a href="#d5e1930">12.1.11. 提示消息</a></span></dt>
                              <dt><span class="section"><a href="#d5e2023">12.1.12. Dialog组件</a></span></dt>
                              <dt><span class="section"><a href="#d5e2076">12.1.13. Layout组件</a></span></dt>
                              <dt><span class="section"><a href="#d5e2106">12.1.14. Toolbar组件</a></span></dt>
                              <dt><span class="section"><a href="#d5e2129">12.1.15. Menu组件</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e2157">12.2. 表格组件</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e2211">12.2.1. 实例</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e2214">12.3. 树组件</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e2312">12.3.1. 实例</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e2315">12.4. 日期选择组件</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e2329">12.4.1. 实例</a></span></dt>
                           </dl>
                        </dd>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d5e2332">13. 功能组件</a></span></dt>
                  <dd>
                     <dl>
                        <dt><span class="section"><a href="#d5e2334">13.1. 枚举组件</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e2362">13.1.1. 实例</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e2365">13.2. 选人组件</a></span></dt>
                        <dt><span class="section"><a href="#d5e2400">13.3. 文件管理组件</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e2407">13.3.1. 应用范围</a></span></dt>
                              <dt><span class="section"><a href="#d5e2413">13.3.2. 附件管理</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e2600">13.4. 正文编辑器</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e2609">13.4.1. 定义</a></span></dt>
                           </dl>
                        </dd>
                        <dt><span class="section"><a href="#d5e2616">13.5. 元数据组件</a></span></dt>
                        <dd>
                           <dl>
                              <dt><span class="section"><a href="#d5e2622">13.5.1. 功能</a></span></dt>
                              <dt><span class="section"><a href="#d5e2640">13.5.2. 开发步骤</a></span></dt>
                           </dl>
                        </dd>
                     </dl>
                  </dd>
                  <dt><span class="chapter"><a href="#d5e2662">14. 单元测试</a></span></dt>
                  <dt><span class="chapter"><a href="#d5e2679">15. JavaScript优化技巧</a></span></dt>
                  <dt><span class="chapter"><a href="#d5e2710">16. JavaScript优化技巧</a></span></dt>
               </dl>
            </div>
            
            
            
            <div class="chapter" title="Chapter&nbsp;9.&nbsp;概述">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d5e1411"></a>Chapter&nbsp;9.&nbsp;概述
                        </h2>
                     </div>
                  </div>
               </div>
               
               
               
               <p>前端开发必须严格按照规范所规定的模式放置文件和命名</p>
               
               
               <p>以开发协同（collaboration）的待办列表（listPending）页面为例，需要在协同模块的Project建立以下文件，完整的示例请通过svn从ctp_pub/project_template获取</p>
               
               
               <div class="orderedlist">
                  <ol class="orderedlist" type="1">
                     <li class="listitem">
                        
                        <p>页面jsp文件</p>
                        
                        
                        <p>WebContent/WEB-INF/jsp/apps/collaboration/listPending.jsp</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>模块公开js文件</p>
                        
                        
                        <p>WebContent/common/js/pub/collaboration/collaboration_pub.js</p>
                        
                     </li>
                  </ol>
               </div>
               
               
               <p>目录结构为</p>
               
               <pre class="programlisting">src
    com
        seeyon
            apps
                collaboration
                    CollaborationController.java<a name="client_dir_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
                    CollaborationManager.java<a name="client_dir_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
                    CollaborationManagerImpl.java
                    CollaborationDao.java<a name="client_dir_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
                    CollaborationDaoImpl.java
                    po
                        ColSummaryPO.java<a name="client_dir_4"></a><img src="resources/callouts/4.png" alt="4" border="0">
                        ColSummary.hbm.xml<a name="client_dir_5"></a><img src="resources/callouts/5.png" alt="5" border="0">
WebContent
    common
        js
            pub
                collaboration
                    collaboration_pub.js<a name="client_dir_9"></a><img src="resources/callouts/6.png" alt="6" border="0">
    WEB-INF
        jsp
            apps
                collaboration
                    listPending.jsp<a name="client_dir_10"></a><img src="resources/callouts/7.png" alt="7" border="0">
        </pre>
               
               <div class="calloutlist">
                  <table border="0" summary="Callout list">
                     <tr>
                        <td width="5%" valign="top" align="left">
                           <p><a href="#client_dir_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                           </p>
                        </td>
                        <td valign="top" align="left">
                           
                           <p>MVC Controller</p>
                           
                        </td>
                     </tr>
                     <tr>
                        <td width="5%" valign="top" align="left">
                           <p><a href="#client_dir_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                           </p>
                        </td>
                        <td valign="top" align="left">
                           
                           <p>MVC Manager</p>
                           
                        </td>
                     </tr>
                     <tr>
                        <td width="5%" valign="top" align="left">
                           <p><a href="#client_dir_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                           </p>
                        </td>
                        <td valign="top" align="left">
                           
                           <p>MVC DAO</p>
                           
                        </td>
                     </tr>
                     <tr>
                        <td width="5%" valign="top" align="left">
                           <p><a href="#client_dir_4"><img src="resources/callouts/4.png" alt="4" border="0"></a> 
                           </p>
                        </td>
                        <td valign="top" align="left">
                           
                           <p>PO，模块内全部PO都建在此包下平铺放置</p>
                           
                        </td>
                     </tr>
                     <tr>
                        <td width="5%" valign="top" align="left">
                           <p><a href="#client_dir_5"><img src="resources/callouts/5.png" alt="5" border="0"></a> 
                           </p>
                        </td>
                        <td valign="top" align="left">
                           
                           <p>Hibernate映射文件，对于Hibernate的Named Query的HQL配置文件可以建子包</p>
                           
                        </td>
                     </tr>
                     <tr>
                        <td width="5%" valign="top" align="left">
                           <p><a href="#client_dir_9"><img src="resources/callouts/6.png" alt="6" border="0"></a> 
                           </p>
                        </td>
                        <td valign="top" align="left">
                           
                           <p>协同模块公共js文件</p>
                           
                        </td>
                     </tr>
                     <tr>
                        <td width="5%" valign="top" align="left">
                           <p><a href="#client_dir_10"><img src="resources/callouts/7.png" alt="7" border="0"></a> 
                           </p>
                        </td>
                        <td valign="top" align="left">
                           
                           <p>协同列表前端jsp文件</p>
                           
                        </td>
                     </tr>
                  </table>
               </div>
               
               
               <p></p>
               
               
               <p>listPending.jsp</p>
               
               <pre class="programlisting"><span class="hl-tag">&lt;%--</span>
 <span class="hl-attribute">$Author:</span>  <span class="hl-attribute">$</span>
 <span class="hl-attribute">$Rev:</span>  <span class="hl-attribute">$</span>
 <span class="hl-attribute">$Date::</span> <span class="hl-attribute">#$:</span>
  
 <span class="hl-attribute">Copyright</span> <span class="hl-attribute">(C)</span> <span class="hl-attribute">2012</span> <span class="hl-attribute">Seeyon,</span> <span class="hl-attribute">Inc.</span> <span class="hl-attribute">All</span> <span class="hl-attribute">rights</span> <span class="hl-attribute">reserved.</span>
 <span class="hl-attribute">This</span> <span class="hl-attribute">software</span> <span class="hl-attribute">is</span> <span class="hl-attribute">the</span> <span class="hl-attribute">proprietary</span> <span class="hl-attribute">information</span> <span class="hl-attribute">of</span> <span class="hl-attribute">Seeyon,</span> <span class="hl-attribute">Inc.</span>
 <span class="hl-attribute">Use</span> <span class="hl-attribute">is</span> <span class="hl-attribute">subject</span> <span class="hl-attribute">to</span> <span class="hl-attribute">license</span> <span class="hl-attribute">terms.</span>
<span class="hl-attribute">--%&gt;</span><a name="client_jsp_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
<span class="hl-tag">&lt;%@</span> <span class="hl-attribute">page</span> <span class="hl-attribute">contentType</span>=<span class="hl-value">"text/html; charset=utf-8"</span> <span class="hl-attribute">isELIgnored</span>=<span class="hl-value">"false"</span><span class="hl-attribute">%&gt;</span>
<span class="hl-attribute">&lt;%@</span> <span class="hl-attribute">include</span> <span class="hl-attribute">file</span>=<span class="hl-value">"/WEB-INF/jsp/common/common.jsp"</span><span class="hl-attribute">%&gt;</span><a name="client_jsp_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
<span class="hl-tag">&lt;html&gt;</span>
    <span class="hl-tag">&lt;head&gt;</span>
        <span class="hl-tag">&lt;title&gt;</span><span class="hl-tag">&lt;/title&gt;</span>
        <span class="hl-tag">&lt;script</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text/javascript"</span><span class="hl-tag">&gt;</span>
            $(function() {<a name="client_jsp_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
            });
        <span class="hl-tag">&lt;/script&gt;</span>
    <span class="hl-tag">&lt;/head&gt;</span>
    <span class="hl-tag">&lt;body&gt;</span>
        
    <span class="hl-tag">&lt;/body&gt;</span>
<span class="hl-tag">&lt;/html&gt;</span></pre><p> </p>
               <div class="calloutlist">
                  <table border="0" summary="Callout list">
                     <tr>
                        <td width="5%" valign="top" align="left">
                           <p><a href="#client_jsp_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                           </p>
                        </td>
                        <td valign="top" align="left">
                           
                           <p>统一JSP文件头注释</p>
                           
                        </td>
                     </tr>
                     <tr>
                        <td width="5%" valign="top" align="left">
                           <p><a href="#client_jsp_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                           </p>
                        </td>
                        <td valign="top" align="left">
                           
                           <p>统一JSP文件include框架公共jsp</p>
                           
                        </td>
                     </tr>
                     <tr>
                        <td width="5%" valign="top" align="left">
                           <p><a href="#client_jsp_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                           </p>
                        </td>
                        <td valign="top" align="left">
                           
                           <p>jquery的文档加载完成后的脚本执行区，里面的javascript脚本将在页面完全加载后执行</p>
                           
                        </td>
                     </tr>
                  </table>
               </div>
               
            </div>
            
            
            <div class="chapter" title="Chapter&nbsp;10.&nbsp;Ajax">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d5e1460"></a>Chapter&nbsp;10.&nbsp;Ajax
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Table of Contents</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d5e1463">10.1. 概述</a></span></dt>
                     <dt><span class="section"><a href="#d5e1466">10.2. 开发步骤</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e1469">10.2.1. Manager层实现</a></span></dt>
                           <dt><span class="section"><a href="#d5e1472">10.2.2. 前端调用</a></span></dt>
                           <dt><span class="section"><a href="#d5e1493">10.2.3. 类型映射</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e1543">10.3. 实例</a></span></dt>
                  </dl>
               </div>
               
               
               
               <p></p>
               
               
               <div class="section" title="10.1.&nbsp;概述">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1463"></a>10.1.&nbsp;概述
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>延续A8的AJAX一些特性，支持在JS中直接调用Manager层的方法，不过不需要特别的配置。</p>
                  
               </div>
               
               
               <div class="section" title="10.2.&nbsp;开发步骤">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1466"></a>10.2.&nbsp;开发步骤
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p></p>
                  
                  
                  <div class="section" title="10.2.1.&nbsp;Manager层实现">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1469"></a>10.2.1.&nbsp;Manager层实现
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>实现并在Spring中注册普通的Manager即可。</p>
                     
                  </div>
                  
                  
                  <div class="section" title="10.2.2.&nbsp;前端调用">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1472"></a>10.2.2.&nbsp;前端调用
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <p>设置AJAX为异步调用，一般都使用这项，如需同步调用，需特别申请。</p>
                     
                     <pre class="programlisting">&lt;script type=<span class="hl-string">"text/javascript"</span> src=<span class="hl-string">"${path}/ajax.do?managerName=</span><em class="replaceable"><code>testBS</code></em><span class="hl-string">"&gt;&lt;/script&gt;</span><a name="ajax_sample1_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
$().ready(
    <span class="hl-keyword">function</span>() {
        <span class="hl-keyword">var</span> tBS = <span class="hl-keyword">new</span> testBS();<a name="ajax_sample1_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
        <span class="hl-keyword">var</span> ajaxTestBean = <span class="hl-keyword">new</span> <span class="hl-keyword">Object</span>();
        ajaxTestBean[<span class="hl-string">"str1"</span>] = <span class="hl-string">"111"</span>;
        ajaxTestBean[<span class="hl-string">"str2"</span>] = [<span class="hl-string">"222"</span>, <span class="hl-string">"333"</span>];                    
        tBS.testAjaxBean2(ajaxTestBean, {
            success: <span class="hl-keyword">function</span>(){
                alert(ajaxTestBean.str1);
                alert(ajaxTestBean.str2[<span class="hl-number">0</span>]);
                alert(ajaxTestBean.str2[<span class="hl-number">1</span>]);
            }
        };<a name="ajax_sample1_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
        <span class="hl-keyword">var</span> rtVal = tBS.testAjaxBean2(ajaxTestBean);<a name="ajax_sample1_4"></a><img src="resources/callouts/4.png" alt="4" border="0">
    }
);</pre>
                     
                     <div class="calloutlist">
                        <table border="0" summary="Callout list">
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#ajax_sample1_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>引入Manager的动态Javascript，其中testBS为Spring中注册的bean
                                    id，要使用多个manager做ajax操作可将多个bean id之间用逗号分隔
                                 </p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#ajax_sample1_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>构建Manager对象，其中testBS为Spring中注册的bean id，注意变量名不能和bean
                                    id重名
                                 </p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#ajax_sample1_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>调用Manager方法，参数个数和数据类型需与Manager实现保持一致（符合javascript和java之间的类型映射规则），最后增加回调参数时</p>
                                 
                                 
                                 <p>则视为异步ajax调用方式</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#ajax_sample1_4"><img src="resources/callouts/4.png" alt="4" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>方法调用最后不增加回调参数，则视为同步调用，可直接取得ajax返回值（虽然简单，但不建议采用，因为同步调用操作时间长会造成</p>
                                 
                                 
                                 <p>浏览器锁死）</p>
                                 
                              </td>
                           </tr>
                        </table>
                     </div>
                     
                  </div>
                  
                  
                  <div class="section" title="10.2.3.&nbsp;类型映射">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1493"></a>10.2.3.&nbsp;类型映射
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="itemizedlist">
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>JavaScript参数映射到Java参数类型</p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     <div class="informaltable">
                        
                        <table border="1">
                           <colgroup>
                              <col align="center" width="50%">
                              <col width="50%">
                           </colgroup>
                           <thead>
                              <tr>
                                 <th align="center">JavaScript类型</th>
                                 <th align="center">Java类型</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr>
                                 <td align="center">数组</td>
                                 <td>数组，List</td>
                              </tr>
                              <tr>
                                 <td align="center">对象</td>
                                 <td>Map，JavaBean</td>
                              </tr>
                              <tr>
                                 <td align="center">字符串</td>
                                 <td>String</td>
                              </tr>
                              <tr>
                                 <td align="center">数值</td>
                                 <td>int、long、double、float或封装数据类型</td>
                              </tr>
                           </tbody>
                        </table>
                              
                     </div>
                     
                     
                     <p></p>
                     
                     
                     <div class="itemizedlist">
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>Java返回值映射JavaScript类型</p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     <div class="informaltable">
                        
                        <table border="1">
                           <colgroup>
                              <col align="center" width="50%">
                              <col width="50%">
                           </colgroup>
                           <thead>
                              <tr>
                                 <th align="center">Java类型</th>
                                 <th align="center">JavaScript类型</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr>
                                 <td align="center">数组、List</td>
                                 <td>数组</td>
                              </tr>
                              <tr>
                                 <td align="center">Map</td>
                                 <td>对象</td>
                              </tr>
                              <tr>
                                 <td align="center">JavaBean</td>
                                 <td>对象</td>
                              </tr>
                              <tr>
                                 <td align="center">基本数据类型（String、int、long、double、float）和封装数据类型</td>
                                 <td>变量</td>
                              </tr>
                           </tbody>
                        </table>
                              
                     </div>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="10.3.&nbsp;实例">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1543"></a>10.3.&nbsp;实例
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>请参考：http://[host]:[port]/[context]/samples/test.do?method=testAjax</p>
                  
               </div>
               
            </div>
            
            
            <div class="chapter" title="Chapter&nbsp;11.&nbsp;Form开发规范">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d5e1546"></a>Chapter&nbsp;11.&nbsp;Form开发规范
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Table of Contents</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d5e1548">11.1. Form布局规范</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e1551">11.1.1. 左树右表下编辑</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e1561">11.2. Form校验</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e1653">11.2.1. 实例</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e1656">11.3. Form回填</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e1694">11.3.1. 实例</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e1697">11.4. Form提交</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e1786">11.4.1. 实例</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e1789">11.5. 表单数据清除</a></span></dt>
                     <dt><span class="section"><a href="#d5e1794">11.6. 表单控件批量禁用/启用</a></span></dt>
                     <dt><span class="section"><a href="#d5e1799">11.7. 按钮级资源权限控制</a></span></dt>
                  </dl>
               </div>
               
               
               
               <div class="section" title="11.1.&nbsp;Form布局规范">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1548"></a>11.1.&nbsp;Form布局规范
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p></p>
                  
                  
                  <div class="section" title="11.1.1.&nbsp;左树右表下编辑">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1551"></a>11.1.1.&nbsp;左树右表下编辑
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/layout_formall_l_r_demo.jpg"></div>
                     
                     
                     <p></p>
                     
                     
                     <div class="section" title="11.1.1.1.&nbsp;实例">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d5e1558"></a>11.1.1.1.&nbsp;实例
                                 </h4>
                              </div>
                           </div>
                        </div>
                        
                        
                        
                        <p>请参考：http://[host]:[port]/[context]/samples/layout.do?method=formall_l_r_demo</p>
                        
                     </div>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="11.2.&nbsp;Form校验">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1561"></a>11.2.&nbsp;Form校验
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>属性</p>
                  
                  
                  <p>如要校验某种类型，要求input存在class为validate，并具备validate属性进行校验规则配置，validate属性值的格式要求是json对象定义字符串(不含</p>
                  
                  
                  <p>大括号)。</p>
                  
                  
                  <p>例如：</p>
                  
                  <pre class="programlisting"><span class="hl-tag">&lt;input</span> <span class="hl-attribute">name</span>=<span class="hl-value">"username"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"validate"</span> <span class="hl-attribute">validate</span>=<span class="hl-value">"</span><span class="emphasis"><em>type:'string',maxLength:20,minLength:6</em></span>"/&gt; </pre>
                  
                  <p>在调用jquery扩展插件的formobj、jsonSubmit或validate方法时，会执行校验过程，例如：</p>
                  
                  <pre class="programlisting">$(<span class="hl-string">"#validDomain"</span>).jsonSubmit(); 
$(<span class="hl-string">"#validDomain"</span>).formobj();
$(<span class="hl-string">"#validDomain"</span>).validate();
</pre><p>以下所说的属性，全部都是json字符串的属性。</p>
                  
                  
                  <p>主属性是验证某一个类型必须存在的属性，副属性可选，不是必须存在的属性。</p>
                  
                  
                  <p>目前一共可以验证13种类型，再加上最后一种给定自定义正则表达式的自定义验证类型。</p>
                  
                  
                  <p>name属性或displayName在显示错误信息的时候要用到，但是也可以选择不给出（此时作为输入框的name属性必须存在）</p>
                  
                  
                  <div class="table"><a name="d5e1576"></a><p class="title"><b>Table&nbsp;11.1.&nbsp;Form校验规则</b></p>
                     <div class="table-contents">
                        
                        
                        
                        <table summary="Form校验规则" border="1">
                           <colgroup>
                              <col width="33%">
                              <col width="33%">
                              <col width="34%">
                           </colgroup>
                           <tbody>
                              <tr>
                                 <td>类型</td>
                                 <td>主属性和可选值</td>
                                 <td>副属性和可选值（空白表示无）</td>
                              </tr>
                              <tr>
                                 <td>1、非空</td>
                                 <td>notNull=true或nullable=true</td>
                                 <td class="auto-generated">&nbsp;</td>
                              </tr>
                              <tr>
                                 <td>2、包含空格的非空</td>
                                 <td>notNullWithoutTrim=true</td>
                                 <td class="auto-generated">&nbsp;</td>
                              </tr>
                              <tr>
                                 <td>3、数字（小数）</td>
                                 <td>isNumber=true或type=number或type=1或type=2</td>
                                 <td>max或maxValue（必须是数字，如果两个都给出，只使用前者）
                                    min或minValue（必须是数字，如果两个都给出，只使用前者） integerDigits整数位-数（必须是数字）
                                    decimalDigits或dotNumber小数位数（必须是数字，如果两个都给出，只使用前者）
                                 </td>
                              </tr>
                              <tr>
                                 <td>4、数字（整形）</td>
                                 <td>isInteger=true</td>
                                 <td>max或maxValue（必须是数字，如果两个都给出，只使用前者）
                                    min或minValue（必须是数字，如果两个都给出，只使用前者）
                                 </td>
                              </tr>
                              <tr>
                                 <td>5、电子邮件</td>
                                 <td>isEmail=true或type=email</td>
                                 <td class="auto-generated">&nbsp;</td>
                              </tr>
                              <tr>
                                 <td>6、字符串</td>
                                 <td>isWord=true或type=string或type=8或type=9</td>
                                 <td>character=，将所有你认为是特殊字符的字符放进去，例如character=!@#$%^*()。
                                    （如果特殊字符中存在中划线-的话，必须放在第一个）（如果特殊字符中存在脱字符^的话，必须不能放在第一个）
                                 </td>
                              </tr>
                              <tr>
                                 <td>7、不允许为默认值</td>
                                 <td>isDeaultValue=true、deaultValue=一个给定的值</td>
                                 <td class="auto-generated">&nbsp;</td>
                              </tr>
                              <tr>
                                 <td>8、固定电话号码</td>
                                 <td>type=telephone</td>
                                 <td class="auto-generated">&nbsp;</td>
                              </tr>
                              <tr>
                                 <td>9、手机号码</td>
                                 <td>type=mobilePhone</td>
                                 <td class="auto-generated">&nbsp;</td>
                              </tr>
                              <tr>
                                 <td>10、日期类型（要求格式：yyyy-MM-dd）</td>
                                 <td>type=3</td>
                                 <td class="auto-generated">&nbsp;</td>
                              </tr>
                              <tr>
                                 <td>11、日期时间类型（要求格式：yyyy-MM-dd HH:mm:ss）</td>
                                 <td>type=4</td>
                                 <td class="auto-generated">&nbsp;</td>
                              </tr>
                              <tr>
                                 <td>12、最大长度</td>
                                 <td>maxLength=一个数字</td>
                                 <td class="auto-generated">&nbsp;</td>
                              </tr>
                              <tr>
                                 <td>13、最小长度</td>
                                 <td>minLength=一个数字</td>
                                 <td class="auto-generated">&nbsp;</td>
                              </tr>
                              <tr>
                                 <td>14、自定义正则表达式</td>
                                 <td>regExp=一个自定义的正则表达式，例如/[\d+]/</td>
                                 <td class="auto-generated">&nbsp;</td>
                              </tr>
                              <tr>
                                 <td>15、自定义校验函数</td>
                                 <td>主属性：func=一个自己定义的函数（必须是全局函数，可以是匿名函数）
                                    （该函数可以没有返回值（js中没有返回值的话默认为null），返回null或false表示校验未通过）
                                 </td>
                                 <td class="auto-generated">&nbsp;</td>
                              </tr>
                              <tr>
                                 <td>16、自定义错误提示</td>
                                 <td>主属性：errorMsg=一个字符串，例如:请输入数字！</td>
                                 <td class="auto-generated">&nbsp;</td>
                              </tr>
                              <tr>
                                 <td>17、js设置校验规则</td>
                                 <td>请看下方的MxtCheckMsg方法</td>
                                 <td class="auto-generated">&nbsp;</td>
                              </tr>
                           </tbody>
                        </table>
                        
                     </div>
                  </div>
                  <p><br class="table-break"></p>
                  
                  
                  <p></p>
                  
                  
                  <div class="section" title="11.2.1.&nbsp;实例">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1653"></a>11.2.1.&nbsp;实例
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>请参考：http://[host]:[port]/[context]/samples/test.do?method=testValidate</p>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="11.3.&nbsp;Form回填">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1656"></a>11.3.&nbsp;Form回填
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>特点/使用方式</p>
                  
                  
                  <p>该组件用于新建、更新功能使用同一个页面，同时减少前端代码写入量。</p>
                  
                  
                  <p>不管是用js填入，还是使用jstl填入，如果手工回填的话，需要书写很多繁琐的代码。</p>
                  
                  
                  <p>例如：</p>
                  
                  
                  <div class="blockquote">
                     <blockquote class="blockquote">
                        
                        <p>如果是一个text，需要设置value属性。</p>
                        
                        
                        <p>如果是一个checkbox或者radio，需要设置checked属性。</p>
                        
                        
                        <p>如果是一个select，需要找到对应的option，设置selected属性。</p>
                        
                     </blockquote>
                  </div>
                  
                  
                  <p>若是我们每一处都写一些这样繁琐的代码，实在是太耗费精力了。</p>
                  
                  
                  <p>自动form回填就是这样一个为大家解决麻烦的组件，使用它，就可以自动为表单元素设置值，而不再需要自己写那些繁琐的js。</p>
                  
                  
                  <p>使用这个组件，大家需要做的就是在前台include一个jsp页面，在后台提供对应数据，然后就不需要再花费多余的心思。</p>
                  
                  
                  <div class="procedure">
                     <ol class="procedure" type="1">
                        <li class="step" title="Step 1">
                           
                           <p>若要使用该功能，前台只需同时也必须引入该文件。</p>
                           
                           <pre class="programlisting"><span class="hl-tag">&lt;%@</span> <span class="hl-attribute">include</span> <span class="hl-attribute">file</span>=<span class="hl-value">"/WEB-INF/jsp/common/common.jsp"</span><span class="hl-attribute">%/&gt;</span> </pre>
                           </li>
                        <li class="step" title="Step 2">
                           
                           <p>这是前台代码示例。</p>
                           
                           
                           <p>里面有两个div（也可以是form），每个div都有几个输入框或checkbox或select
                              注意div的Id和每一个表单元素的Id。 
                           </p>
                           <div class="caution" title="Caution" style="margin-left: 0.5in; margin-right: 0.5in;">
                              <table border="0" summary="Caution">
                                 <tr>
                                    <td rowspan="2" align="center" valign="top" width="25"><img alt="[Caution]" src="resources/admonitions/caution.png"></td>
                                    <th align="left">Caution</th>
                                 </tr>
                                 <tr>
                                    <td align="left" valign="top">
                                       
                                       <p>在同一个容器里，每一个表单元素的Id必须唯一。</p>
                                       
                                    </td>
                                 </tr>
                              </table>
                           </div>
                           
                           <pre class="programlisting"><span class="hl-tag">&lt;div</span> <span class="hl-attribute">id</span>=<span class="hl-value">"area1"</span><span class="hl-tag">&gt;</span>
    用户名：<span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"username"</span><span class="hl-tag">/&gt;</span>
    密码：<span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"userage"</span><span class="hl-tag">/&gt;</span>
    爱好：<span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"checkbox"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"aihao1"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"1"</span><span class="hl-tag">/&gt;</span>(1)<span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"checkbox"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"aihao2"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"2"</span><span class="hl-tag">/&gt;</span>(2)<span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"checkbox"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"aihao3"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"3"</span><span class="hl-tag">/&gt;</span>(3)
    性别：<span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"radio"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"sex1"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"1"</span><span class="hl-tag">/&gt;</span>(男)<span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"radio"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"sex2"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"2"</span><span class="hl-tag">/&gt;</span>(女)
    星级：<span class="hl-tag">&lt;select</span> <span class="hl-attribute">id</span>=<span class="hl-value">"qiuji"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"1"</span><span class="hl-tag">&gt;</span>地球<span class="hl-tag">&lt;/option&gt;</span>
        <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"2"</span><span class="hl-tag">&gt;</span>月球<span class="hl-tag">&lt;/option&gt;</span>
        <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"3"</span><span class="hl-tag">&gt;</span>火星<span class="hl-tag">&lt;/option&gt;</span>
    <span class="hl-tag">&lt;/select&gt;</span>
    实力：<span class="hl-tag">&lt;select</span> <span class="hl-attribute">id</span>=<span class="hl-value">"shili"</span> <span class="hl-attribute">multiple</span>=<span class="hl-value">"true"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"1"</span><span class="hl-tag">&gt;</span>天<span class="hl-tag">&lt;/option&gt;</span>
        <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"2"</span><span class="hl-tag">&gt;</span>地<span class="hl-tag">&lt;/option&gt;</span>
        <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"3"</span><span class="hl-tag">&gt;</span>人<span class="hl-tag">&lt;/option&gt;</span>
    <span class="hl-tag">&lt;/select&gt;</span>
<span class="hl-tag">&lt;/div&gt;</span>
<span class="hl-tag">&lt;div</span> <span class="hl-attribute">id</span>=<span class="hl-value">"area22"</span><span class="hl-tag">&gt;</span>
    用户名：<span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"username"</span><span class="hl-tag">/&gt;</span>
    密码：<span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"userage"</span><span class="hl-tag">/&gt;</span>
    爱好：<span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"checkbox"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"aihao1"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"1"</span><span class="hl-tag">/&gt;</span>(1)<span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"checkbox"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"aihao2"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"2"</span><span class="hl-tag">/&gt;</span>(2)<span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"checkbox"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"aihao3"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"3"</span><span class="hl-tag">/&gt;</span>(3)
    性别：<span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"radio"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"sex1"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"1"</span><span class="hl-tag">/&gt;</span>(男)<span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"radio"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"sex2"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"2"</span><span class="hl-tag">/&gt;</span>(女)
    星级：<span class="hl-tag">&lt;select</span> <span class="hl-attribute">id</span>=<span class="hl-value">"qiuji"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"1"</span><span class="hl-tag">&gt;</span>地球<span class="hl-tag">&lt;/option&gt;</span>
        <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"2"</span><span class="hl-tag">&gt;</span>月球<span class="hl-tag">&lt;/option&gt;</span>
        <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"3"</span><span class="hl-tag">&gt;</span>火星<span class="hl-tag">&lt;/option&gt;</span>
    <span class="hl-tag">&lt;/select&gt;</span>
    实力：<span class="hl-tag">&lt;select</span> <span class="hl-attribute">id</span>=<span class="hl-value">"shili"</span> <span class="hl-attribute">multiple</span>=<span class="hl-value">"true"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"1"</span><span class="hl-tag">&gt;</span>天<span class="hl-tag">&lt;/option&gt;</span>
        <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"2"</span><span class="hl-tag">&gt;</span>地<span class="hl-tag">&lt;/option&gt;</span>
        <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">"3"</span><span class="hl-tag">&gt;</span>人<span class="hl-tag">&lt;/option&gt;</span>
    <span class="hl-tag">&lt;/select&gt;</span>
<span class="hl-tag">&lt;/div&gt;</span>
</pre>
                           </li>
                        <li class="step" title="Step 3">
                           
                           <p>这是后台代码示例。 与前台两个div对应，这里有两个Map。
                              <span class="emphasis"><em>前台有多少个容器，就需要多少个Map</em></span>。
                           </p>
                           
                           
                           <p>每一个Map都必须要通过调用request对象的setAttribute方法，添加到request对象中。</p>
                           
                           
                           <p>调用setAttribute时，key的值必须要<span class="emphasis"><em>以ff开头</em></span>，后面紧跟<span class="emphasis"><em>前台对应的容器Id</em></span>（这里是div的Id）。
                           </p>
                           
                           
                           <p>向Map中put键值对时，key必须是容器中对应的表单元素的Id。</p>
                           
                           
                           <p>如果表单元素是多选（例如checkbox、select），多个值之间用逗号分隔开。</p>
                           
                           <pre class="programlisting">    Map&lt;<span class="hl-keyword">String</span>, <span class="hl-keyword">String</span>&gt; test = <span class="hl-keyword">new</span> HashMap&lt;<span class="hl-keyword">String</span>, <span class="hl-keyword">String</span>&gt;();
    test.put(<span class="hl-string">"username"</span>, <span class="hl-string">"zho'ulj"</span>);
    test.put(<span class="hl-string">"userage"</span>, <span class="hl-string">"16\"'"</span>);
    test.put(<span class="hl-string">"aihao2"</span>, <span class="hl-string">"2"</span>);
    test.put(<span class="hl-string">"aihao3"</span>, <span class="hl-string">"3"</span>);
    test.put(<span class="hl-string">"sex2"</span>, <span class="hl-string">"2"</span>);
    test.put(<span class="hl-string">"qiuji"</span>, <span class="hl-string">"2,3"</span>);
    test.put(<span class="hl-string">"shili"</span>, <span class="hl-string">"1,2,3"</span>);
    request.setAttribute(<span class="hl-string">"ffarea1"</span>, test);
    Map&lt;<span class="hl-keyword">String</span>, <span class="hl-keyword">String</span>&gt; test2 = <span class="hl-keyword">new</span> HashMap&lt;<span class="hl-keyword">String</span>, <span class="hl-keyword">String</span>&gt;();
    test2.put(<span class="hl-string">"username"</span>, <span class="hl-string">"岳不群！"</span>);
    test2.put(<span class="hl-string">"userage"</span>, <span class="hl-string">"16\"'"</span>);
    test2.put(<span class="hl-string">"aihao2"</span>, <span class="hl-string">"2"</span>);
    test2.put(<span class="hl-string">"aihao3"</span>, <span class="hl-string">"3"</span>);
    test2.put(<span class="hl-string">"sex2"</span>, <span class="hl-string">"2"</span>);
    test2.put(<span class="hl-string">"qiuji"</span>, <span class="hl-string">"2,3"</span>);
    test2.put(<span class="hl-string">"shili"</span>, <span class="hl-string">"1,2,3"</span>);
    request.setAttribute(<span class="hl-string">"ffarea22"</span>, test2);</pre>
                           </li>
                        <li class="step" title="Step 4">
                           
                           <p>如果需要对比如Ajax调用返回的数据对象进行手动回填，可以调用jquery插件的fillform方法，例如：</p>
                           
                           <pre class="programlisting">    tBS.testAjaxMethod(param, {success:
           <span class="hl-keyword">function</span>(obj){
              $(<span class="hl-string">"#myform"</span>).fillform(obj);
           }
        });
   </pre>
                           </li>
                     </ol>
                  </div>
                  
                  
                  <p></p>
                  
                  
                  <div class="section" title="11.3.1.&nbsp;实例">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1694"></a>11.3.1.&nbsp;实例
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>请参考：http://[host]:[port]/[context]/samples/test.do?method=testFillForm</p>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="11.4.&nbsp;Form提交">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1697"></a>11.4.&nbsp;Form提交
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>特点/使用方式</p>
                  
                  
                  <p>该组件主要作为CTP平台form提交的标准方式，<span class="emphasis"><em>禁止使用普通的form提交</em></span>。
                  </p>
                  
                  
                  <p>使用该组件可以极大的简化前后台代码的提交和获取参数的方式。</p>
                  
                  
                  <p>使用限制：</p>
                  
                  
                  <div class="orderedlist">
                     <ol class="orderedlist" type="1">
                        <li class="listitem">
                           
                           <p>除radio外，同一个容器（或分区）内表单元素（包括checkbox）不能有相同的name或id。</p>
                           
                        </li>
                        <li class="listitem">
                           
                           <p>select如果是多选的话，后台会转换成List类型的对象。
                              该组件通过jQuery插件的方式提供，调用jsonSubmit方法即可。
                           </p>
                           
                        </li>
                     </ol>
                  </div>
                  
                  
                  <p>主要有四种提交方式（前台），四种获取参数的方式（后台）</p>
                  
                  
                  <p>普通提交（无分区、无分组）、分组提交（无分区）、分区提交（无分组）、分区分组式提交</p>
                  
                  
                  <div class="procedure">
                     <ol class="procedure" type="1">
                        <li class="step" title="Step 1">
                           
                           <p>若要使用该功能，前台只需同时也必须引入该文件。</p>
                           
                           <pre class="programlisting"><span class="hl-tag">&lt;%@</span> <span class="hl-attribute">include</span> <span class="hl-attribute">file</span>=<span class="hl-value">"/WEB-INF/jsp/common/common.jsp"</span><span class="hl-attribute">%/&gt;</span> </pre>
                           </li>
                        <li class="step" title="Step 2">
                           
                           <p>普通提交方式</p>
                           
                           
                           <p>前台调用jsonSubmit方法提交参数。</p>
                           
                           
                           <p>后台调用ParamUtil.getJsonParams()获取参数。</p>
                           
                           
                           <p>getJsonParams方法返回一个Map类型的对象。</p>
                           
                           
                           <p>其key是json对象的属性名，value是json对象的属性值。</p>
                           
                           
                           <p>如果json对象的属性值是一个数组的话，Map的value就是一个List。</p>
                           
                           
                           <p>前台Html</p>
                           
                           <pre class="programlisting"><span class="hl-tag">&lt;form</span> <span class="hl-attribute">id</span>=<span class="hl-value">"form1"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"form1"</span> <span class="hl-attribute">method</span>=<span class="hl-value">"post"</span> <span class="hl-attribute">action</span>=<span class="hl-value">"test.do?method=testJsonSubmit2"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;table&gt;</span>
        <span class="hl-tag">&lt;tbody&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span><span class="hl-tag">&lt;td</span> <span class="hl-attribute">colspan</span>=<span class="hl-value">"2"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;label&gt;</span>表单<span class="hl-tag">&lt;font</span> <span class="hl-attribute">color</span>=<span class="hl-value">"red"</span><span class="hl-tag">&gt;</span>无分区无分组<span class="hl-tag">&lt;/font&gt;</span>提交<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span><span class="hl-tag">&lt;/tr&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>用户名<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"username"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>密码<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"password"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"passwork"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
        <span class="hl-tag">&lt;/tbody&gt;</span>
    <span class="hl-tag">&lt;/table&gt;</span>
<span class="hl-tag">&lt;/form&gt;</span>
</pre>
                           
                           <p>前台js代码：</p>
                           
                           <pre class="programlisting">$(<span class="hl-string">"#form1"</span>).jsonSubmit({debug:false});
参数中的debug属性在正式开发的时候不需要给出，或者需要设置为false；</pre>
                           
                           <p>后台代码：</p>
                           
                           <pre class="programlisting">Map params = ParamUtil.getJsonParams();
<span class="hl-keyword">for</span>(Object entryObj : params.entrySet()){
    <span class="hl-keyword">if</span>(entryObj <span class="hl-keyword">instanceof</span> Map.Entry){
        Map.Entry entry = (Map.Entry)entryObj;
        System.out.println(entry.getKey() + <span class="hl-string">":"</span> + entry.getValue());
    }
}</pre>
                           </li>
                        <li class="step" title="Step 3">
                           
                           <p>分组提交方式</p>
                           
                           
                           <p>所谓的分组，其实就是一个容器内有多个name或id相同的输入框。
                              前台的提交方式与普通方式没有区别，都是调用jsonSubmit方法。
                              后台获取参数的方式有区别，使用ParamUtil.getJsonParamsGroup()方法。
                              getJsonParamsGroup方法返回的是一个List类型的对象。 List中的每一个元素都是一个Map。
                              该Map的内容与getJsonParams返回的Map内容相同。
                           </p>
                           
                           
                           <p>前台Html</p>
                           
                           <pre class="programlisting"><span class="hl-tag">&lt;form</span> <span class="hl-attribute">id</span>=<span class="hl-value">"form4"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"form4"</span> <span class="hl-attribute">method</span>=<span class="hl-value">"post"</span> <span class="hl-attribute">action</span>=<span class="hl-value">"test.do?method=testJsonSubmit4"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;table&gt;</span>
        <span class="hl-tag">&lt;tbody&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span><span class="hl-tag">&lt;td</span> <span class="hl-attribute">colspan</span>=<span class="hl-value">"2"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;label&gt;</span>表单<span class="hl-tag">&lt;font</span> <span class="hl-attribute">color</span>=<span class="hl-value">"red"</span><span class="hl-tag">&gt;</span>无分区分组<span class="hl-tag">&lt;/font&gt;</span>提交<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span><span class="hl-tag">&lt;/tr&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>用户名<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"username"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>密码<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"password"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"passwork"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>用户名<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"username"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>密码<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"password"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"passwork"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">id</span>=<span class="hl-value">"savebtn4"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"button"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"提交paramGroup"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
        <span class="hl-tag">&lt;/tbody&gt;</span>
    <span class="hl-tag">&lt;/table&gt;</span>
<span class="hl-tag">&lt;/form&gt;</span></pre><p>前台js代码：</p>
                           
                           <pre class="programlisting">$(<span class="hl-string">"#form4"</span>).jsonSubmit({debug:false});
参数中的debug属性在正式开发的时候不需要给出，或者需要设置为false；</pre>
                           
                           <p>后台代码：</p>
                           
                           <pre class="programlisting">List groups1 =ParamUtil.getJsonParamsGroup();
<span class="hl-keyword">for</span>(Object o : groups1){
    <span class="hl-keyword">if</span>(o <span class="hl-keyword">instanceof</span> Map){
        Map map = (Map)o;
        <span class="hl-keyword">for</span>(Object entryObj : map.entrySet()){
            <span class="hl-keyword">if</span>(entryObj <span class="hl-keyword">instanceof</span> Map.Entry){
                Map.Entry entry = (Map.Entry)entryObj;
                System.out.println(entry.getKey() + <span class="hl-string">":"</span> + entry.getValue());
            }
        }
    }
}</pre>
                           </li>
                        <li class="step" title="Step 4">
                           
                           <p>分区提交方式：</p>
                           
                           
                           <p>前台的提交方式有区别，方法名不变，都是jsonSubmit方法。
                              不过参数有改变，{domains:["domain31","domain32"],debug:false}
                              多了一个domains属性，其值必须是一个数组，数组中的每一个元素必须是要提交的多个容器的id。
                              后台获取参数的方式也不同了，使用ParamUtil.getJsonDomain("domain31")方法。
                              getJsonDomain方法的参数需要给出前台给出的容器Id。
                              如果有多个domain，必须调用多次getJsonDomain方法来获取到所有的domain。
                              getJsonDomain的返回值也是一个Map。 该Map的内容与getJsonParams返回的Map内容相同。
                           </p>
                           
                           
                           <p></p>
                           
                           
                           <p>前台html：</p>
                           
                           <pre class="programlisting"><span class="hl-tag">&lt;form</span> <span class="hl-attribute">id</span>=<span class="hl-value">"form3"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"form3"</span> <span class="hl-attribute">method</span>=<span class="hl-value">"post"</span> <span class="hl-attribute">action</span>=<span class="hl-value">"test.do?method=testJsonSubmit3"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;table</span> <span class="hl-attribute">id</span>=<span class="hl-value">"domain31"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;tbody&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>用户名<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"username"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>密码<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"password"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"passwork"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
        <span class="hl-tag">&lt;/tbody&gt;</span>
    <span class="hl-tag">&lt;/table&gt;</span>
    <span class="hl-tag">&lt;table</span> <span class="hl-attribute">id</span>=<span class="hl-value">"domain32"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;tbody&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>用户名<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"username"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>密码<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"password"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"passwork"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">id</span>=<span class="hl-value">"savebtn3"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"button"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"提交domain"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
        <span class="hl-tag">&lt;/tbody&gt;</span>
    <span class="hl-tag">&lt;/table&gt;</span>
<span class="hl-tag">&lt;/form&gt;</span></pre><p>前台js代码：</p>
                           
                           <pre class="programlisting">$("#form4").jsonSubmit({domains:["domain31","domain32"],debug:false});
参数中的debug属性在正式开发的时候不需要给出，或者需要设置为false；
domains属性值必须是一个数组，数组中的每一个元素必须要要提交的多个容器的id。</pre><p>后台代码：</p>
                           
                           <pre class="programlisting">Map domain1 =ParamUtil.getJsonDomain(<span class="hl-string">"domain31"</span>);
<span class="hl-keyword">for</span>(Object entryObj : domain1.entrySet()){
    <span class="hl-keyword">if</span>(entryObj <span class="hl-keyword">instanceof</span> Map.Entry){
        Map.Entry entry = (Map.Entry)entryObj;
        System.out.println(entry.getKey() + <span class="hl-string">":"</span> + entry.getValue());
    }
}
Map domain2 =ParamUtil.getJsonDomain(<span class="hl-string">"domain32"</span>);
<span class="hl-keyword">for</span>(Object entryObj : domain2.entrySet()){
    <span class="hl-keyword">if</span>(entryObj <span class="hl-keyword">instanceof</span> Map.Entry){
        Map.Entry entry = (Map.Entry)entryObj;
        System.out.println(entry.getKey() + <span class="hl-string">":"</span> + entry.getValue());
    }
}</pre>
                           
                           <p></p>
                           
                        </li>
                        <li class="step" title="Step 5">
                           
                           <p>分区分组式提交</p>
                           
                           
                           <p>这种方式其实是前面两种方式的组合： 分区分组是提交，首先是分区是提交。 每个分区中，可能存在分组，也可能不存在分组。
                              前台的提交方式与分区式提交相同，都是jsonSubmit方法。
                              参数也相同，都是{domains:["domain31","domain32"],debug:false}
                              多了一个domains属性，其值必须是一个数组，数组中的每一个元素必须是要提交的多个容器的id。
                              对于存在分组的分区，后台获取参数的方式:List groups1
                              =ParamUtil.getJsonDomainGroup("domain51");
                              参数就是前台分区的id，其返回值是一个List，其中的每一个元素是一个Map。
                              对于不存在分组的分区，后台获取参数的方式与分区式提交后台获取参数的方式相同。 都是Map domain2 =
                              ParamUtil.getJsonDomain("domain52");
                           </p>
                           
                           
                           <p>前台html：</p>
                           
                           <pre class="programlisting"><span class="hl-tag">&lt;form</span> <span class="hl-attribute">id</span>=<span class="hl-value">"form5"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"form5"</span> <span class="hl-attribute">method</span>=<span class="hl-value">"post"</span> <span class="hl-attribute">action</span>=<span class="hl-value">"test.do?method=testJsonSubmit5"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;table</span> <span class="hl-attribute">id</span>=<span class="hl-value">"domain51"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;tbody&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>用户名<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"username"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>密码<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"password"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"passwork"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>用户名<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"username"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>密码<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"password"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"passwork"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
            
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>用户名<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"username"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>密码<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"password"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"passwork"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
        <span class="hl-tag">&lt;/tbody&gt;</span>
    <span class="hl-tag">&lt;/table&gt;</span>
    <span class="hl-tag">&lt;table</span> <span class="hl-attribute">id</span>=<span class="hl-value">"domain52"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;tbody&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>用户名<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"username"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;label&gt;</span>密码<span class="hl-tag">&lt;/label&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"password"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"passwork"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
            <span class="hl-tag">&lt;tr&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">id</span>=<span class="hl-value">"savebtn5"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"button"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"提交domainGroup2"</span><span class="hl-tag">/&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;td&gt;</span><span class="hl-tag">&lt;/td&gt;</span>
            <span class="hl-tag">&lt;/tr&gt;</span>
        <span class="hl-tag">&lt;/tbody&gt;</span>
    <span class="hl-tag">&lt;/table&gt;</span>
<span class="hl-tag">&lt;/form&gt;</span></pre><p>前台js代码：</p>
                           
                           <pre class="programlisting">$(<span class="hl-string">"#form4"</span>).<span class="emphasis"><em>jsonSubmit({domains:["domain51","domain52"],debug:false})</em></span>;
参数中的debug属性在正式开发的时候不需要给出，或者需要设置为false；
domains属性值必须是一个数组，数组中的每一个元素必须要要提交的多个容器的id。</pre>
                           
                           <p>后台代码：</p>
                           
                           <pre class="programlisting">List groups1 = <span class="emphasis"><em>ParamUtil.getJsonDomainGroup("domain51")</em></span>;
<span class="hl-keyword">for</span>(Object o : groups1){
    <span class="hl-keyword">if</span>(o <span class="hl-keyword">instanceof</span> Map){
        Map map = (Map)o;
        <span class="hl-keyword">for</span>(Object entryObj : map.entrySet()){
            <span class="hl-keyword">if</span>(entryObj <span class="hl-keyword">instanceof</span> Map.Entry){
                Map.Entry entry = (Map.Entry)entryObj;
                System.out.println(entry.getKey() + <span class="hl-string">":"</span> + entry.getValue());
            }
        }
    }
}
Map domain2 = <span class="emphasis"><em>ParamUtil.getJsonDomain("domain52")</em></span>;
<span class="hl-keyword">for</span>(Object entryObj : domain2.entrySet()){
    <span class="hl-keyword">if</span>(entryObj <span class="hl-keyword">instanceof</span> Map.Entry){
        Map.Entry entry = (Map.Entry)entryObj;
        System.out.println(entry.getKey() + <span class="hl-string">":"</span> + entry.getValue());
    }
}
 </pre>
                           </li>
                        <li class="step" title="Step 6">
                           
                           <p>如果需要获取页面中某个分区中的数据对象进行Ajax提交或其它处理，可以调用jquery插件的formobj方法，比如：</p>
                           
                           <pre class="programlisting"><span class="hl-keyword">var</span> obj = $(<span class="hl-string">"mydomain"</span>).formobj();
tBS.testAjaxSubmit(obj,{success:
   <span class="hl-keyword">function</span>(retObj){
      alert(<span class="hl-string">"success"</span>);
   }
});</pre>
                           </li>
                     </ol>
                  </div>
                  
                  
                  <div class="table"><a name="d5e1769"></a><p class="title"><b>Table&nbsp;11.2.&nbsp;</b></p>
                     <div class="table-contents">
                        
                        <table border="1">
                           <colgroup>
                              <col width="50%">
                              <col width="50%">
                           </colgroup>
                           <tbody>
                              <tr>
                                 <td>属性名</td>
                                 <td>属性值与说明</td>
                              </tr>
                              <tr>
                                 <td>domains</td>
                                 <td>必须是一个数组，分区式提交时该参数必须给出，里面每一个元素都必须是其中一个分区的id。</td>
                              </tr>
                              <tr>
                                 <td>debug</td>
                                 <td>当该属性的值是true时，会在提交之前将生成的json字符串alert出来，以便调试。</td>
                              </tr>
                              <tr>
                                 <td>beforeSubmit</td>
                                 <td>该属性的值必须是一个函数，当该函数的返回值等于false时，不会提交该form。</td>
                              </tr>
                           </tbody>
                        </table>
                        
                     </div>
                  </div>
                  <p><br class="table-break"></p>
                  
                  
                  <p>jsonSubmit方法的参数说明</p>
                  
                  
                  <p>该方法只接收一个参数，以Object的方式给出，我们可以给它添加属性。</p>
                  
                  
                  <div class="section" title="11.4.1.&nbsp;实例">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1786"></a>11.4.1.&nbsp;实例
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>请参考：http://[host]:[port]/[context]/samples/test.do?method=testJsonSubmit</p>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="11.5.&nbsp;表单数据清除">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1789"></a>11.5.&nbsp;表单数据清除
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>框架提供clearform函数用于清除某个区域内的表单输入域的值，代码例子如下：</p>
                  
                  
                  <p></p>
                  
                  <pre class="programlisting">&lt;script&gt;
$(document).ready(function() {
    $("#mybtn").click(function() {
      $("#mydomain").clearform();
    });
});
&lt;/script&gt;
&lt;input type="button" id="mybtn"&gt;
&lt;div id="mydomain"&gt;
&lt;input type="text"&gt;&lt;input type="checkbox"&gt;&lt;input type="radio"&gt;&lt;textarea&gt;&lt;/textarea&gt;
&lt;/div&gt;</pre>
                  </div>
               
               
               <div class="section" title="11.6.&nbsp;表单控件批量禁用/启用">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1794"></a>11.6.&nbsp;表单控件批量禁用/启用
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>框架提供disable和enable函数用于批量禁用和启用某个区域的控件，代码例子如下：</p>
                  
                  
                  <p></p>
                  
                  <pre class="programlisting">&lt;script&gt;
  $(document).ready(function() {
    $("#mybtn").toggle(function() {
      $("#mycal1").disable();
      $("#testRegion").disable();
    }, function() {
      $("#mycal1").enable();
      $("#testRegion").enable();
    });
  });
&lt;/script&gt;
&lt;input type="button" id="mybtn" value="禁用/启用"&gt;
&lt;div id="testRegion"&gt;
    &lt;a href="javascript:void(0)" class="common_button common_button_gray"&gt;按钮1&lt;/a&gt;&lt;a href="javascript:void(0)"
        class="common_button common_button_gray"&gt;按钮2&lt;/a&gt; &lt;input type="text" class="comp"
        comp="type:'calendar',ifFormat:'%m-%Y-%d'"&gt; &lt;input type="checkbox"&gt;&lt;input type="radio"&gt;
&lt;/div&gt;</pre>
                  </div>
               
               
               <div class="section" title="11.7.&nbsp;按钮级资源权限控制">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1799"></a>11.7.&nbsp;按钮级资源权限控制
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>框架通过简洁的方式实现按钮级权限控制，根据登陆用户具备的资源权限控制按钮、控件、区域是否显示。开发态（systemProperties.xml中ctp.runningMode=develop）</p>
                  
                  
                  <p>不控制，以方便开发调试。代码例子如下：</p>
                  
                  
                  <p></p>
                  
                  <pre class="programlisting">&lt;input type="button" class="resCode" resCode="f1_my_resource1" value="按钮1"&gt;<a name="comp_enum1_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
&lt;div class="resCode" resCode="f1_my_resource2"&gt;
    &lt;input type="text"&gt;
    &lt;input type="button" value="按钮2"&gt;
&lt;/div&gt;</pre>
                  
                  <div class="calloutlist">
                     <table border="0" summary="Callout list">
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p>???</p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>需要做按钮级资源权限控制的控件或容器元素，需要设置class为resCode，并且设置resCode为priv_resource资源表的resource_code字段值，则当用户具备该</p>
                              
                              
                              <p>资源权限时显示，否则隐藏</p>
                              
                           </td>
                        </tr>
                     </table>
                  </div>
                  
               </div>
               
            </div>
            
            
            <div class="chapter" title="Chapter&nbsp;12.&nbsp;基础组件">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d5e1810"></a>Chapter&nbsp;12.&nbsp;基础组件
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Table of Contents</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d5e1812">12.1. 基础控件库</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e1815">12.1.1. 按钮</a></span></dt>
                           <dt><span class="section"><a href="#d5e1824">12.1.2. 单选</a></span></dt>
                           <dt><span class="section"><a href="#d5e1832">12.1.3. 复选</a></span></dt>
                           <dt><span class="section"><a href="#d5e1840">12.1.4. 进度条</a></span></dt>
                           <dt><span class="section"><a href="#d5e1847">12.1.5. 页签</a></span></dt>
                           <dt><span class="section"><a href="#d5e1886">12.1.6. 文本框</a></span></dt>
                           <dt><span class="section"><a href="#d5e1894">12.1.7. 下拉列表</a></span></dt>
                           <dt><span class="section"><a href="#d5e1903">12.1.8. 链接</a></span></dt>
                           <dt><span class="section"><a href="#d5e1913">12.1.9. 搜索框</a></span></dt>
                           <dt><span class="section"><a href="#d5e1922">12.1.10. 面包屑</a></span></dt>
                           <dt><span class="section"><a href="#d5e1930">12.1.11. 提示消息</a></span></dt>
                           <dt><span class="section"><a href="#d5e2023">12.1.12. Dialog组件</a></span></dt>
                           <dt><span class="section"><a href="#d5e2076">12.1.13. Layout组件</a></span></dt>
                           <dt><span class="section"><a href="#d5e2106">12.1.14. Toolbar组件</a></span></dt>
                           <dt><span class="section"><a href="#d5e2129">12.1.15. Menu组件</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e2157">12.2. 表格组件</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e2211">12.2.1. 实例</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e2214">12.3. 树组件</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e2312">12.3.1. 实例</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e2315">12.4. 日期选择组件</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e2329">12.4.1. 实例</a></span></dt>
                        </dl>
                     </dd>
                  </dl>
               </div>
               
               
               
               <div class="section" title="12.1.&nbsp;基础控件库">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e1812"></a>12.1.&nbsp;基础控件库
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>基础控件库是构成页面的基本元素，必须严格按照规范的CSS引用。</p>
                  
                  
                  <div class="section" title="12.1.1.&nbsp;按钮">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1815"></a>12.1.1.&nbsp;按钮
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/basecomp_button.jpg"></div>
                     
                     
                     <p></p>
                     
                     <pre class="programlisting"><span class="hl-comment">&lt;!-- 普通按钮 --&gt;</span>
<span class="hl-tag">&lt;a</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_button common_button_gray"</span> <span class="hl-attribute">href</span>=<span class="hl-value">"javascript:void(0)"</span><span class="hl-tag">&gt;</span>确定<span class="hl-tag">&lt;/a&gt;</span>
<span class="hl-comment">&lt;!-- 图标按钮 --&gt;</span>
<span class="hl-tag">&lt;a</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_button common_button_icon"</span> <span class="hl-attribute">href</span>=<span class="hl-value">"javascript:void(0)"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;em&gt;</span><span class="hl-tag">&lt;/em&gt;</span>附件<span class="hl-tag">&lt;/a&gt;</span>
<span class="hl-comment">&lt;!-- 引导按钮 --&gt;</span>
<span class="hl-tag">&lt;a</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_button common_button_emphasize"</span> <span class="hl-attribute">href</span>=<span class="hl-value">"javascript:void(0)"</span><span class="hl-tag">&gt;</span>确定<span class="hl-tag">&lt;/a&gt;</span>
<span class="hl-comment">&lt;!-- 不可用 --&gt;</span>
<span class="hl-tag">&lt;a</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_button common_button_disable"</span> <span class="hl-attribute">href</span>=<span class="hl-value">"javascript:void(0)"</span><span class="hl-tag">&gt;</span>确定<span class="hl-tag">&lt;/a&gt;</span>
<span class="hl-comment">&lt;!-- 链接按钮 --&gt;</span>
<span class="hl-tag">&lt;a</span> <span class="hl-attribute">class</span>=<span class="hl-value">"img-button margin_r_0"</span> <span class="hl-attribute">href</span>=<span class="hl-value">"javascript:void(0)"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;em</span> <span class="hl-attribute">class</span>=<span class="hl-value">"ico16 affix"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;/em&gt;</span>附件<span class="hl-tag">&lt;/a&gt;</span></pre>
                     
                     <p></p>
                     
                  </div>
                  
                  
                  <div class="section" title="12.1.2.&nbsp;单选">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1824"></a>12.1.2.&nbsp;单选
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/basecomp_radio.jpg"></div>
                     
                     <pre class="programlisting"><span class="hl-comment">&lt;!--最后一个不用margin_r_10--&gt;</span>
<span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_radio_box clearfix"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;label</span> <span class="hl-attribute">for</span>=<span class="hl-value">"radio1"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"margin_r_10 hand"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"radio"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"1"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"radio1"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"option"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"radio_com"</span><span class="hl-tag">/&gt;</span>选项1<span class="hl-tag">&lt;/label&gt;</span>
    <span class="hl-tag">&lt;label</span> <span class="hl-attribute">for</span>=<span class="hl-value">"radio2"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"margin_r_10 hand"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"radio"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"2"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"radio2"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"option"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"radio_com"</span><span class="hl-tag">/&gt;</span>选项2<span class="hl-tag">&lt;/label&gt;</span>
    <span class="hl-tag">&lt;label</span> <span class="hl-attribute">for</span>=<span class="hl-value">"radio3"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"margin_r_10 hand"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"radio"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"3"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"radio3"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"option"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"radio_com"</span><span class="hl-tag">/&gt;</span>选项3<span class="hl-tag">&lt;/label&gt;</span>
    <span class="hl-tag">&lt;label</span> <span class="hl-attribute">for</span>=<span class="hl-value">"radio4"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"hand"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"radio"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"4"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"radio4"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"option"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"radio_com"</span><span class="hl-tag">/&gt;</span>选项4<span class="hl-tag">&lt;/label&gt;</span>
<span class="hl-tag">&lt;/div&gt;</span></pre>
                     </div>
                  
                  
                  <div class="section" title="12.1.3.&nbsp;复选">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1832"></a>12.1.3.&nbsp;复选
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/basecomp_checkbox.jpg"></div>
                     
                     <pre class="programlisting"><span class="hl-comment">&lt;!--最后一个不用margin_r_10--&gt;</span>
<span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_checkbox_box clearfix "</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;label</span> <span class="hl-attribute">class</span>=<span class="hl-value">"margin_r_10 hand"</span> <span class="hl-attribute">for</span>=<span class="hl-value">"radio1"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">id</span>=<span class="hl-value">"radio1"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"radio_com"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"option"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"0"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"checkbox"</span><span class="hl-tag">&gt;</span>选项1<span class="hl-tag">&lt;/label&gt;</span>
    <span class="hl-tag">&lt;label</span> <span class="hl-attribute">class</span>=<span class="hl-value">"margin_r_10 hand"</span> <span class="hl-attribute">for</span>=<span class="hl-value">"radio2"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">id</span>=<span class="hl-value">"radio2"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"radio_com"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"option"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"0"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"checkbox"</span><span class="hl-tag">&gt;</span>选项2<span class="hl-tag">&lt;/label&gt;</span>
    <span class="hl-tag">&lt;label</span> <span class="hl-attribute">class</span>=<span class="hl-value">"margin_r_10 hand"</span> <span class="hl-attribute">for</span>=<span class="hl-value">"radio3"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">id</span>=<span class="hl-value">"radio3"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"radio_com"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"option"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"0"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"checkbox"</span><span class="hl-tag">&gt;</span>选项3<span class="hl-tag">&lt;/label&gt;</span>
    <span class="hl-tag">&lt;label</span> <span class="hl-attribute">class</span>=<span class="hl-value">"margin_r_10 hand"</span> <span class="hl-attribute">for</span>=<span class="hl-value">"radio4"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">id</span>=<span class="hl-value">"radio4"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"radio_com"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"option"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"0"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"checkbox"</span><span class="hl-tag">&gt;</span>选项4<span class="hl-tag">&lt;/label&gt;</span>
<span class="hl-tag">&lt;/div&gt;</span></pre>
                     </div>
                  
                  
                  <div class="section" title="12.1.4.&nbsp;进度条">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1840"></a>12.1.4.&nbsp;进度条
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/basecomp_processbar.jpg"></div>
                     
                     
                     <p></p>
                     
                  </div>
                  
                  
                  <div class="section" title="12.1.5.&nbsp;页签">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1847"></a>12.1.5.&nbsp;页签
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/basecomp_tab.jpg"></div>
                     
                     <pre class="programlisting"><span class="hl-tag">&lt;div</span> <span class="hl-attribute">id</span>=<span class="hl-value">"tabs2"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"comp"</span> <span class="hl-attribute">comp</span>=<span class="hl-value">"type:'tab',width:600,height:200"</span><span class="hl-tag">&gt;</span><a name="comp_tab1_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
    <span class="hl-tag">&lt;div</span> <span class="hl-attribute">id</span>=<span class="hl-value">"tabs2_head"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_tabs clearfix"</span><span class="hl-tag">&gt;</span><a name="comp_tab1_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
        <span class="hl-tag">&lt;ul</span> <span class="hl-attribute">class</span>=<span class="hl-value">"left"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;li</span> <span class="hl-attribute">class</span>=<span class="hl-value">"current"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;a</span> <span class="hl-attribute">id</span>=<span class="hl-value">"btn1"</span> <span class="hl-attribute">href</span>=<span class="hl-value">"javascript:void(0)"</span> <span class="hl-attribute">tgt</span>=<span class="hl-value">"tab1_div"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;span&gt;</span>div1<span class="hl-tag">&lt;/span&gt;</span><span class="hl-tag">&lt;/a&gt;</span><span class="hl-tag">&lt;/li&gt;</span><a name="comp_tab1_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
            <span class="hl-tag">&lt;li&gt;</span><span class="hl-tag">&lt;a</span> <span class="hl-attribute">id</span>=<span class="hl-value">"btn2"</span> <span class="hl-attribute">href</span>=<span class="hl-value">"javascript:void(0)"</span> <span class="hl-attribute">tgt</span>=<span class="hl-value">"tab2_div"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;span&gt;</span>div2<span class="hl-tag">&lt;/span&gt;</span><span class="hl-tag">&lt;/a&gt;</span><span class="hl-tag">&lt;/li&gt;</span>
            <span class="hl-tag">&lt;li&gt;</span><span class="hl-tag">&lt;a</span> <span class="hl-attribute">href</span>=<span class="hl-value">"javascript:void(0)"</span> <span class="hl-attribute">tgt</span>=<span class="hl-value">"tab3_div"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;span&gt;</span>div3<span class="hl-tag">&lt;/span&gt;</span><span class="hl-tag">&lt;/a&gt;</span><span class="hl-tag">&lt;/li&gt;</span>
            <span class="hl-tag">&lt;li&gt;</span><span class="hl-tag">&lt;a</span> <span class="hl-attribute">href</span>=<span class="hl-value">"javascript:void(0)"</span> <span class="hl-attribute">tgt</span>=<span class="hl-value">"tab4_div"</span> <span class="hl-attribute">class</span>=<span class="hl-value">'last_tab'</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;span&gt;</span>div4<span class="hl-tag">&lt;/span&gt;</span><span class="hl-tag">&lt;/a&gt;</span><span class="hl-tag">&lt;/li&gt;</span>
        <span class="hl-tag">&lt;/ul&gt;</span>
    <span class="hl-tag">&lt;/div&gt;</span>
    <span class="hl-tag">&lt;div</span> <span class="hl-attribute">id</span>=<span class="hl-value">'tabs2_body'</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_tabs_body"</span><span class="hl-tag">&gt;</span><a name="comp_tab1_4"></a><img src="resources/callouts/4.png" alt="4" border="0">
        <span class="hl-tag">&lt;div</span> <span class="hl-attribute">id</span>=<span class="hl-value">"tab1_div"</span><span class="hl-tag">&gt;</span>1<span class="hl-tag">&lt;/div&gt;</span>
        <span class="hl-tag">&lt;div</span> <span class="hl-attribute">id</span>=<span class="hl-value">"tab2_div"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"hidden"</span><span class="hl-tag">&gt;</span>2<span class="hl-tag">&lt;/div&gt;</span>
        <span class="hl-tag">&lt;div</span> <span class="hl-attribute">id</span>=<span class="hl-value">"tab3_div"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"hidden"</span><span class="hl-tag">&gt;</span>3<span class="hl-tag">&lt;/div&gt;</span>
        <span class="hl-tag">&lt;div</span> <span class="hl-attribute">id</span>=<span class="hl-value">"tab4_div"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"hidden"</span><span class="hl-tag">&gt;</span>4<span class="hl-tag">&lt;/div&gt;</span>
    <span class="hl-tag">&lt;/div&gt;</span>
<span class="hl-tag">&lt;/div&gt;</span></pre>
                     
                     <div class="calloutlist">
                        <table border="0" summary="Callout list">
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_tab1_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>设置div的class为comp组件，同时设置comp属性type为tab，框架会自动将其作页签处理，可以指定宽度和高度属性</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_tab1_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>tab的head用div定义，同时该div的id名称必须为外层div的id加上“_head”</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_tab1_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>tgt属性用于定义该页签点击时激活的区域，对应下面body部分中的某个div（也可以为iframe）的id</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_tab1_4"><img src="resources/callouts/4.png" alt="4" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>tab的body用div定义，同时该div的id名称必须为外层div的id加上“_body”</p>
                                 
                              </td>
                           </tr>
                        </table>
                     </div>
                     
                     
                     <p>如果要处理页签组件的相应事件，可以做如下处理逻辑：</p>
                     
                     <pre class="programlisting">&lt;script type=<span class="hl-string">"text/javascript"</span>&gt;
  $().ready(<span class="hl-keyword">function</span>() {
    $(<span class="hl-string">"#btn1"</span>).click(<span class="hl-keyword">function</span>() {<a name="comp_tab2_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
      alert(<span class="hl-string">"btn1 click"</span>);
    });
    $(<span class="hl-string">"#toggleBtn"</span>).toggle(<span class="hl-keyword">function</span>() {
      $(<span class="hl-string">"#tabs2"</span>).tabDisable(<span class="hl-string">"tab3_div"</span>);<a name="comp_tab2_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
    }, <span class="hl-keyword">function</span>() {
      $(<span class="hl-string">"#tabs2"</span>).tabEnable(<span class="hl-string">"tab3_div"</span>);<a name="comp_tab2_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
    });
    $(<span class="hl-string">"#currentBtn"</span>).click(<span class="hl-keyword">function</span>() {
      $(<span class="hl-string">"#tabs2"</span>).tabCurrent(<span class="hl-string">"tab4_div"</span>);<a name="comp_tab2_4"></a><img src="resources/callouts/4.png" alt="4" border="0">
    });
  });
&lt;/script&gt;</pre>
                     
                     <div class="calloutlist">
                        <table border="0" summary="Callout list">
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_tab2_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>页签按钮的点击事件</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_tab2_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>禁用某个页签，tabs2为页签容器id，tab3_div为要禁用的页签内容区id（div或iframe）</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_tab2_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>启用某个页签，tabs2为页签容器id，tab3_div为要启用的页签内容区id（div或iframe）</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_tab2_4"><img src="resources/callouts/4.png" alt="4" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>激活显示某个页签，tabs2为页签容器id，tab4_div为要激活显示的页签内容区id（div或iframe）</p>
                                 
                              </td>
                           </tr>
                        </table>
                     </div>
                     
                     
                     <div class="section" title="12.1.5.1.&nbsp;实例">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d5e1883"></a>12.1.5.1.&nbsp;实例
                                 </h4>
                              </div>
                           </div>
                        </div>
                        
                        
                        
                        <p>请参考：http://[host]:[port]/[context]/controls/tab.jsp</p>
                        
                     </div>
                     
                  </div>
                  
                  
                  <div class="section" title="12.1.6.&nbsp;文本框">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1886"></a>12.1.6.&nbsp;文本框
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/basecomp_textbox.jpg"></div>
                     
                     <pre class="programlisting"><span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_txtbox clearfix"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;label</span> <span class="hl-attribute">class</span>=<span class="hl-value">"margin_r_10 left"</span> <span class="hl-attribute">for</span>=<span class="hl-value">"text"</span><span class="hl-tag">&gt;</span>标题:<span class="hl-tag">&lt;/label&gt;</span>
    <span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_txtbox_wrap"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;input</span> <span class="hl-attribute">id</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">value</span>=<span class="hl-value">""</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;/div&gt;</span>
<span class="hl-tag">&lt;/div&gt;</span></pre>
                     </div>
                  
                  
                  <div class="section" title="12.1.7.&nbsp;下拉列表">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1894"></a>12.1.7.&nbsp;下拉列表
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/basecomp_dropdown.jpg"></div>
                     
                     
                     <p></p>
                     
                     <pre class="programlisting"><span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_drop_list"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_drop_list_title"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;a</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_drop_list_select common_button common_button_gray"</span> <span class="hl-attribute">href</span>=<span class="hl-value">"javascript:void(0)"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;table</span> <span class="hl-attribute">width</span>=<span class="hl-value">"100%"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;tbody&gt;</span>
                <span class="hl-tag">&lt;tr&gt;</span>
                    <span class="hl-tag">&lt;td&gt;</span>
                        普通
                    <span class="hl-tag">&lt;/td&gt;</span>
                    <span class="hl-tag">&lt;td</span> <span class="hl-attribute">class</span>=<span class="hl-value">"align_right"</span><span class="hl-tag">&gt;</span>
                    <span class="hl-tag">&lt;em&gt;</span><span class="hl-tag">&lt;/em&gt;</span>
                    <span class="hl-tag">&lt;/td&gt;</span>
                <span class="hl-tag">&lt;/tr&gt;</span>
            <span class="hl-tag">&lt;/tbody&gt;</span>
        <span class="hl-tag">&lt;/table&gt;</span>
    <span class="hl-tag">&lt;/a&gt;</span>
    <span class="hl-tag">&lt;/div&gt;</span>
    <span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_drop_list_content"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;a</span> <span class="hl-attribute">href</span>=<span class="hl-value">"#"</span><span class="hl-tag">&gt;</span>重要<span class="hl-tag">&lt;/a&gt;</span>
        <span class="hl-tag">&lt;a</span> <span class="hl-attribute">href</span>=<span class="hl-value">"#"</span><span class="hl-tag">&gt;</span>非常重要<span class="hl-tag">&lt;/a&gt;</span>
        <span class="hl-tag">&lt;a</span> <span class="hl-attribute">href</span>=<span class="hl-value">"#"</span><span class="hl-tag">&gt;</span>不重要<span class="hl-tag">&lt;/a&gt;</span>
    <span class="hl-tag">&lt;/div&gt;</span>
<span class="hl-tag">&lt;/div&gt;</span></pre>
                     </div>
                  
                  
                  <div class="section" title="12.1.8.&nbsp;链接">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1903"></a>12.1.8.&nbsp;链接
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/basecomp_link.jpg"></div>
                     
                     <pre class="programlisting"><span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"link_box clearfix"</span><span class="hl-tag">&gt;</span>
    <span class="hl-comment">&lt;!--按钮居中common_button_center--&gt;</span>
    <span class="hl-tag">&lt;a</span> <span class="hl-attribute">href</span>=<span class="hl-value">"#"</span><span class="hl-tag">&gt;</span>更多<span class="hl-tag">&lt;/a&gt;</span>
<span class="hl-tag">&lt;/div&gt;</span></pre>
                     
                     <p></p>
                     
                  </div>
                  
                  
                  <div class="section" title="12.1.9.&nbsp;搜索框">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1913"></a>12.1.9.&nbsp;搜索框
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/basecomp_searchbox.jpg"></div>
                     
                     <pre class="programlisting"><span class="hl-tag">&lt;ul</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_search common_search_condition"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;li&gt;</span>
        <span class="hl-tag">&lt;a</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_button common_button_gray condition"</span> <span class="hl-attribute">href</span>=<span class="hl-value">"javascript:void(0)"</span><span class="hl-tag">&gt;</span>查询条件<span class="hl-tag">&lt;em&gt;</span><span class="hl-tag">&lt;/em&gt;</span><span class="hl-tag">&lt;/a&gt;</span>
    <span class="hl-tag">&lt;/li&gt;</span>
    <span class="hl-tag">&lt;li</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_search_input"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;input</span> <span class="hl-attribute">class</span>=<span class="hl-value">"search_input"</span> <span class="hl-attribute">value</span>=<span class="hl-value">""</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;/li&gt;</span>
    <span class="hl-tag">&lt;li&gt;</span>
        <span class="hl-tag">&lt;a</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_button common_button_gray search_buttonHand"</span> <span class="hl-attribute">href</span>=<span class="hl-value">"javascript:void(0)"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;em&gt;</span><span class="hl-tag">&lt;/em&gt;</span><span class="hl-tag">&lt;/a&gt;</span>
    <span class="hl-tag">&lt;/li&gt;</span>
<span class="hl-tag">&lt;/ul&gt;</span></pre>
                     
                     <p></p>
                     
                  </div>
                  
                  
                  <div class="section" title="12.1.10.&nbsp;面包屑">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1922"></a>12.1.10.&nbsp;面包屑
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/basecomp_breadcrumb.jpg"></div>
                     
                     <pre class="programlisting"><span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_crumbs"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;span</span> <span class="hl-attribute">class</span>=<span class="hl-value">"margin_r_10"</span><span class="hl-tag">&gt;</span>当前位置:<span class="hl-tag">&lt;/span&gt;</span><span class="hl-tag">&lt;a</span> <span class="hl-attribute">href</span>=<span class="hl-value">"#"</span><span class="hl-tag">&gt;</span>文档中心<span class="hl-tag">&lt;/a&gt;</span><span class="hl-tag">&lt;span</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_crumbs_next margin_lr_5"</span><span class="hl-tag">&gt;</span>-<span class="hl-tag">&lt;/span&gt;</span><span class="hl-tag">&lt;a</span> <span class="hl-attribute">href</span>=<span class="hl-value">"#"</span><span class="hl-tag">&gt;</span>业务培训<span class="hl-tag">&lt;/a&gt;</span>
<span class="hl-tag">&lt;/div&gt;</span></pre>
                     </div>
                  
                  
                  <div class="section" title="12.1.11.&nbsp;提示消息">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e1930"></a>12.1.11.&nbsp;提示消息
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/basecomp_messagebox.jpg"></div>
                     
                     <pre class="programlisting">  $.messageBox({<a name="comp_messageBox_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
    'type' : 0,
    'msg' : 'this is msg content!',
    ok_fn : function() {
      alert('确定后执行，自定义方法test()!');
    }
  });</pre>
                     
                     <div class="calloutlist">
                        <table border="0" summary="Callout list">
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_messageBox_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>$.messageBox函数调用将弹出消息提示窗口</p>
                                 
                              </td>
                           </tr>
                        </table>
                     </div>
                     
                     
                     <p>type属性定义如下：</p>
                     
                     
                     <div class="informaltable">
                        
                        <table border="1">
                           <colgroup>
                              <col align="center" width="33%">
                              <col width="33%">
                              <col width="34%">
                           </colgroup>
                           <thead>
                              <tr>
                                 <th align="center">type类型值</th>
                                 <th align="center">button</th>
                                 <th align="center">返回值</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr>
                                 <td align="center">0</td>
                                 <td>确定</td>
                                 <td>ok</td>
                              </tr>
                              <tr>
                                 <td align="center">1</td>
                                 <td>确定+取消</td>
                                 <td>ok+cancel</td>
                              </tr>
                              <tr>
                                 <td align="center">2</td>
                                 <td>是+否+取消</td>
                                 <td>yes+no+cancel</td>
                              </tr>
                              <tr>
                                 <td align="center">3</td>
                                 <td>是+否</td>
                                 <td>yes+no</td>
                              </tr>
                              <tr>
                                 <td align="center">4</td>
                                 <td>重试+取消</td>
                                 <td>retry+cancel</td>
                              </tr>
                              <tr>
                                 <td align="center">5</td>
                                 <td>确定+详细</td>
                                 <td>ok+detail</td>
                              </tr>
                              <tr>
                                 <td align="center">100</td>
                                 <td>自定义按钮及事件</td>
                                 <td>&nbsp;</td>
                              </tr>
                           </tbody>
                        </table>
                                
                     </div>
                     
                     
                     <p>可以传入的参数属性如下表：</p>
                     
                     
                     <div class="informaltable">
                        
                        <table border="1">
                           <colgroup>
                              <col align="center" width="50%">
                              <col width="50%">
                           </colgroup>
                           <thead>
                              <tr>
                                 <th align="center">参数名</th>
                                 <th align="center">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr>
                                 <td align="center">title</td>
                                 <td>消息窗口名称</td>
                              </tr>
                              <tr>
                                 <td align="center">imgType</td>
                                 <td>消息窗口图片类型(0:成功)--(1:操作失败)--(2:警告)--(3:询问)</td>
                              </tr>
                              <tr>
                                 <td align="center">msg</td>
                                 <td>提示信息内容</td>
                              </tr>
                              <tr>
                                 <td align="center">ok_fn</td>
                                 <td>点击确定后执行的函数</td>
                              </tr>
                              <tr>
                                 <td align="center">cancel_fn</td>
                                 <td>点击取消后执行的函数</td>
                              </tr>
                              <tr>
                                 <td align="center">yes_fn</td>
                                 <td>点击是后执行的函数</td>
                              </tr>
                              <tr>
                                 <td align="center">no_fn</td>
                                 <td>点击否后执行的函数</td>
                              </tr>
                              <tr>
                                 <td align="center">retry_fn</td>
                                 <td>点击重试后执行的函数</td>
                              </tr>
                              <tr>
                                 <td align="center">detail_fn</td>
                                 <td>点击详情后执行的函数</td>
                              </tr>
                              <tr>
                                 <td align="center">buttons</td>
                                 <td>自定义按钮及事件</td>
                              </tr>
                              <tr>
                                 <td align="center">isFrountEvent</td>
                                 <td>点击按钮后是否先执行自定义事件[默认先关闭窗口再执行自定义事件]</td>
                              </tr>
                           </tbody>
                        </table>
                                
                     </div>
                     
                     
                     <p>实例</p>
                     
                     
                     <p>请参考：http://[host]:[port]/[context]/controls/messageBox.jsp</p>
                     
                  </div>
                  
                  
                  <div class="section" title="12.1.12.&nbsp;Dialog组件">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e2023"></a>12.1.12.&nbsp;Dialog组件
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/basecomp_dialog.jpg"></div>
                     
                     <pre class="programlisting">  var dialog = $.dialog({<a name="comp_dialog_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
    //html : 'this is msg html!',
    htmlId : 'searchId',
    title : 'html',
    buttons : [ {
      text : "button1",
      handler : function() {
        dialog.close();
      }
    }, {
      text : "button2",
      handler : function() {
        dialog.close();
      }
    } ]
  });</pre>
                     
                     <div class="calloutlist">
                        <table border="0" summary="Callout list">
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_dialog_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>$.dialog函数调用将弹出Dialog对话框窗口</p>
                                 
                              </td>
                           </tr>
                        </table>
                     </div>
                     
                     
                     <p>参数的具体描述如下表：</p>
                     
                     
                     <div class="informaltable">
                        
                        <table border="1">
                           <colgroup>
                              <col align="center" width="50%">
                              <col width="50%">
                           </colgroup>
                           <thead>
                              <tr>
                                 <th align="center">属性</th>
                                 <th align="center">描述</th>
                              </tr>
                           </thead>
                           <tbody>
                              <tr>
                                 <td align="center">title</td>
                                 <td>窗口名称</td>
                              </tr>
                              <tr>
                                 <td align="center">html</td>
                                 <td>内容显示传入的html代码</td>
                              </tr>
                              <tr>
                                 <td align="center">url</td>
                                 <td>内容显示iframe，src为传入的url</td>
                              </tr>
                              <tr>
                                 <td align="center">width</td>
                                 <td>内容区宽度</td>
                              </tr>
                              <tr>
                                 <td align="center">height</td>
                                 <td>内容区高度</td>
                              </tr>
                              <tr>
                                 <td align="center">buttons</td>
                                 <td>数组:按钮及事件 buttons:[{ text:"button1",
                                    handler:function(){alert('handler')} },{ text:"button2",
                                                    handler:function(){alert('handler')} }]
                                 </td>
                              </tr>
                              <tr>
                                 <td align="center">isDrag</td>
                                 <td>是否允许拖拽</td>
                              </tr>
                              <tr>
                                 <td align="center">type</td>
                                 <td>是'dialog'还是'panel',默认为'dialog'</td>
                              </tr>
                              <tr>
                                 <td align="center">htmlId</td>
                                 <td>显示改id内的内容</td>
                              </tr>
                              <tr>
                                 <td align="center">targetId</td>
                                 <td>panel显示在改id对象的下方</td>
                              </tr>
                           </tbody>
                        </table>
                                
                     </div>
                     
                     
                     <div class="section" title="12.1.12.1.&nbsp;实例">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d5e2073"></a>12.1.12.1.&nbsp;实例
                                 </h4>
                              </div>
                           </div>
                        </div>
                        
                        
                        
                        <p>请参考：http://[host]:[port]/[context]/controls/dialog.jsp</p>
                        
                     </div>
                     
                  </div>
                  
                  
                  <div class="section" title="12.1.13.&nbsp;Layout组件">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e2076"></a>12.1.13.&nbsp;Layout组件
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/basecomp_layout.jpg"></div>
                     
                     <pre class="programlisting"><span class="hl-tag">&lt;body&gt;</span>
    <span class="hl-tag">&lt;div</span> <span class="hl-attribute">id</span>=<span class="hl-value">'layout'</span> <span class="hl-attribute">class</span>=<span class="hl-value">"comp"</span> <span class="hl-attribute">comp</span>=<span class="hl-value">"type:'layout'"</span><span class="hl-tag">&gt;</span><a name="comp_layout1_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
        <span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"layout_north"</span> <span class="hl-attribute">layout</span>=<span class="hl-value">"height:100,maxHeight:100,minHeight:30"</span><span class="hl-tag">&gt;</span><a name="comp_layout1_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
            North
        <span class="hl-tag">&lt;/div&gt;</span>
        <span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"layout_east"</span> <span class="hl-attribute">layout</span>=<span class="hl-value">"width:200,minWidth:50,maxWidth:200"</span><span class="hl-tag">&gt;</span>East<span class="hl-tag">&lt;/div&gt;</span><a name="comp_layout1_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
        <span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"layout_center"</span> <span class="hl-attribute">layout</span>=<span class="hl-value">"border:false"</span><span class="hl-tag">&gt;</span><a name="comp_layout1_4"></a><img src="resources/callouts/4.png" alt="4" border="0">
            <span class="hl-tag">&lt;div</span> <span class="hl-attribute">id</span>=<span class="hl-value">"layout2"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"comp"</span> <span class="hl-attribute">comp</span>=<span class="hl-value">"type:'layout'"</span>
                <span class="hl-attribute">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"layout_north"</span> <span class="hl-attribute">layout</span>=<span class="hl-value">"height:100,maxHeight:100,minHeight:30"</span><span class="hl-tag">&gt;</span>North<span class="hl-tag">&lt;/div&gt;</span>
                <span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"layout_east"</span> <span class="hl-attribute">layout</span>=<span class="hl-value">"width:200,minWidth:50,maxWidth:200"</span><span class="hl-tag">&gt;</span>East<span class="hl-tag">&lt;/div&gt;</span>
                <span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"layout_center"</span> <span class="hl-attribute">layout</span>=<span class="hl-value">"border:true"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;/div&gt;</span>
                <span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"layout_west"</span> <span class="hl-attribute">layout</span>=<span class="hl-value">"width:200,minWidth:50,maxWidth:300"</span><span class="hl-tag">&gt;</span>West<span class="hl-tag">&lt;/div&gt;</span>
                <span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"layout_south"</span> <span class="hl-attribute">layout</span>=<span class="hl-value">"height:50,maxHeight:300,minHeight:30"</span><span class="hl-tag">&gt;</span>South<span class="hl-tag">&lt;/div&gt;</span>
            <span class="hl-tag">&lt;/div&gt;</span>
        <span class="hl-tag">&lt;/div&gt;</span>
        <span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"layout_west"</span> <span class="hl-attribute">layout</span>=<span class="hl-value">"width:200,minWidth:50,maxWidth:300"</span><span class="hl-tag">&gt;</span>West<span class="hl-tag">&lt;/div&gt;</span><a name="comp_layout1_5"></a><img src="resources/callouts/5.png" alt="5" border="0">
        <span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"layout_south"</span> <span class="hl-attribute">layout</span>=<span class="hl-value">"height:50,maxHeight:300,minHeight:30"</span><span class="hl-tag">&gt;</span>South<span class="hl-tag">&lt;/div&gt;</span><a name="comp_layout1_6"></a><img src="resources/callouts/6.png" alt="6" border="0">
    <span class="hl-tag">&lt;/div&gt;</span>
<span class="hl-tag">&lt;/body&gt;</span></pre>
                     
                     <div class="calloutlist">
                        <table border="0" summary="Callout list">
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_layout1_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>设置div的class为comp组件，同时设置comp属性type为layout，框架会自动将其作布局处理</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_layout1_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>class必须为layout_north的布局div，用layout属性进行宽高设置和最大、最小宽度/高度设置</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_layout1_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>class必须为layout_east的布局div，用layout属性进行宽高设置和最大、最小宽度/高度设置</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_layout1_4"><img src="resources/callouts/4.png" alt="4" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>class必须为layout_center的布局div，用layout属性进行宽高设置和最大、最小宽度/高度设置，内部还可进行布局嵌套定义</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_layout1_5"><img src="resources/callouts/5.png" alt="5" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>class必须为layout_west的布局div，用layout属性进行宽高设置和最大、最小宽度/高度设置</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_layout1_6"><img src="resources/callouts/6.png" alt="6" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>class必须为layout_south的布局div，用layout属性进行宽高设置和最大、最小宽度/高度设置</p>
                                 
                              </td>
                           </tr>
                        </table>
                     </div>
                     
                     
                     <div class="section" title="12.1.13.1.&nbsp;实例">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d5e2102"></a>12.1.13.1.&nbsp;实例
                                 </h4>
                              </div>
                           </div>
                        </div>
                        
                        
                        
                        <p>请参考：http://[host]:[port]/[context]/controls/layout.jsp</p>
                        
                        
                        <p></p>
                        
                     </div>
                     
                  </div>
                  
                  
                  <div class="section" title="12.1.14.&nbsp;Toolbar组件">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e2106"></a>12.1.14.&nbsp;Toolbar组件
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/basecomp_toolbar.jpg"></div>
                     
                     <pre class="programlisting">&lt;script type="text/javascript"&gt;
  $().ready(function() {
    $("#toolbar").toolbar({<a name="comp_toolbar_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
      toolbar : [ {<a name="comp_toolbar_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
        id : "transmit",
        name : "转发",
        className : "ico16",
        subMenu : [ {<a name="comp_toolbar_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
          name : "协同",
          href : function(){
             alert(111);
          }
        }, {
          name : "邮件",
          href : function(){
             alert(222);
          }
        } ]
      }, {
        id : "delete",
        name : "删除",
        iconClass : "ico16 del"
      }, {
        id : "refresh",
        name : "刷新",
        iconClass : "ico16 refresh"
      },{
        id: "select",
        type: "select",
        value:"-1",
        text:"重要程度",
        className:"hidden",//隐藏select
        onchange:getValue, //绑定onchange方法
        disabled:true, //设置disable状态
        items: [{
            text: '普通',
            value: '0'
        }, {
            text: '重要',
            value: '1'
        }, {
            text: '非常重要',
            value: '2'
        }]

       // className: "ico16 del_16",
    } ]
    });
  });
&lt;/script&gt;

&lt;div id="toolbar"&gt;&lt;/div&gt;<a name="comp_toolbar_4"></a><img src="resources/callouts/4.png" alt="4" border="0">
                    </pre>
                     
                     <div class="calloutlist">
                        <table border="0" summary="Callout list">
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_toolbar_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>toobar函数初始化工具条，id指定某个div</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_toolbar_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>设置toolbar参数，值为要显示的toolbar按钮数组</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_toolbar_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>带菜单的用subMenu配置子集功能操作</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_toolbar_4"><img src="resources/callouts/4.png" alt="4" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>要显示toolbar的div</p>
                                 
                              </td>
                           </tr>
                        </table>
                     </div>
                     
                     
                     <div class="section" title="12.1.14.1.&nbsp;实例">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d5e2126"></a>12.1.14.1.&nbsp;实例
                                 </h4>
                              </div>
                           </div>
                        </div>
                        
                        
                        
                        <p>请参考：http://[host]:[port]/[context]/controls/toolbar.jsp</p>
                        
                     </div>
                     
                  </div>
                  
                  
                  <div class="section" title="12.1.15.&nbsp;Menu组件">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e2129"></a>12.1.15.&nbsp;Menu组件
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p></p>
                     
                     
                     <div class="mediaobject"><img src="resources/images/basecomp_menu.jpg"></div>
                     
                     <pre class="programlisting">&lt;script type="text/javascript"&gt;
  $().ready(function() {
    $("#menuDiv").menu({<a name="comp_menu_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
      maxMenu : 4,<a name="comp_menu_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
      menus : [ {<a name="comp_menu_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
        name : "菜单一",
        items : [ {<a name="comp_menu_4"></a><img src="resources/callouts/4.png" alt="4" border="0">
          name : "item1"
        }, {
          name : "item2",
          items : [ {<a name="comp_menu_5"></a><img src="resources/callouts/5.png" alt="5" border="0">
            name : "item111"
          }, {
            name : "item333",
            items : [ {
              name : "item1111111",
              action : 'javascript: alert("菜单点击！");',
            }, {
              name : "item2222222",
              disable : true
            } ]
          } ]
        } ]
      }, {
        name : "菜单四",
        className : 'ico16 del',
        disable : true
      } ]
    });
  });
&lt;/script&gt;

&lt;div id='menuDiv'&gt;&lt;/div&gt;<a name="comp_menu_6"></a><img src="resources/callouts/6.png" alt="6" border="0">
                    </pre>
                     
                     <div class="calloutlist">
                        <table border="0" summary="Callout list">
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_menu_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>menu函数初始化菜单，id指定某个div</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_menu_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>maxMenu设置最大显示菜单数量，多出的菜单将缩排显示</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_menu_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>menus属性配置一级菜单定义数组</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_menu_4"><img src="resources/callouts/4.png" alt="4" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>items属性定义菜单项数组</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_menu_5"><img src="resources/callouts/5.png" alt="5" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>items菜单项数组可以支持多层级</p>
                                 
                              </td>
                           </tr>
                           <tr>
                              <td width="5%" valign="top" align="left">
                                 <p><a href="#comp_menu_6"><img src="resources/callouts/6.png" alt="6" border="0"></a> 
                                 </p>
                              </td>
                              <td valign="top" align="left">
                                 
                                 <p>要展现菜单的div</p>
                                 
                              </td>
                           </tr>
                        </table>
                     </div>
                     
                     
                     <p>实例</p>
                     
                     
                     <p>请参考：http://[host]:[port]/[context]/controls/menu.jsp</p>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="12.2.&nbsp;表格组件">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e2157"></a>12.2.&nbsp;表格组件
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>框架使用javascript实现的EXT风格的表格进行列表数据的展现和处理，包括ajax翻页、排序、查询、点击事件、checkbox选择、数据提交等。</p>
                  
                  
                  <p></p>
                  
                  
                  <div class="mediaobject"><img src="resources/images/basecomp_table.jpg"></div>
                  
                  
                  <p>最简单的表格创建代码如下：</p>
                  
                  <pre class="programlisting"><span class="hl-keyword">var</span> t = $(<span class="hl-string">"#mytable"</span>).ajaxgrid({<a name="comp_table_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
      colModel : [ {
        display : <span class="hl-string">'id'</span>,
        name : <span class="hl-string">'orgid'</span>,
        width : <span class="hl-string">'40'</span>,
        type : <span class="hl-string">'checkbox'</span>
      }, {
        display : <span class="hl-string">'组织名称'</span>,
        name : <span class="hl-string">'orgname'</span>,
        width : <span class="hl-string">'180'</span>,
      }, {
        display : <span class="hl-string">'父组织ID'</span>,
        name : <span class="hl-string">'parentid'</span>,
        width : <span class="hl-string">'180'</span>
      } ],
      managerName : <span class="hl-string">"testPagingManager"</span>,<a name="comp_table_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
      managerMethod : <span class="hl-string">"testPaging"</span><a name="comp_table_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
    });
    <span class="hl-keyword">var</span> o = <span class="hl-keyword">new</span> <span class="hl-keyword">Object</span>();
    o.orgname = <span class="hl-string">"%"</span>;
    $(<span class="hl-string">"#mytable"</span>).ajaxgridLoad(o);<a name="comp_table_4"></a><img src="resources/callouts/4.png" alt="4" border="0">

&lt;table id=<span class="hl-string">"mytable"</span> style=<span class="hl-string">"display: none"</span>&gt;&lt;/table&gt;<a name="comp_table_5"></a><img src="resources/callouts/5.png" alt="5" border="0">
                </pre>
                  
                  <div class="calloutlist">
                     <table border="0" summary="Callout list">
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_table_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>调用jquery插件的ajaxgrid函数初始化表格组件，colModel为表格列定义配置</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_table_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>Ajax翻页调用的Manager在sprint中的bean id</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_table_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>Ajax翻页调用的Manager的方法，接收参数必须是两个(FlipInfo fi, Map
                                 param)，翻页信息类和查询参数map
                              </p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_table_4"><img src="resources/callouts/4.png" alt="4" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>页面加载完成之后调用ajaxgridLoad进行首次数据加载，输入参数对象为查询条件(Manager方法的第二个参数接收)，另外，也可利用表单</p>
                              
                              
                              <p>自动回填机制，在controller中做如下动作：</p>
                              
                              <pre class="programlisting">TestPagingManager testBS = (TestPagingManager) AppContext.getBean(<span class="hl-string">"testPagingManager"</span>);
Map param = <span class="hl-keyword">new</span> HashMap();
param.put(<span class="hl-string">"orgname"</span>, <span class="hl-string">"%"</span>);
FlipInfo fi = testBS.testPaging(<span class="hl-keyword">new</span> FlipInfo(), param);
request.setAttribute(<span class="hl-string">"ffmytable"</span>, fi);<a name="comp_table_4_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
                        </pre>
                              
                              <div class="calloutlist">
                                 <table border="0" summary="Callout list">
                                    <tr>
                                       <td width="5%" valign="top" align="left">
                                          <p><a href="#comp_table_4_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                          </p>
                                       </td>
                                       <td valign="top" align="left">
                                          
                                          <p>ff表示需要自动回填，之后为要回填的表格id，值必须为FlipInfo翻页信息对象</p>
                                          
                                       </td>
                                    </tr>
                                 </table>
                              </div>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_table_5"><img src="resources/callouts/5.png" alt="5" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>隐藏样式的table元素定义</p>
                              
                           </td>
                        </tr>
                     </table>
                  </div>
                  
                  
                  <p></p>
                  
                  
                  <p>表格组件的各种功能例子代码如下：</p>
                  
                  <pre class="programlisting"><span class="hl-tag">&lt;%@</span> <span class="hl-attribute">page</span> <span class="hl-attribute">contentType</span>=<span class="hl-value">"text/html; charset=utf-8"</span> <span class="hl-attribute">isELIgnored</span>=<span class="hl-value">"false"</span><span class="hl-attribute">%&gt;</span>
<span class="hl-attribute">&lt;%@</span> <span class="hl-attribute">include</span> <span class="hl-attribute">file</span>=<span class="hl-value">"/WEB-INF/jsp/common/common.jsp"</span><span class="hl-attribute">%&gt;</span>
<span class="hl-attribute">&lt;html&gt;</span>
<span class="hl-attribute">&lt;head&gt;</span>
<span class="hl-attribute">&lt;title&gt;AjaxPagingGrid测试&lt;/title&gt;</span>
<span class="hl-attribute">&lt;script</span> <span class="hl-attribute">text</span>=<span class="hl-value">"text/javascript"</span><span class="hl-tag">&gt;</span>
  $(function() {
    var t = $("#mytable").ajaxgrid({
      searchHTML : 'searchHTML',<a name="comp_table2_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
      click : clk,<a name="comp_table2_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
      dblclick : dblclk,<a name="comp_table2_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
      render : rend,<a name="comp_table2_4"></a><img src="resources/callouts/4.png" alt="4" border="0">
      colModel : [ {
        display : 'id',
        name : 'orgid',
        width : '40',
        sortable : false,
        align : 'center',
        type : 'checkbox'
      }, {
        display : '组织名称',
        name : 'orgname',
        width : '180',
        sortable : true,
        align : 'left'
      }, {
        display : '父组织ID',
        name : 'parentid',
        width : '180',
        sortable : true,
        align : 'left',
        codecfg : "codeId:'test_code'"<a name="comp_table2_5"></a><img src="resources/callouts/5.png" alt="5" border="0">
      } ],
      searchitems : [ {
        display : '组织ID',
        name : 'orgid'
      }, {
        display : '组织名称',
        name : 'orgname'
      } ],
      width : 1200,
      height : 400,
      managerName : "testPagingManager",
      managerMethod : "testPaging"
    });
    function rend(txt,data, r, c) {
      if (c == 0)
        return '<span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"checkbox"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"'+txt+'"</span><span class="hl-tag">&gt;</span>';
      else
        return txt;
    }
    function clk(data, r, c) {
      $("#txt").val("clk:" + $.toJSON(data) + "[" + r + ":" + c + "]");
    }
    function dblclk(data, r, c) {
      $("#txt").val("dblclk:" + $.toJSON(data) + "[" + r + ":" + c + "]");
    }
    $("#btn").click(function() {
      var v = $("#mytable").formobj({<a name="comp_table2_6"></a><img src="resources/callouts/6.png" alt="6" border="0">
        gridFilter : function(data, row) {
          return $("input:checkbox", row)[0].checked;
        }
      });
      alert($.toJSON(v));
    });
  });
<span class="hl-tag">&lt;/script&gt;</span>
<span class="hl-tag">&lt;/head&gt;</span>
<span class="hl-tag">&lt;body</span> <span class="hl-attribute">class</span>=<span class="hl-value">"body-pading"</span> <span class="hl-attribute">leftmargin</span>=<span class="hl-value">"0"</span> <span class="hl-attribute">topmargin</span>=<span class="hl-value">""</span> <span class="hl-attribute">marginwidth</span>=<span class="hl-value">"0"</span> <span class="hl-attribute">marginheight</span>=<span class="hl-value">"0"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;input</span> <span class="hl-attribute">id</span>=<span class="hl-value">"txt"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">size</span>=<span class="hl-value">"100"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;input</span> <span class="hl-attribute">id</span>=<span class="hl-value">"btn"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"button"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"取数"</span><span class="hl-tag">&gt;</span>
    <span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"classification"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"title"</span><span class="hl-tag">&gt;</span>grid示例<span class="hl-tag">&lt;/div&gt;</span>
        <span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"list"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"button_box clearfix"</span><span class="hl-tag">&gt;</span>
                <span class="hl-tag">&lt;table</span> <span class="hl-attribute">id</span>=<span class="hl-value">"mytable"</span> <span class="hl-attribute">style</span>=<span class="hl-value">"display: none"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;/table&gt;</span>
            <span class="hl-tag">&lt;/div&gt;</span>
        <span class="hl-tag">&lt;/div&gt;</span>
    <span class="hl-tag">&lt;/div&gt;</span>
    <span class="hl-tag">&lt;div</span> <span class="hl-attribute">id</span>=<span class="hl-value">"searchHTML"</span><span class="hl-tag">&gt;</span>
        组织ID：<span class="hl-tag">&lt;input</span> <span class="hl-attribute">name</span>=<span class="hl-value">"orgid"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span><span class="hl-tag"> /&gt;</span>组织名称<span class="hl-tag">&lt;input</span> <span class="hl-attribute">name</span>=<span class="hl-value">"orgname"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span><span class="hl-tag"> /&gt;</span>
    <span class="hl-tag">&lt;/div&gt;</span>
<span class="hl-tag">&lt;/body&gt;</span>
<span class="hl-tag">&lt;/html&gt;</span></pre>
                  
                  <div class="calloutlist">
                     <table border="0" summary="Callout list">
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_table2_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>自定义查询区域</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_table2_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>单击事件</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_table2_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>双击事件</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_table2_4"><img src="resources/callouts/4.png" alt="4" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>function rend(txt,data, r,
                                 c)，自定义渲染器，可以对单元格显示数据和样式进行加工展现，txt为渲染单元格文本，data为渲染行数据对象，r为行，c为列
                              </p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_table2_5"><img src="resources/callouts/5.png" alt="5" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>定义框架自动枚举转换规则，具体请参考“枚举组件”部分说明</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_table2_6"><img src="resources/callouts/6.png" alt="6" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>获取表格数据对象，用于ajax或其它处理操作</p>
                              
                              
                              <p>另外，还可以使用$("#mytable").ajaxgridData(objs)手工加载数据，objs结构为{ rows :
                                 [], page : 0, total : 0 }，rows为数据对象数组，page为页，total为总记录数
                              </p>
                              
                           </td>
                        </tr>
                     </table>
                  </div>
                  
                  
                  <div class="section" title="12.2.1.&nbsp;实例">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e2211"></a>12.2.1.&nbsp;实例
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>请参考：http://[host]:[port]/[context]/samples/test.do?method=testGrid</p>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="12.3.&nbsp;树组件">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e2214"></a>12.3.&nbsp;树组件
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>树组件包括同步、异步树支持，框架封装后的树组件实现最简单同步树的代码如下：</p>
                  
                  <pre class="programlisting">$(<span class="hl-string">"#simpleTree"</span>).tree({<a name="comp_tree1_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
    idKey : <span class="hl-string">"orgid"</span>,<a name="comp_tree1_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
    pIdKey : <span class="hl-string">"parentid"</span>,<a name="comp_tree1_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
    nameKey : <span class="hl-string">"orgname"</span><a name="comp_tree1_4"></a><img src="resources/callouts/4.png" alt="4" border="0">
});

&lt;div id=<span class="hl-string">"simpleTree"</span>&gt;&lt;/div&gt;<a name="comp_tree1_5"></a><img src="resources/callouts/5.png" alt="5" border="0">
                </pre>
                  
                  <div class="calloutlist">
                     <table border="0" summary="Callout list">
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree1_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>使用jquery插件的tree函数初始化树组件</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree1_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>数据对象的主键属性名称，默认值为id</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree1_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>数据对象的父对象主键属性名称，默认值为pId</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree1_4"><img src="resources/callouts/4.png" alt="4" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>显示名称的数据对象属性名，默认值为name</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree1_5"><img src="resources/callouts/5.png" alt="5" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>树组件展现元素</p>
                              
                           </td>
                        </tr>
                     </table>
                  </div>
                  
                  
                  <p>后台通过在controller中通过自动回填机制可以通过平台自动加载树中的数据，代码如下：</p>
                  
                  <pre class="programlisting">TestCRUDManager mgr = (TestCRUDManager) AppContext.getBean(<span class="hl-string">"testCRUDManager"</span>);
request.setAttribute(<span class="hl-string">"ffsimpleTree"</span>, mgr.testLoadAll());<a name="comp_tree1_5_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
                </pre>
                  
                  <div class="calloutlist">
                     <table border="0" summary="Callout list">
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree1_5_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>ff前缀表示要自动回填tree组件，后面的为要回填的tree元素id，值为查询某个树形关系表的列表数据，树组件会自动根据前端设置形成</p>
                              
                              
                              <p>树形结构，无需手工处理</p>
                              
                           </td>
                        </tr>
                     </table>
                  </div>
                  
                  
                  <p>简单同步树只需要上面几行代码即可实现，如果要在树上增加节点，可以执行如下代码，在当前选择的节点下增加一个新节点，如果没有选择则添加</p>
                  
                  
                  <p>到根节点</p>
                  
                  <pre class="programlisting"><span class="hl-keyword">var</span> nodes = $(<span class="hl-string">"#simpleTree"</span>).treeObj().getSelectedNodes();<a name="comp_tree3_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
<span class="hl-keyword">var</span> data = $(<span class="hl-string">"#addNode"</span>).formobj();
<span class="hl-keyword">if</span> (nodes.length &gt; <span class="hl-number">0</span>) {
    $(<span class="hl-string">"#simpleTree"</span>).treeObj().addNodes(nodes[<span class="hl-number">0</span>], data);<a name="comp_tree3_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
} <span class="hl-keyword">else</span> {
    $(<span class="hl-string">"#simpleTree"</span>).treeObj().addNodes(null, data);<a name="comp_tree3_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
}</pre>
                  
                  <div class="calloutlist">
                     <table border="0" summary="Callout list">
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree3_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>通过jquery插件的treeObj函数取得对象的getSelectedNodes()取得当前选中的节点列表</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree3_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>通过addNodes函数在指定节点下增加新的节点数据</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree3_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>第一个参数为null表示增加新节点到根</p>
                              
                           </td>
                        </tr>
                     </table>
                  </div>
                  
                  
                  <p>对于树组件的一些复杂功能如下代码所示：</p>
                  
                  <pre class="programlisting">&lt;script type=<span class="hl-string">"text/javascript"</span> language=<span class="hl-string">"javascript"</span>&gt;
  $().ready(<span class="hl-keyword">function</span>() {
    $(<span class="hl-string">"#tree"</span>).tree({
      onClick : clk,<a name="comp_tree4_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
      beforeDrag : beforeDrag,<a name="comp_tree4_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
      beforeDrop : beforeDrop,<a name="comp_tree4_3"></a><img src="resources/callouts/3.png" alt="3" border="0">
      managerName : <span class="hl-string">"testCRUDManager"</span>,<a name="comp_tree4_4"></a><img src="resources/callouts/4.png" alt="4" border="0">
      managerMethod : <span class="hl-string">"testLoadAll"</span>,<a name="comp_tree4_5"></a><img src="resources/callouts/5.png" alt="5" border="0">
      idKey : <span class="hl-string">"orgid"</span>,
      pIdKey : <span class="hl-string">"parentid"</span>,
      nameKey : <span class="hl-string">"orgname"</span>,
      enableCheck : true,<a name="comp_tree4_6"></a><img src="resources/callouts/6.png" alt="6" border="0">
      enableEdit : true,<a name="comp_tree4_7"></a><img src="resources/callouts/7.png" alt="7" border="0">
      enableRename : true,<a name="comp_tree4_8"></a><img src="resources/callouts/8.png" alt="8" border="0">
      enableRemove : true,<a name="comp_tree4_9"></a><img src="resources/callouts/9.png" alt="9" border="0">
      asyncParam : {<a name="comp_tree4_10"></a><img src="resources/callouts/10.png" alt="10" border="0">
        orgname : <span class="hl-string">'组织'</span>
      },
      nodeHandler : <span class="hl-keyword">function</span>(n) {<a name="comp_tree4_11"></a><img src="resources/callouts/11.png" alt="11" border="0">
        n.open = true;<a name="comp_tree4_12"></a><img src="resources/callouts/12.png" alt="12" border="0">
        <span class="hl-keyword">if</span> (n.data.orgid == <span class="hl-string">'1'</span>) {
          n.isParent = true;<a name="comp_tree4_13"></a><img src="resources/callouts/13.png" alt="13" border="0">
          <span class="hl-comment">//n.drag = false;</span>
          <span class="hl-comment">//n.drop = false;</span>
        }
        n.isParent = true;
      },
      render : <span class="hl-keyword">function</span>(name, data) {<a name="comp_tree4_14"></a><img src="resources/callouts/14.png" alt="14" border="0">
        <span class="hl-keyword">return</span> data.orgid + <span class="hl-string">" - "</span> + name;
      }
    });

    <span class="hl-keyword">function</span> clk(e, treeId, node) {
      alert($.toJSON(node.data));
      <span class="hl-comment">//node.children[0].data 取第0个子节点的数据对象</span>
    }

    <span class="hl-keyword">function</span> beforeDrag(treeId, treeNodes) {
      <span class="hl-keyword">if</span> (treeNodes[<span class="hl-number">0</span>].drag === false) {
        <span class="hl-keyword">return</span> false;
      }
      <span class="hl-keyword">return</span> true;
    }
    <span class="hl-keyword">function</span> beforeDrop(treeId, treeNodes, targetNode, moveType) {
      <span class="hl-keyword">return</span> targetNode ? targetNode.drop !== false : true;
    }

    $(<span class="hl-string">"#selectedBtn"</span>).click(<span class="hl-keyword">function</span>() {
      <span class="hl-keyword">var</span> nodes = $(<span class="hl-string">"#tree"</span>).treeObj().getSelectedNodes();<a name="comp_tree4_15"></a><img src="resources/callouts/15.png" alt="15" border="0">
      alert($.toJSON(nodes));
    });
    $(<span class="hl-string">"#checkedBtn"</span>).click(<span class="hl-keyword">function</span>() {
      <span class="hl-keyword">var</span> nodes = $(<span class="hl-string">"#tree"</span>).treeObj().getCheckedNodes();<a name="comp_tree4_16"></a>(<span class="hl-number">16</span>)
      alert($.toJSON(nodes));
    });

    $(<span class="hl-string">"#asyncBtn"</span>).click(<span class="hl-keyword">function</span>() {
      $(<span class="hl-string">"#tree"</span>).treeObj().reAsyncChildNodes(null, <span class="hl-string">"refresh"</span>);<a name="comp_tree4_17"></a>(<span class="hl-number">17</span>)
    });
  });
&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;input type=<span class="hl-string">"button"</span> id=<span class="hl-string">"selectedBtn"</span> value=<span class="hl-string">"已选择节点"</span>&gt;
&lt;input type=<span class="hl-string">"button"</span> id=<span class="hl-string">"checkedBtn"</span> value=<span class="hl-string">"已勾选节点"</span>&gt;
&lt;input type=<span class="hl-string">"button"</span> id=<span class="hl-string">"asyncBtn"</span> value=<span class="hl-string">"异步加载当前节点"</span>&gt;
&lt;div id=<span class="hl-string">"tree"</span>&gt;&lt;/div&gt;
&lt;/body&gt;</pre>
                  
                  <div class="calloutlist">
                     <table border="0" summary="Callout list">
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree4_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>onClick单击事件,function clk(e, treeId,
                                 node)，通过node.data可以取得点击节点的数据对象，node.children取得子节点数组
                              </p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree4_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>beforeDrag树节点拖拽前事件，function beforeDrag(treeId,
                                 treeNodes)，第二个参数为当前正在拖拽的节点数组（支持多节点拖拽），
                              </p>
                              
                              
                              <p>返回false取消此次拖拽</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree4_3"><img src="resources/callouts/3.png" alt="3" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>beforeDrop树节点拖拽后事件，function beforeDrop(treeId, treeNodes,
                                 targetNode, moveType) ，targetNode为目标节点，
                              </p>
                              
                              
                              <p>返回false取消此次拖拽</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree4_4"><img src="resources/callouts/4.png" alt="4" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>managerName，异步树加载Manager在spring中配置的bean id</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree4_5"><img src="resources/callouts/5.png" alt="5" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>managerMethod，异步树加载Manager的方法名，该Manager方法只允许有一个Map参数，用于接收查询参数，当前展开节点id将以idKey属性名传入，另外</p>
                              
                              
                              <p>还可以通过asyncParam配置其它异步树加载查询参数</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree4_6"><img src="resources/callouts/6.png" alt="6" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>enableCheck用于指定是否显示ckeckbox，默认为false</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree4_7"><img src="resources/callouts/7.png" alt="7" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>enableEdit用于指定是否允许树编辑，比如拖拽，修改节点名称，默认为false</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree4_8"><img src="resources/callouts/8.png" alt="8" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>enableRename用于指定是否允许树节点直接重命名，默认为false</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree4_9"><img src="resources/callouts/9.png" alt="9" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>enableRemove用于指定是否允许树节点直接删除，默认为false</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree4_10"><img src="resources/callouts/10.png" alt="10" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>asyncParam用于指定异步树加载时的其它定制查询参数</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree4_11"><img src="resources/callouts/11.png" alt="11" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>nodeHandler节点处理器，在树节点加载过程中可以对节点相关属性进行设置，比如是否为父节点，是否展开等</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree4_12"><img src="resources/callouts/12.png" alt="12" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>节点的open属性设置为true表示节点展开</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree4_13"><img src="resources/callouts/13.png" alt="13" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>节点的isParent属性设置为true表示该节点为可展开父节点，在enableAsync为true时，展开该节点将触发异步数据加载</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree4_14"><img src="resources/callouts/14.png" alt="14" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>render用于树节点展现渲染，function(name,
                                 data)，第一个参数为树节点显示名称，第二个参数为数据对象，返回值为渲染后的树节点
                              </p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree4_15"><img src="resources/callouts/15.png" alt="15" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>取得选择的节点列表</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree4_16">(16)</a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>取得选中checkbox的节点列表</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_tree4_17">(17)</a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>重新异步加载树节点，enableAsync为true时有效，reAsyncChildNodes(null,
                                 "refresh")，第一个参数为要重新加载的节点，null表示根
                              </p>
                              
                              
                              <p>节点，第二个参数为refresh表示强制重新加载，其它值则不强制加载</p>
                              
                           </td>
                        </tr>
                     </table>
                  </div>
                  
                  
                  <div class="section" title="12.3.1.&nbsp;实例">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e2312"></a>12.3.1.&nbsp;实例
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>请参考：http://[host]:[port]/[context]/samples/test.do?method=testTree</p>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="12.4.&nbsp;日期选择组件">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e2315"></a>12.4.&nbsp;日期选择组件
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p></p>
                  
                  
                  <div class="mediaobject"><img src="resources/images/basecomp_datepicker.jpg"></div>
                  
                  
                  <p>框架提供了方便的日期选择组件实现机制，例子代码如下：</p>
                  
                  <pre class="programlisting"><span class="hl-tag">&lt;input</span> <span class="hl-attribute">id</span>=<span class="hl-value">"mycal2"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"comp"</span> <span class="hl-attribute">comp</span>=<span class="hl-value">"type:'calendar',ifFormat:'%Y-%m-%d'"</span><span class="hl-tag">&gt;</span></pre>
                  
                  <p>只需要指定class为comp，并对comp属性进行组件设置，JSON对象数据格式(不含大括号)。type为calendar表示该组件为日历选择组件，将来还会扩展</p>
                  
                  
                  <p>为其它组件支持，比如选人组件等；其它参数为日期选择组件相关参数，例子中ifFormat为日期格式定义。框架将对该文本框自动处理为日期选择组件。</p>
                  
                  
                  <p>选择日期时间并显示时间的示例如下</p>
                  
                  <pre class="programlisting"><span class="hl-tag">&lt;input</span> <span class="hl-attribute">id</span>=<span class="hl-value">"mycal2"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"comp"</span> <span class="hl-attribute">comp</span>=<span class="hl-value">"type:'calendar',ifFormat:'%Y-%m-%d %H:%M',showsTime:true"</span><span class="hl-tag">&gt;</span></pre>
                  
                  <p></p>
                  
                  
                  <div class="section" title="12.4.1.&nbsp;实例">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e2329"></a>12.4.1.&nbsp;实例
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>请参考：http://[host]:[port]/[context]/samples/test.do?method=testComp</p>
                     
                  </div>
                  
               </div>
               
            </div>
            
            
            <div class="chapter" title="Chapter&nbsp;13.&nbsp;功能组件">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d5e2332"></a>Chapter&nbsp;13.&nbsp;功能组件
                        </h2>
                     </div>
                  </div>
               </div>
               <div class="toc">
                  <p><b>Table of Contents</b></p>
                  <dl>
                     <dt><span class="section"><a href="#d5e2334">13.1. 枚举组件</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e2362">13.1.1. 实例</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e2365">13.2. 选人组件</a></span></dt>
                     <dt><span class="section"><a href="#d5e2400">13.3. 文件管理组件</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e2407">13.3.1. 应用范围</a></span></dt>
                           <dt><span class="section"><a href="#d5e2413">13.3.2. 附件管理</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e2600">13.4. 正文编辑器</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e2609">13.4.1. 定义</a></span></dt>
                        </dl>
                     </dd>
                     <dt><span class="section"><a href="#d5e2616">13.5. 元数据组件</a></span></dt>
                     <dd>
                        <dl>
                           <dt><span class="section"><a href="#d5e2622">13.5.1. 功能</a></span></dt>
                           <dt><span class="section"><a href="#d5e2640">13.5.2. 开发步骤</a></span></dt>
                        </dl>
                     </dd>
                  </dl>
               </div>
               
               
               
               <div class="section" title="13.1.&nbsp;枚举组件">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e2334"></a>13.1.&nbsp;枚举组件
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>框架提供了方便的枚举组件，实现下拉枚举，枚举值文本替换功能，框架支持java枚举和数据库枚举组件两种类型。</p>
                  
                  
                  <p>对于java枚举支持，通过实现com.seeyon.ctp.common.code.EnumsCode接口的java枚举类，前端界面只需要通过如下方式进行下拉展现和枚举值转换：</p>
                  
                  <pre class="programlisting"><span class="hl-tag">&lt;select</span> <span class="hl-attribute">id</span>=<span class="hl-value">"testcode2"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"testcode2"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"codecfg"</span>
    <span class="hl-attribute">codecfg</span>=<span class="hl-value">"codeType:'java',codeId:'com.seeyon.apps.samples.test.enums.MyEnums',defaultValue:4"</span><span class="hl-tag">&gt;</span><a name="comp_enum1_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
    <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">""</span><span class="hl-tag">&gt;</span>请选择1...<span class="hl-tag">&lt;/option&gt;</span>
<span class="hl-tag">&lt;/select&gt;</span>
<span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"codecfg"</span> <span class="hl-attribute">codecfg</span>=<span class="hl-value">"codeType:'java',codeId:'com.seeyon.apps.samples.test.enums.MyEnums'"</span><span class="hl-tag">&gt;</span>6<span class="hl-tag">&lt;/div&gt;</span><a name="comp_enum1_2"></a><img src="resources/callouts/2.png" alt="2" border="0"></pre>
                  
                  <div class="calloutlist">
                     <table border="0" summary="Callout list">
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_enum1_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>对select进行自动java枚举加载，需配置class为codecfg，同时配置codecfg属性为枚举相关配置，指定codeType为java则表示采用java枚举，</p>
                              
                              
                              <p>codeId配置java枚举实现类</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_enum1_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>对div或任意元素内部文本进行java枚举值转换</p>
                              
                           </td>
                        </tr>
                     </table>
                  </div>
                  
                  
                  <p>java枚举类必须实现com.seeyon.ctp.common.code.EnumsCode接口，该接口主要定义了getValue和getText两个方法，用于前端枚举值引用和显示，</p>
                  
                  
                  <p>枚举实现类代码例子如下：</p>
                  
                  <pre class="programlisting"><span class="hl-keyword">public</span> enum MyEnums <span class="hl-keyword">implements</span> EnumsCode {

    enum0(<span class="hl-number">0</span>, <span class="hl-string">"枚举0"</span>), 
    enum1(<span class="hl-number">1</span>, <span class="hl-string">"枚举1"</span>), 
    enum2(<span class="hl-number">2</span>, <span class="hl-string">"枚举2"</span>), 
    enum3(<span class="hl-number">3</span>, <span class="hl-string">"枚举3"</span>), 
    enum4(<span class="hl-number">4</span>, <span class="hl-string">"枚举4"</span>), 
    enum5(<span class="hl-number">5</span>, <span class="hl-string">"枚举5"</span>), 
    enum6(<span class="hl-number">6</span>, <span class="hl-string">"枚举6"</span>);

    <span class="hl-keyword">private</span> <span class="hl-keyword">int</span>    key;
    <span class="hl-keyword">private</span> String text;

    MyEnums(<span class="hl-keyword">int</span> key, String text) {
        <span class="hl-keyword">this</span>.key = key;
        <span class="hl-keyword">this</span>.text = text;
    }

    <span class="hl-keyword">public</span> <span class="hl-keyword">int</span> getKey() {
        <span class="hl-keyword">return</span> key;
    }

    <span class="hl-keyword">public</span> String getText() {
        <span class="hl-keyword">return</span> text;
    }

    <span class="hl-keyword">public</span> String getValue() {
        <span class="hl-keyword">return</span> String.valueOf(key);
    }
}</pre>
                  
                  <p></p>
                  
                  
                  <p>基于数据库枚举组件的例子代码如下（不指定codeType默认为加载数据库枚举，对应ctp_enum_item表）：</p>
                  
                  <pre class="programlisting"><span class="hl-tag">&lt;select</span> <span class="hl-attribute">id</span>=<span class="hl-value">"testcode1"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"testcode1"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"codecfg"</span>
  <span class="hl-attribute">codecfg</span>=<span class="hl-value">"codeId:'test_code',defaultValue:'2'"</span><span class="hl-tag">&gt;</span><a name="comp_enum2_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
  <span class="hl-tag">&lt;option</span> <span class="hl-attribute">value</span>=<span class="hl-value">""</span><span class="hl-tag">&gt;</span>请选择1...<span class="hl-tag">&lt;/option&gt;</span>
<span class="hl-tag">&lt;/select&gt;</span>

<span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"codecfg"</span> <span class="hl-attribute">codecfg</span>=<span class="hl-value">"codeId:'test_code'"</span><span class="hl-tag">&gt;</span>2<span class="hl-tag">&lt;/div&gt;</span><a name="comp_enum2_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
                </pre>
                  
                  <div class="calloutlist">
                     <table border="0" summary="Callout list">
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_enum2_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>对select进行自动枚举加载，需配置class为codecfg，同时配置codecfg属性为枚举相关配置，只需要配置codeId属性用于指定要加载的枚举标识</p>
                              
                           </td>
                        </tr>
                        <tr>
                           <td width="5%" valign="top" align="left">
                              <p><a href="#comp_enum2_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                              </p>
                           </td>
                           <td valign="top" align="left">
                              
                              <p>对div或任意元素内部文本进行枚举值转换</p>
                              
                           </td>
                        </tr>
                     </table>
                  </div>
                  
                  
                  <p>另外，还可对表格列数据进行枚举转换，例子代码如下：</p>
                  
                  <pre class="programlisting">$(<span class="hl-string">"#mytable"</span>).ajaxgrid({
  colModel : [ {
    display : <span class="hl-string">'父组织ID'</span>,
    name : <span class="hl-string">'parentid'</span>,
    width : <span class="hl-string">'180'</span>,
    sortable : true,
    align : <span class="hl-string">'left'</span>,
    codecfg : <span class="hl-string">"codeId:'test_code'"</span>
  } ],
  managerName : <span class="hl-string">"testPagingManager"</span>,
  managerMethod : <span class="hl-string">"testPaging"</span>
});</pre>
                  
                  <div class="section" title="13.1.1.&nbsp;实例">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e2362"></a>13.1.1.&nbsp;实例
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>请参考：http://[host]:[port]/[context]/samples/test.do?method=testCode</p>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="13.2.&nbsp;选人组件">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e2365"></a>13.2.&nbsp;选人组件
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p></p>
                  
                  
                  <p>框架目前提供了简单的选人界面包装，可以通过下面的HTML定义选人组件</p>
                  
                  <pre class="programlisting"><span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"spc2"</span> <span class="hl-attribute">name</span>=<span class="hl-value">"spc1"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"comp"</span> 
    <span class="hl-attribute">comp</span>=<span class="hl-value">"type:'selectPeople',mode:'open',value:'Department | -884316703172445_1,Member | 1730833917365171641',text:'开发中心、人员2'"</span><span class="hl-tag">/&gt;</span></pre><p>支持的comp属性如下</p>
                  
                  
                  <div class="informaltable">
                     
                     <table border="1">
                        <colgroup>
                           <col width="33%">
                           <col width="33%">
                           <col width="34%">
                        </colgroup>
                        <thead>
                           <tr>
                              <th align="center">属性</th>
                              <th align="center">说明</th>
                              <th align="center">实例</th>
                           </tr>
                        </thead>
                        <tbody>
                           <tr>
                              <td>type</td>
                              <td>'selectPeople'</td>
                              <td>type:'selectPeople'</td>
                           </tr>
                           <tr>
                              <td>value</td>
                              <td>值为SPD字符串</td>
                              <td>value:'Member|123456,Department|23456'</td>
                           </tr>
                           <tr>
                              <td>&nbsp;</td>
                              <td>也可以是JS变量</td>
                              <td>value:expr1
                                 options:{maxSize:1,showOriginal:true,showAccountShortname:true}
                              </td>
                           </tr>
                           <tr>
                              <td>text</td>
                              <td>选人显示值</td>
                              <td>如'开发中心、人员2'</td>
                           </tr>
                           <tr>
                              <td>mode</td>
                              <td>选人弹出方式，缺省以div方式打开；mode:'open'时以模态对话框方式打开</td>
                              <td>&nbsp;</td>
                           </tr>
                        </tbody>
                     </table>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="13.3.&nbsp;文件管理组件">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e2400"></a>13.3.&nbsp;文件管理组件
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>文件管理组件针对的目标是文件，仅仅完成文件的操作，而不涉及内容。</p>
                  
                  
                  <p>内容管理模块的目标是内容，内容的载体可能是文件，也可能是页面，或数据库中的数据；内容管理涉及到权限、共享、发布、存档...等操作。</p>
                  
                  
                  <p>物理存储有文件和文件夹的真实名称和路径，内容管理模块可能对应有逻辑意义的档案名和类属名。</p>
                  
                  
                  <p>文件管理组件除了为内容管理组件提供底层的支持，还要为协 同附件等功能提供服务，所以在文件存储映射上应以物理存储为准。</p>
                  
                  
                  <p></p>
                  
                  
                  <div class="section" title="13.3.1.&nbsp;应用范围">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e2407"></a>13.3.1.&nbsp;应用范围
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <div class="epigraph">
                        <p>协同、公文系统各应用的office正文、附件、图片/Flash的管理</p>
                        <p>应用的office正文、附件、图片必须使用该组件进行统一存储</p>
                        <p>文档管理/知识管理应用的用户上载文件的管理</p>
                     </div>
                     
                  </div>
                  
                  
                  <div class="section" title="13.3.2.&nbsp;附件管理">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e2413"></a>13.3.2.&nbsp;附件管理
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>附件组件的使用分为前端和后端，前两部分配合使用才能实现完整的附件相关功能。前端负责界面展现，后端负责附件的保存、获取相关逻辑。在开发时需要分别编写前、后端代码。</p>
                     
                     
                     <p>附件上传包含两种情况：</p>
                     
                     
                     <p></p>
                     
                     
                     <div class="itemizedlist">
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>附件标准上传过程：即打开附件上传提示窗口，上传附件，上传完成后关闭弹出窗口，返回到调用页。调用页继续处理其他页面功能。</p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     <div class="itemizedlist">
                        <ul class="itemizedlist" type="disc">
                           <li class="listitem">
                              
                              <p>附件上传扩展过程：适用于上传、解析后不在使用该文件。即上传后对该文件直接解析处理，并不返回调用页，在调用者处理完后返回自己期望的页面。</p>
                              
                           </li>
                        </ul>
                     </div>
                     
                     
                     <div class="section" title="13.3.2.1.&nbsp;附件上传标准过程">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d5e2424"></a>13.3.2.1.&nbsp;附件上传标准过程
                                 </h4>
                              </div>
                           </div>
                        </div>
                        
                        
                        
                        <p></p>
                        
                        
                        <div class="section" title="13.3.2.1.1.&nbsp;前端">
                           <div class="titlepage">
                              <div>
                                 <div>
                                    <h5 class="title"><a name="d5e2427"></a>13.3.2.1.1.&nbsp;前端
                                    </h5>
                                 </div>
                              </div>
                           </div>
                           
                           
                           
                           <p>调用过程分为两步：</p>
                           
                           
                           <p>1、声明一个附件上传组件；</p>
                           
                           
                           <p>2、在对应的菜单或者按钮上调用 insertAttachment() 方法</p>
                           
                           <pre class="programlisting">
&lt;input id="myfile" type="text" class="comp" comp="type:'fileupload',applicationCategory:'1',canDeleteOriginalAtts:false,originalAttsNeedClone:false"
 attsdata='${ attachmentsJSON}'&gt;<a name="comp_fileupload_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
&lt;input type="button" onclick="insertAttachment()" value="上传附件"&gt;  <a name="comp_fileupload_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
                    </pre>
                           
                           <div class="calloutlist">
                              <table border="0" summary="Callout list">
                                 <tr>
                                    <td width="5%" valign="top" align="left">
                                       <p><a href="#comp_fileupload_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                       </p>
                                    </td>
                                    <td valign="top" align="left">
                                       
                                       <p>注意comp属性值为："type:'fileupload'"</p>
                                       
                                    </td>
                                 </tr>
                                 <tr>
                                    <td width="5%" valign="top" align="left">
                                       <p><a href="#comp_fileupload_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                       </p>
                                    </td>
                                    <td valign="top" align="left">
                                       
                                       <p>调用insertAttachment()显示上传界面</p>
                                       
                                       
                                       <p>支持如下属性：</p>
                                       
                                       
                                       <div class="informaltable">
                                          
                                          <table border="1">
                                             <colgroup>
                                                <col width="33%">
                                                <col width="33%">
                                                <col width="34%">
                                             </colgroup>
                                             <thead>
                                                <tr>
                                                   <th align="center">属性</th>
                                                   <th align="center">说明</th>
                                                   <th align="center">实例</th>
                                                </tr>
                                             </thead>
                                             <tbody>
                                                <tr>
                                                   <td>type</td>
                                                   <td>指当前为上传文件组件，值为固定值</td>
                                                   <td>type:'fileupload</td>
                                                </tr>
                                                <tr>
                                                   <td>attsdata</td>
                                                   <td>指原有的附件，如：协同保存待发—新建，需要把原有的附件显示</td>
                                                   <td>attsdata='${ attachmentsJSON}'</td>
                                                </tr>
                                                <tr>
                                                   <td>applicationCategory</td>
                                                   <td>应用分类，统一在ApplicationCategoryEnum定义</td>
                                                   <td>applicationCategory:'1'</td>
                                                </tr>
                                                <tr>
                                                   <td>canDeleteOriginalAtts</td>
                                                   <td>指能否删除原有的附件，如转发协同不能删除原有附件</td>
                                                   <td>canDeleteOriginalAtts:false</td>
                                                </tr>
                                                <tr>
                                                   <td>originalAttsNeedClone</td>
                                                   <td>是否需要复制原有附件，常用在模板调用</td>
                                                   <td>originalAttsNeedClone:false</td>
                                                </tr>
                                                <tr>
                                                   <td>extensions</td>
                                                   <td>允许上传的文件类型，用文件会后缀表示，多个类型用逗号分隔（,）</td>
                                                   <td>extensions:'txt,jpg'</td>
                                                </tr>
                                                <tr>
                                                   <td>isEncrypt</td>
                                                   <td>对上传的文件是否加密，true为加密；false为不加密</td>
                                                   <td>isEncrypt:false</td>
                                                </tr>
                                                <tr>
                                                   <td>quantity</td>
                                                   <td>最多上传文件个数，不使用该参数事默认是5</td>
                                                   <td>quantity:1</td>
                                                </tr>
                                             </tbody>
                                          </table>
                                          
                                       </div>
                                       
                                    </td>
                                 </tr>
                              </table>
                           </div>
                           
                           
                           <p>实例</p>
                           
                           
                           <p>请参考：http://[host]:[port]/[context]/demo/filemanagement/filecomp.jsp</p>
                           
                        </div>
                        
                        
                        <div class="section" title="13.3.2.1.2.&nbsp;后端">
                           <div class="titlepage">
                              <div>
                                 <div>
                                    <h5 class="title"><a name="d5e2484"></a>13.3.2.1.2.&nbsp;后端
                                    </h5>
                                 </div>
                              </div>
                           </div>
                           
                           
                           
                           <p>后端负责对附件信息的存储。应用于附件的关联关系存储在附件表中。</p>
                           
                           <pre class="programlisting">  <span class="hl-doctype">/** 
    * 该方法与前端组件配合使用，在request中必须有的Parameter：String[] fileUrl, 
    * String[] mimeType, String[] size, String[] createdate, String[] filename, 
    * String[] type, String[] needClone 
    *    
    * @param category  所属应用分类 
    * @param reference  主题Id，如协同的Id 
    * @param subReference   二级主题Id，如协同的回复Id，如果当前是给协同上传附件，则
该subReference 与  reference相同 
    * @param request 
    *  @return 附件类型任意组合  如："012"、"12"、"01"、"02"; 其中  0-文件附件  1-图片  2-
关联文  ,排列无序 
    * @see com.seeyon.ctp.common.filemanager.Constants.ATTACHMENT_TYPE_FILE 
    * @see com.seeyon.ctp.common.filemanager.Constants.isUploadLocaleFile(String) 
    * @throws Exception 
    */</span> 
  <span class="hl-keyword">public</span> String create(ApplicationCategoryEnum category, Long reference, 
      Long subReference, HttpServletRequest request) <span class="hl-keyword">throws</span> Exception; 
      String attaFlag = <span class="hl-keyword">this</span>.attachmentManager.create(ApplicationCategoryEnum.collaboration, 
                        colSummary.getId(), colSummary.getId(), request); 
      <span class="hl-keyword">if</span>(com.seeyon.v3x.common.filemanager.Constants.isUploadLocaleFile(attaFlag)){ 
               colSummary.setHasAttachments(true); 
       } </pre>
                           </div>
                        
                     </div>
                     
                     
                     <div class="section" title="13.3.2.2.&nbsp;附件上传扩展过程">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d5e2488"></a>13.3.2.2.&nbsp;附件上传扩展过程
                                 </h4>
                              </div>
                           </div>
                        </div>
                        
                        
                        
                        <p>扩展过程目的是为后端返回文件对象，后端程序获得文件对象后可自行解析处理。</p>
                        
                        
                        <p>假设有如下场景：</p>
                        
                        
                        <p>需要把通讯录导入到系统中。处理逻辑为：</p>
                        
                        
                        <div class="itemizedlist">
                           <ul class="itemizedlist" type="disc">
                              <li class="listitem">
                                 
                                 <p>上传通讯录文件</p>
                                 
                              </li>
                           </ul>
                        </div>
                        
                        
                        <div class="itemizedlist">
                           <ul class="itemizedlist" type="disc">
                              <li class="listitem">
                                 
                                 <p>解析通讯录文件</p>
                                 
                              </li>
                           </ul>
                        </div>
                        
                        
                        <div class="itemizedlist">
                           <ul class="itemizedlist" type="disc">
                              <li class="listitem">
                                 
                                 <p>持久化解析后的数据</p>
                                 
                              </li>
                           </ul>
                        </div>
                        
                        
                        <div class="itemizedlist">
                           <ul class="itemizedlist" type="disc">
                              <li class="listitem">
                                 
                                 <p>返回页面，告知用户成功或失败信息。</p>
                                 
                              </li>
                           </ul>
                        </div>
                        
                        
                        <p>从上面过程看，从第二部之后与福建上传的标准过程不同。</p>
                        
                        
                        <div class="section" title="13.3.2.2.1.&nbsp;前端">
                           <div class="titlepage">
                              <div>
                                 <div>
                                    <h5 class="title"><a name="d5e2506"></a>13.3.2.2.1.&nbsp;前端
                                    </h5>
                                 </div>
                              </div>
                           </div>
                           
                           
                           
                           <p>前端调用过程分为4步：</p>
                           
                           <pre class="programlisting"><span class="hl-tag">&lt;script</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text/javascript"</span><span class="hl-tag">&gt;</span>
<span class="hl-comment">&lt;!--
……
//附件上传后回调方法
function testCallBack(fileid){</span><a name="comp_fileupload_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
  //处理文件逻辑的action
  location.href="/t1/fileController.do?fileid="+fileid;  <a name="comp_fileupload_1"></a><img src="resources/callouts/2.png" alt="2" border="0">
}
//--&gt;
<span class="hl-tag">&lt;/script&gt;</span>
……
        <span class="hl-tag">&lt;input</span> <span class="hl-attribute">id</span>=<span class="hl-value">"myfile"</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"comp"</span> <span class="hl-attribute">comp</span>=<span class="hl-value">"type:'fileupload'"</span><span class="hl-tag">&gt;</span> <a name="comp_fileupload_1"></a><img src="resources/callouts/3.png" alt="3" border="0">
        <span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"button"</span> <span class="hl-attribute">onclick</span>=<span class="hl-value">"insertAttachment('testCallBack')"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"上传附件"</span><span class="hl-tag">&gt;</span>  <a name="comp_fileupload_2"></a><img src="resources/callouts/4.png" alt="4" border="0">
                    </pre>
                           
                           <div class="calloutlist">
                              <table border="0" summary="Callout list">
                                 <tr>
                                    <td width="5%" valign="top" align="left">
                                       <p><a href="#comp_fileupload_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                       </p>
                                    </td>
                                    <td valign="top" align="left">
                                       
                                       <p>增加回调方法，回调时会传入文件的id，需要把该id传入到目标action中。</p>
                                       
                                    </td>
                                 </tr>
                                 <tr>
                                    <td width="5%" valign="top" align="left">
                                       <p><a href="#comp_fileupload_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                       </p>
                                    </td>
                                    <td valign="top" align="left">
                                       
                                       <p>在此方法中请求处理文件的action</p>
                                       
                                    </td>
                                 </tr>
                                 <tr>
                                    <td width="5%" valign="top" align="left">
                                       <p><a href="#comp_fileupload_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                       </p>
                                    </td>
                                    <td valign="top" align="left">
                                       
                                       <p>声明文件上传标记。注意comp属性值为："type:'fileupload'"</p>
                                       
                                    </td>
                                 </tr>
                                 <tr>
                                    <td width="5%" valign="top" align="left">
                                       <p><a href="#comp_fileupload_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                       </p>
                                    </td>
                                    <td valign="top" align="left">
                                       
                                       <p>insertAttachment('testCallBack')使用该方法打开附件上传界面，并且传入回调方法名，不需要该方法的参数。</p>
                                       
                                    </td>
                                 </tr>
                              </table>
                           </div>
                           
                           
                           <p>实例</p>
                           
                           
                           <p>请参考：http://[host]:[port]/[context]/demo/filemanagement/filecomp.jsp</p>
                           
                        </div>
                        
                        
                        <div class="section" title="13.3.2.2.2.&nbsp;后端">
                           <div class="titlepage">
                              <div>
                                 <div>
                                    <h5 class="title"><a name="d5e2525"></a>13.3.2.2.2.&nbsp;后端
                                    </h5>
                                 </div>
                              </div>
                           </div>
                           
                           
                           
                           <p>后端负责对附件信息的存储。应用于附件的关联关系存储在附件表中。</p>
                           
                           <pre class="programlisting">    <span class="hl-keyword">public</span> ModelAndView index(HttpServletRequest request, HttpServletResponse response) <span class="hl-keyword">throws</span> Exception {
        ModelAndView modelAndView = <span class="hl-keyword">new</span> ModelAndView(<span class="hl-string">"apps/file/selfupload"</span>);
        File file=fileManager.getFile(Long.parseLong(request.getParameter(<span class="hl-string">"fileid"</span>)),<span class="hl-keyword">new</span> Date());<a name="comp_fileupload_2_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
        <span class="hl-comment">//对得到的文件进行处理</span>
        <span class="hl-comment">//…… </span><a name="comp_fileupload_2_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
        modelAndView.addObject(<span class="hl-string">"filename"</span>, file.getName());
        modelAndView.addObject(<span class="hl-string">"filelength"</span>, file.length());
        <span class="hl-keyword">return</span> modelAndView;
    }</pre>
                           
                           <div class="calloutlist">
                              <table border="0" summary="Callout list">
                                 <tr>
                                    <td width="5%" valign="top" align="left">
                                       <p><a href="#comp_fileupload_2_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                       </p>
                                    </td>
                                    <td valign="top" align="left">
                                       
                                       <p>获取前端传来的文件id，并调用 fileManager getFile(Long fileId, Date
                                          createDate) 方法获取该文件，时间为当前即可。
                                       </p>
                                       
                                    </td>
                                 </tr>
                                 <tr>
                                    <td width="5%" valign="top" align="left">
                                       <p><a href="#comp_fileupload_2_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                       </p>
                                    </td>
                                    <td valign="top" align="left">
                                       
                                       <p>在此处处理该文件。</p>
                                       
                                    </td>
                                 </tr>
                              </table>
                           </div>
                           
                        </div>
                        
                     </div>
                     
                     
                     <div class="section" title="13.3.2.3.&nbsp;附件下载">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d5e2537"></a>13.3.2.3.&nbsp;附件下载
                                 </h4>
                              </div>
                           </div>
                        </div>
                        
                        
                        
                        <p></p>
                        
                        
                        <div class="section" title="13.3.2.3.1.&nbsp;前端">
                           <div class="titlepage">
                              <div>
                                 <div>
                                    <h5 class="title"><a name="d5e2540"></a>13.3.2.3.1.&nbsp;前端
                                    </h5>
                                 </div>
                              </div>
                           </div>
                           
                           
                           
                           <p>调用过程分为两步：</p>
                           
                           
                           <p>1、声明一个附件数据标记；</p>
                           
                           
                           <p>2、在需要显示的地方声明显示标记；</p>
                           
                           <pre class="programlisting">
&lt;input id="myfile" class="comp" comp="type:'attachlist'" attsdata='${ attachmentsJSON}'&gt; <a name="comp_fileupload_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
&lt;input id="myfile2"  class="comp" comp="type:'showattachlist', subRef:'3', atttype:'0', attachmentTrId:'attachmentTr2', numberDivId:'attachmentNumberDiv',"&gt;
 <a name="comp_fileupload_2"></a><img src="resources/callouts/2.png" alt="2" border="0">
                    </pre>
                           
                           <div class="calloutlist">
                              <table border="0" summary="Callout list">
                                 <tr>
                                    <td width="5%" valign="top" align="left">
                                       <p><a href="#comp_fileupload_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                       </p>
                                    </td>
                                    <td valign="top" align="left">
                                       
                                       <p>附件数据标记：注意comp属性值为："type:'attachlist'"</p>
                                       
                                    </td>
                                 </tr>
                                 <tr>
                                    <td width="5%" valign="top" align="left">
                                       <p><a href="#comp_fileupload_2"><img src="resources/callouts/2.png" alt="2" border="0"></a> 
                                       </p>
                                    </td>
                                    <td valign="top" align="left">
                                       
                                       <p>在需要显示的地方声明显示标记</p>
                                       
                                       
                                       <p>支持如下属性：</p>
                                       
                                       
                                       <div class="informaltable">
                                          
                                          <table border="1">
                                             <colgroup>
                                                <col width="33%">
                                                <col width="33%">
                                                <col width="34%">
                                             </colgroup>
                                             <thead>
                                                <tr>
                                                   <th align="center">属性</th>
                                                   <th align="center">说明</th>
                                                   <th align="center">实例</th>
                                                </tr>
                                             </thead>
                                             <tbody>
                                                <tr>
                                                   <td>type</td>
                                                   <td>attachlist为附件数据标记；showattachlist为附件显示标记</td>
                                                   <td>type:'attachlist'；type:'showattachlist’</td>
                                                </tr>
                                                <tr>
                                                   <td>attsdata</td>
                                                   <td>指附件数据，为JSON格式。</td>
                                                   <td>attsdata='${ attachmentsJSON}'</td>
                                                </tr>
                                                <tr>
                                                   <td>subRef</td>
                                                   <td>subReferenceId 对应数据的Id</td>
                                                   <td>subRef:'3',</td>
                                                </tr>
                                                <tr>
                                                   <td>atttype</td>
                                                   <td>附件type对应的值</td>
                                                   <td>atttype:'0',</td>
                                                </tr>
                                                <tr>
                                                   <td>attachmentTrId</td>
                                                   <td>显示附件所在的node的id</td>
                                                   <td>attachmentTrId:'attachmentTr2',</td>
                                                </tr>
                                                <tr>
                                                   <td>numberDivId</td>
                                                   <td>显示附件数量的node id</td>
                                                   <td>numberDivId:'attachmentNumberDiv'</td>
                                                </tr>
                                             </tbody>
                                          </table>
                                          
                                       </div>
                                       
                                    </td>
                                 </tr>
                              </table>
                           </div>
                           
                           
                           <p>示例：</p>
                           
                           
                           <p></p>
                           
                           <pre class="programlisting"><span class="hl-tag">&lt;body&gt;</span>
src=${ attachmentsJSON}<span class="hl-tag">&lt;br&gt;</span>
<span class="hl-tag">&lt;%--</span> <span class="hl-attribute">老A8方式：&lt;v3x:attachmentDefine</span> <span class="hl-attribute">attachments</span>=<span class="hl-value">"${attachments}"</span><span class="hl-tag"> /&gt;</span>  --%&gt;
 <span class="hl-tag">&lt;input</span> <span class="hl-attribute">id</span>=<span class="hl-value">"myfile"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"comp"</span> <span class="hl-attribute">comp</span>=<span class="hl-value">"type:'attachlist'"</span> <span class="hl-attribute">attsdata</span>=<span class="hl-value">'${ attachmentsJSON}'</span><span class="hl-tag">&gt;</span>
<span class="hl-tag">&lt;br&gt;</span>
<span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"div-float"</span><span class="hl-tag">&gt;</span>(<span class="hl-tag">&lt;span</span> <span class="hl-attribute">id</span>=<span class="hl-value">"attachmentNumberDiv"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;/span&gt;</span>个)<span class="hl-tag">&lt;/div&gt;</span>
<span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"div-float attsContent"</span> <span class="hl-attribute">style</span>=<span class="hl-value">"width:98%; display:none"</span>  <span class="hl-attribute">id</span>=<span class="hl-value">"attachmentTr2"</span><span class="hl-tag"> &gt;</span><span class="hl-tag">&lt;/div&gt;</span>
<span class="hl-tag">&lt;input</span> <span class="hl-attribute">id</span>=<span class="hl-value">"myfile2"</span>  <span class="hl-attribute">class</span>=<span class="hl-value">"comp"</span> <span class="hl-attribute">comp</span>=<span class="hl-value">"type:'showattachlist', subRef:'3', atttype:'0', attachmentTrId:'attachmentTr2', numberDivId:'attachmentNumberDiv',"</span><span class="hl-tag">&gt;</span>

<span class="hl-tag">&lt;/body&gt;</span></pre>
                           
                           <p>实例</p>
                           
                           
                           <p>请参考：http://[host]:[port]/[context]/demo/apps/file/inituploadfile.jsp</p>
                           
                        </div>
                        
                        
                        <div class="section" title="13.3.2.3.2.&nbsp;后端">
                           <div class="titlepage">
                              <div>
                                 <div>
                                    <h5 class="title"><a name="d5e2592"></a>13.3.2.3.2.&nbsp;后端
                                    </h5>
                                 </div>
                              </div>
                           </div>
                           
                           
                           
                           <p>主要负责获取附件数据，根据业务id获取对应的附件列表，返回类型要求是JSON字符串。</p>
                           
                           
                           <p>接口方法为：attachmentManager.getAttListJSON(主数据Id)</p>
                           
                           
                           <p>注意：同一主题的所有附件一次性抽取，通过subRefenerce区分，</p>
                           
                           
                           <p>如：计划主题与计划回复 的附件一次按照计划Id 抽取</p>
                           
                           
                           <p>示例：</p>
                           
                           <pre class="programlisting">          ModelAndView modelAndView = <span class="hl-keyword">new</span> ModelAndView(<span class="hl-string">"apps/file/inituploadfile"</span>);
        ……
        modelAndView.addObject(<span class="hl-string">"attachmentsJSON"</span>, attachmentManager.getAttListJSON(<span class="hl-number">2L</span>));
        <span class="hl-keyword">return</span> modelAndView;</pre>
                           </div>
                        
                     </div>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="13.4.&nbsp;正文编辑器">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e2600"></a>13.4.&nbsp;正文编辑器
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>提供可视化的HTML编辑支持。</p>
                  
                  
                  <p></p>
                  
                  
                  <div class="mediaobject"><img src="resources/images/basecomp_htmleditor.jpg"></div>
                  
                  
                  <p></p>
                  
                  
                  <p></p>
                  
                  
                  <div class="section" title="13.4.1.&nbsp;定义">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e2609"></a>13.4.1.&nbsp;定义
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     <pre class="programlisting"><span class="hl-tag">&lt;textarea</span> <span class="hl-attribute">id</span>=<span class="hl-value">"fck1"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"comp"</span> <span class="hl-attribute">comp</span>=<span class="hl-value">"type:'editor',contentType:'html'"</span><span class="hl-tag">&gt;</span>正文<span class="hl-tag">&lt;/textarea&gt;</span></pre>
                     
                     <p></p>
                     
                     
                     <p></p>
                     
                     
                     <p></p>
                     
                  </div>
                  
               </div>
               
               
               <div class="section" title="13.5.&nbsp;元数据组件">
                  <div class="titlepage">
                     <div>
                        <div>
                           <h2 class="title" style="clear: both"><a name="d5e2616"></a>13.5.&nbsp;元数据组件
                           </h2>
                        </div>
                     </div>
                  </div>
                  
                  
                  
                  <p>元数据管理应用实体的metadata。</p>
                  
                  
                  <p>metadata通俗的解释为关于数据的数据，系统中的元数据管理承担了数据库的数据表、字段定义的部分职责（表字段英文名称、显示的中文名称、值编辑的控件、引用关系和枚举翻译等）。</p>
                  
                  
                  <p>如果真正做到完全的元数据管理，可以无需硬编码，基于元数据管理界面和引擎，从无到有，生成一系列应用数据的增删改查功能。</p>
                  
                  
                  <p>由于我们的表单本身就是一个元数据管理引擎，鉴于协同应用的特点，我们不去做ERP/HR那样完全的元数据管理，只提供对系统实体预留字段的扩展管理（维护显示名称、值编辑控件）。</p>
                  
                  
                  <div class="section" title="13.5.1.&nbsp;功能">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e2622"></a>13.5.1.&nbsp;功能
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <div class="orderedlist">
                        <ol class="orderedlist" type="1">
                           <li class="listitem">
                              
                              <p>管理指定表部分字段的元数据</p>
                              
                              
                              <p>维护字段显示名称、值编辑字段等信息，体现在实体列表和单一实体的新建、修改和查看页面中。</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>不负责Create Table和Alter Table的相关操作</p>
                              
                              
                              <p>只解释表字段，不管理数据库，字段需要开发人员自建</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>与自动回填和提交平滑对接</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>不提供元数据的管理页面</p>
                              
                              
                              <p>开发人员通过配置文件或数据库维护元数据</p>
                              
                           </li>
                           <li class="listitem">
                              
                              <p>支持不同产品线实体管理页面的差异需求</p>
                              
                              
                              <p>政务和A8的新建人员页面字段个数可以不同，对同一字段可以有不同的解释（显示、控件）</p>
                              
                              
                              <p>举例：政务要用duty替换level，标准产品可以把duty和level两个字段纳入元数据管理中，在新建页面动态控制显示。</p>
                              
                           </li>
                        </ol>
                     </div>
                     
                  </div>
                  
                  
                  <div class="section" title="13.5.2.&nbsp;开发步骤">
                     <div class="titlepage">
                        <div>
                           <div>
                              <h3 class="title"><a name="d5e2640"></a>13.5.2.&nbsp;开发步骤
                              </h3>
                           </div>
                        </div>
                     </div>
                     
                     
                     
                     <p>本组件只在框架内部使用，应用如果有需求请申请。</p>
                     
                     
                     <div class="section" title="13.5.2.1.&nbsp;定义元数据配置">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d5e2643"></a>13.5.2.1.&nbsp;定义元数据配置
                                 </h4>
                              </div>
                           </div>
                        </div>
                        
                        
                        
                        <p>在cfgHome/metadata或cfgHome/plugin/插件id/metadata目录下建立一个xml文件</p>
                        
                        <pre class="programlisting"><span class="hl-directive">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="hl-tag">&lt;metadata&gt;</span>
    <span class="hl-tag">&lt;table</span> <span class="hl-attribute">name</span>=<span class="hl-value">"orgMemberTest"</span> <span class="hl-attribute">class</span>=<span class="hl-value">"com.seeyon.ctp.organization.po.OrgMember"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;column</span> <span class="hl-attribute">name</span>=<span class="hl-value">"gender"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;label&gt;</span>samples.ServerState.minute.label<span class="hl-tag">&lt;/label&gt;</span>
            <span class="hl-tag">&lt;alias&gt;</span>g<span class="hl-tag">&lt;/alias&gt;</span>
            <span class="hl-tag">&lt;sort&gt;</span>5<span class="hl-tag">&lt;/sort&gt;</span>
            <span class="hl-tag">&lt;type&gt;</span>2<span class="hl-tag">&lt;/type&gt;</span>
            <span class="hl-tag">&lt;datatype&gt;</span>2<span class="hl-tag">&lt;/datatype&gt;</span>
            <span class="hl-tag">&lt;width&gt;</span>100<span class="hl-tag">&lt;/width&gt;</span>
            <span class="hl-tag">&lt;rule&gt;</span>type:'string',maxLength:2,minLength:1<span class="hl-tag">&lt;/rule&gt;</span>
        <span class="hl-tag">&lt;/column&gt;</span>
        <span class="hl-tag">&lt;column</span> <span class="hl-attribute">name</span>=<span class="hl-value">"tel"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;label&gt;</span>samples.ServerState.forecastTime.label<span class="hl-tag">&lt;/label&gt;</span>
            <span class="hl-tag">&lt;sort&gt;</span>5<span class="hl-tag">&lt;/sort&gt;</span>
            <span class="hl-tag">&lt;type&gt;</span>1<span class="hl-tag">&lt;/type&gt;</span>
            <span class="hl-tag">&lt;component&gt;</span>codecfg<span class="hl-tag">&lt;/component&gt;</span>
            <span class="hl-tag">&lt;rule&gt;</span>codeType:'java',codeId:'com.seeyon.apps.samples.test.enums.MyEnums',defaultValue:4<span class="hl-tag">&lt;/rule&gt;</span>
        <span class="hl-tag">&lt;/column&gt;</span>
        <span class="hl-tag">&lt;column</span> <span class="hl-attribute">name</span>=<span class="hl-value">"level"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;label&gt;</span>samples.ServerState.comment.label<span class="hl-tag">&lt;/label&gt;</span>
            <span class="hl-tag">&lt;sort&gt;</span>3<span class="hl-tag">&lt;/sort&gt;</span>
            <span class="hl-tag">&lt;type&gt;</span>2<span class="hl-tag">&lt;/type&gt;</span>
            <span class="hl-tag">&lt;component&gt;</span>selectPeople<span class="hl-tag">&lt;/component&gt;</span>
            <span class="hl-tag">&lt;rule&gt;</span>mode:'open'<span class="hl-tag">&lt;/rule&gt;</span>
        <span class="hl-tag">&lt;/column&gt;</span>
        <span class="hl-tag">&lt;column</span> <span class="hl-attribute">name</span>=<span class="hl-value">"age"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;label&gt;</span>com.seeyon.ctp.organization.metadata.age<span class="hl-tag">&lt;/label&gt;</span>
            <span class="hl-tag">&lt;alias&gt;</span>a<span class="hl-tag">&lt;/alias&gt;</span>
            <span class="hl-tag">&lt;sort&gt;</span>5<span class="hl-tag">&lt;/sort&gt;</span>
            <span class="hl-tag">&lt;type&gt;</span>2<span class="hl-tag">&lt;/type&gt;</span>
            <span class="hl-tag">&lt;component&gt;</span>calendar<span class="hl-tag">&lt;/component&gt;</span>
            <span class="hl-tag">&lt;rule&gt;</span>ifFormat:'%Y-%m-%d'<span class="hl-tag">&lt;/rule&gt;</span>
        <span class="hl-tag">&lt;/column&gt;</span>
        <span class="hl-tag">&lt;column&gt;</span>
            <span class="hl-tag">&lt;label&gt;</span>null name test<span class="hl-tag">&lt;/label&gt;</span>
            <span class="hl-tag">&lt;sort&gt;</span>5<span class="hl-tag">&lt;/sort&gt;</span>
            <span class="hl-tag">&lt;type&gt;</span>2<span class="hl-tag">&lt;/type&gt;</span>
        <span class="hl-tag">&lt;/column&gt;</span>
    <span class="hl-tag">&lt;/table&gt;</span>
<span class="hl-tag">&lt;/metadata&gt;</span></pre>
                        </div>
                     
                     
                     <div class="section" title="13.5.2.2.&nbsp;引用并渲染">
                        <div class="titlepage">
                           <div>
                              <div>
                                 <h4 class="title"><a name="d5e2648"></a>13.5.2.2.&nbsp;引用并渲染
                                 </h4>
                              </div>
                           </div>
                        </div>
                        
                        
                        
                        <p>在jsp文件中加入</p>
                        
                        <pre class="programlisting">    <span class="hl-tag">&lt;tr</span> <span class="hl-attribute">id</span>=<span class="hl-value">"metacontainer"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;th</span> <span class="hl-attribute">nowrap</span>=<span class="hl-value">"nowrap"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;label</span> <span class="hl-attribute">class</span>=<span class="hl-value">"margin_r_10"</span> <span class="hl-attribute">for</span>=<span class="hl-value">"text"</span><span class="hl-tag">&gt;</span>硬编码:<span class="hl-tag">&lt;/label&gt;</span>
    <span class="hl-tag">&lt;/th&gt;</span>
    <span class="hl-tag">&lt;td&gt;</span>
        <span class="hl-tag">&lt;div</span> <span class="hl-attribute">class</span>=<span class="hl-value">"common_txtbox_wrap"</span><span class="hl-tag">&gt;</span>
            <span class="hl-tag">&lt;input</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">id</span>=<span class="hl-value">"text"</span> <span class="hl-attribute">value</span>=<span class="hl-value">"以下为元数据自动生成"</span><span class="hl-tag">&gt;</span>
        <span class="hl-tag">&lt;/div&gt;</span>
    <span class="hl-tag">&lt;/td&gt;</span>

    <span class="hl-tag">&lt;script</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text/javascript"</span>
        <span class="hl-attribute">src</span>=<span class="hl-value">"${path}/metadata.do?tables=</span><span class="emphasis"><em>orgManagerTest</em></span>"&gt;<span class="hl-tag">&lt;/script&gt;</span>
    <span class="hl-tag">&lt;script</span> <span class="hl-attribute">type</span>=<span class="hl-value">"text/javascript"</span><span class="hl-tag">&gt;</span>
        $.metadataForm('#metacontainer', 'orgMemberTest', {
            'columns' : [ 'age', 'gender', 'tel', 'level' ],
            position : 'after'<a name="metadata_1_1"></a><img src="resources/callouts/1.png" alt="1" border="0">
        });
    <span class="hl-tag">&lt;/script&gt;</span></pre>
                        
                        <div class="calloutlist">
                           <table border="0" summary="Callout list">
                              <tr>
                                 <td width="5%" valign="top" align="left">
                                    <p><a href="#metadata_1_1"><img src="resources/callouts/1.png" alt="1" border="0"></a> 
                                    </p>
                                 </td>
                                 <td valign="top" align="left">
                                    
                                    <p>在metacontainer后生成</p>
                                    
                                 </td>
                              </tr>
                           </table>
                        </div>
                        
                        
                        <p>执行后生成下面的页面</p>
                        
                        
                        <p></p>
                        
                        
                        <div class="mediaobject"><img src="resources/images/metadata_1.jpg"></div>
                        
                     </div>
                     
                  </div>
                  
               </div>
               
            </div>
            
            
            <div class="chapter" title="Chapter&nbsp;14.&nbsp;单元测试">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d5e2662"></a>Chapter&nbsp;14.&nbsp;单元测试
                        </h2>
                     </div>
                  </div>
               </div>
               
               
               
               <p>使用QUnit作为前端单元测试工具。</p>
               
               
               <p>QUnit是jQuery团队开发的JavaScript单元测试工具，使用方便，界面美观。</p>
               
               
               <div class="procedure">
                  <ol class="procedure" type="1">
                     <li class="step" title="Step 1">
                        
                        <p>针对下面的js方法进行测试</p>
                        
                        <pre class="programlisting"><span class="hl-keyword">function</span> add(a,b){
    <span class="hl-keyword">return</span> a+b;
}</pre>
                        </li>
                     <li class="step" title="Step 2">
                        
                        <p>建立一个测试页面，引入 qunit.js 和 qunit.css 这两个必需的文件</p>
                        
                        <pre class="programlisting"><span class="hl-doctype">&lt;!DOCTYPE html&gt;</span>
<span class="hl-tag">&lt;html&gt;</span>
<span class="hl-tag">&lt;head&gt;</span>
  <span class="hl-tag">&lt;meta</span> <span class="hl-attribute">charset</span>=<span class="hl-value">"utf-8"</span><span class="hl-tag">&gt;</span>
  <span class="hl-tag">&lt;title&gt;</span>QUnit Example<span class="hl-tag">&lt;/title&gt;</span>
  <span class="hl-tag">&lt;link</span> <span class="hl-attribute">rel</span>=<span class="hl-value">"stylesheet"</span> <span class="hl-attribute">href</span>=<span class="hl-value">"/resources/qunit.css"</span><span class="hl-tag">&gt;</span>
<span class="hl-tag">&lt;/head&gt;</span>
<span class="hl-tag">&lt;body&gt;</span>
  <span class="hl-tag">&lt;div</span> <span class="hl-attribute">id</span>=<span class="hl-value">"qunit"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;/div&gt;</span>
  <span class="hl-tag">&lt;script</span> <span class="hl-attribute">src</span>=<span class="hl-value">"/resources/qunit.js"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;/script&gt;</span>
  <span class="hl-tag">&lt;script</span> <span class="hl-attribute">src</span>=<span class="hl-value">"/resources/tests.js"</span><span class="hl-tag">&gt;</span><span class="hl-tag">&lt;/script&gt;</span>
<span class="hl-tag">&lt;/body&gt;</span>
<span class="hl-tag">&lt;/html&gt;</span></pre>
                        </li>
                     <li class="step" title="Step 3">
                        
                        <p>tests.js中的基本测试代码如下</p>
                        
                        <pre class="programlisting">module( <span class="hl-string">"math"</span> );
test(<span class="hl-string">"basic calculation"</span>, <span class="hl-keyword">function</span>() {
        equals(add(<span class="hl-number">1</span>,<span class="hl-number">5</span>),<span class="hl-number">6</span>,<span class="hl-string">"1+5=6"</span>);
        equals(add(<span class="hl-number">1.2</span>,<span class="hl-number">5.5</span>),<span class="hl-number">6.7</span>,<span class="hl-string">"1.2+5.5=6.7"</span>);
        equals(add(-<span class="hl-number">1</span>,<span class="hl-number">10</span>),<span class="hl-number">9</span>,<span class="hl-string">"-1+10=9"</span>);
    });

test(<span class="hl-string">"pass null test"</span>, <span class="hl-keyword">function</span>() {
        ok(<span class="hl-keyword">isNaN</span>(add(null,<span class="hl-number">5</span>)),<span class="hl-string">"pass null as the first argument"</span>);
        ok(<span class="hl-keyword">isNaN</span>(add(<span class="hl-number">5</span>,null)),<span class="hl-string">"pass null as the second argument"</span>);
        ok(<span class="hl-keyword">isNaN</span>(add(null,null)),<span class="hl-string">"no argument pass in"</span>);
    });</pre>
                        </li>
                  </ol>
               </div>
               <p>QUnit的详细API手册参见<a class="ulink" href="http://api.qunitjs.com/" target="_top">http://api.qunitjs.com/</a></p>
               
            </div>
            
            
            <div class="chapter" title="Chapter&nbsp;15.&nbsp;JavaScript优化技巧">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d5e2679"></a>Chapter&nbsp;15.&nbsp;JavaScript优化技巧
                        </h2>
                     </div>
                  </div>
               </div>
               
               
               
               <p></p>
               
               
               <p>Daniel Clifford 在 Google I/O 2012 上做了一个精彩的演讲“Breaking the JavaScript
                  Speed Limit with V8”。在演讲中，他深入解释了13个简单的代码优化方法，可以让你的代码在 Chrome 的 V8
                  JavaScript 引擎编译/运行你的 JavaScript
                  代码更加快速。在演讲中，他解释了怎么优化，并且解释了原因。下面简明的列出了优化的要点：
               </p>
               
               
               <div class="orderedlist">
                  <ol class="orderedlist" type="1">
                     <li class="listitem">
                        
                        <p>在构造函数中初始化所有的对象</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>始终用相同的顺序初始化对象</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>尽量使用数字</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>为数组使用从0开始的连续的主键</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>不要提前分配大型数组（&gt;64K），你应该在使用的过程中扩大数组</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>不要删除数组中的元素</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>不要装载没有初始化或者已经删除的元素</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>对于固定大小的数组，使用array literals初始化</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>在使用前分配正确的空间大小给小数组</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>不要在数值数组中存储非数值内容</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>尽量使用单一类型（monomorphic）而不是多类型（polymorphic）</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>不要使用 try{} catch{}</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>在优化后避免在方法中修隐藏的类</p>
                        
                     </li>
                  </ol>
               </div>
               
            </div>
            
            
            <div class="chapter" title="Chapter&nbsp;16.&nbsp;JavaScript优化技巧">
               <div class="titlepage">
                  <div>
                     <div>
                        <h2 class="title"><a name="d5e2710"></a>Chapter&nbsp;16.&nbsp;JavaScript优化技巧
                        </h2>
                     </div>
                  </div>
               </div>
               
               
               
               <p></p>
               
               
               <p>Daniel Clifford 在 Google I/O 2012 上做了一个精彩的演讲“Breaking the JavaScript
                  Speed Limit with V8”。在演讲中，他深入解释了13个简单的代码优化方法，可以让你的代码在 Chrome 的 V8
                  JavaScript 引擎编译/运行你的 JavaScript
                  代码更加快速。在演讲中，他解释了怎么优化，并且解释了原因。下面简明的列出了优化的要点：
               </p>
               
               
               <div class="orderedlist">
                  <ol class="orderedlist" type="1">
                     <li class="listitem">
                        
                        <p>在构造函数中初始化所有的对象</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>始终用相同的顺序初始化对象</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>尽量使用数字</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>为数组使用从0开始的连续的主键</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>不要提前分配大型数组（&gt;64K），你应该在使用的过程中扩大数组</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>不要删除数组中的元素</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>不要装载没有初始化或者已经删除的元素</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>对于固定大小的数组，使用array literals初始化</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>在使用前分配正确的空间大小给小数组</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>不要在数值数组中存储非数值内容</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>尽量使用单一类型（monomorphic）而不是多类型（polymorphic）</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>不要使用 try{} catch{}</p>
                        
                     </li>
                     <li class="listitem">
                        
                        <p>在优化后避免在方法中修隐藏的类</p>
                        
                     </li>
                  </ol>
               </div>
               
            </div>
            
         </div>
         
         
         <div class="glossary" title="Glossary">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title"><a name="d5e2741"></a>Glossary
                     </h2>
                  </div>
               </div>
            </div>
            <div class="glossdiv" title="词汇表">
               <h3 class="title">词汇表</h3>
               <dl>
                  <dt>form</dt>
                  <dd>
                     <p>表单</p>
                  </dd>
                  <dt>collaboration</dt>
                  <dd>
                     <p>协同</p>
                  </dd>
                  <dt>ctp</dt>
                  <dd>
                     <p>协同技术平台</p>
                  </dd>
                  <dt>news</dt>
                  <dd>
                     <p>新闻</p>
                  </dd>
                  <dt>organization</dt>
                  <dd>
                     <p>组织</p>
                  </dd>
                  <dt>workflow</dt>
                  <dd>
                     <p>工作流</p>
                  </dd>
               </dl>
            </div>
         </div>
         
      </div>
   </body>
</html>